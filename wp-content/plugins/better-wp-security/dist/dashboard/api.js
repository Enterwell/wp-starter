(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[3767],{13722:(e,r,a)=>{"use strict";a.r(r),a.d(r,{AdminBarFill:()=>Ka,AdminBarSlot:()=>Xa,BelowToolbarFill:()=>et,BelowToolbarSlot:()=>rt,EditCardsFill:()=>at,EditCardsSlot:()=>tt});var t={};a.r(t),a.d(t,{FAILED_ADD_DASHBOARD:()=>se,FAILED_DELETE_DASHBOARD:()=>ue,FAILED_SAVE_DASHBOARD:()=>ie,FINISH_ADD_DASHBOARD:()=>te,FINISH_DELETE_DASHBOARD:()=>ce,FINISH_SAVE_DASHBOARD:()=>ne,RECEIVE_DASHBOARD:()=>X,RECEIVE_DASHBOARD_COLLECTION_HEADERS:()=>le,RECEIVE_DASHBOARD_LAYOUT:()=>ee,RECEIVE_DASHBOARD_QUERY:()=>K,SAVING_DASHBOARD_LAYOUT:()=>re,START_ADD_DASHBOARD:()=>ae,START_DELETE_DASHBOARD:()=>oe,START_SAVE_DASHBOARD:()=>de,addDashboard:()=>G,deleteDashboard:()=>J,failedAddDashboard:()=>U,failedDeleteDashboard:()=>z,failedSaveDashboard:()=>Q,finishAddDashboard:()=>N,finishDeleteDashboard:()=>j,finishSaveDashboard:()=>q,receiveDashboard:()=>x,receiveDashboardCollectionHeaders:()=>P,receiveDashboardLayout:()=>L,receiveDashboardQuery:()=>B,saveDashboard:()=>W,saveDashboardLayout:()=>M,saveDashboardLayoutFromGrid:()=>Z,savingDashboardLayout:()=>F,startAddDashboard:()=>V,startDeleteDashboard:()=>$,startSaveDashboard:()=>k});var s={};a.r(s),a.d(s,{canCreateDashboards:()=>Ee,canEditDashboard:()=>Re,getAvailableDashboards:()=>Ae,getDashboard:()=>pe,getDashboardAddableCardLDOs:()=>Ce,getDashboardForEdit:()=>_e,getDashboardLayout:()=>Te,getDashboardLayoutForGrid:()=>we,getDashboardsQueryResult:()=>ge,isAddingDashboard:()=>Be,isCanCreateDashboardsLoaded:()=>Oe,isCardAtDashboardLimit:()=>Se,isDeletingDashboard:()=>Le,isLayoutLoaded:()=>me,isRequestingDashboardLayout:()=>ve,isRequestingDashboards:()=>Ie,isSavingDashboard:()=>xe,isSavingDashboardLayout:()=>He});var d={};a.r(d),a.d(d,{canCreateDashboards:()=>Ve,getAvailableDashboards:()=>Fe,getDashboard:()=>Ne,getDashboardForEdit:()=>Ue,getDashboardLayout:()=>Pe});var n={};a.r(n),a.d(n,{RECEIVE_AVAILABLE_CARDS:()=>qe,receiveAvailableCards:()=>ke});var i={};a.r(i),a.d(i,{FAILED_ADD_DASHBOARD_CARD:()=>vr,FAILED_DASHBOARD_CARD_RPC:()=>Hr,FAILED_QUERY_DASHBOARD_CARD:()=>Ur,FAILED_REFRESH_DASHBOARD_CARD:()=>Fr,FAILED_REFRESH_DASHBOARD_CARDS:()=>Br,FINISH_ADD_DASHBOARD_CARD:()=>Ir,FINISH_DASHBOARD_CARD_RPC:()=>Or,FINISH_QUERY_DASHBOARD_CARD:()=>Nr,FINISH_REFRESH_DASHBOARD_CARD:()=>Lr,FINISH_REFRESH_DASHBOARD_CARDS:()=>wr,RECEIVE_DASHBOARD_CARD:()=>pr,RECEIVE_DASHBOARD_CARDS:()=>gr,RECEIVE_DASHBOARD_CARD_DATA:()=>Rr,RECEIVE_DASHBOARD_CARD_QUERY_ARGS:()=>_r,REMOVE_DASHBOARD_CARD:()=>Er,START_ADD_DASHBOARD_CARD:()=>Sr,START_DASHBOARD_CARD_RPC:()=>mr,START_QUERY_DASHBOARD_CARD:()=>Vr,START_REFRESH_DASHBOARD_CARD:()=>xr,START_REFRESH_DASHBOARD_CARDS:()=>Tr,START_REMOVE_DASHBOARD_CARD:()=>Cr,addAvailableCardsToDashboard:()=>cr,addDashboardCard:()=>ur,callDashboardCardRpc:()=>Ar,dashboardCardRemoved:()=>Ge,failedAddDashboardCard:()=>Me,failedDashboardCardRpc:()=>Xe,failedQueryDashboardCard:()=>or,failedRefreshDashboardCard:()=>dr,failedRefreshDashboardCards:()=>ar,finishAddDashboardCard:()=>Ze,finishDashboardCardRpc:()=>Ke,finishQueryDashboardCard:()=>ir,finishRefreshDashboardCard:()=>sr,finishRefreshDashboardCards:()=>rr,queryDashboardCard:()=>fr,receiveDashboardCard:()=>$e,receiveDashboardCardData:()=>ze,receiveDashboardCardQueryArgs:()=>je,receiveDashboardCards:()=>Qe,refreshDashboardCard:()=>Dr,refreshDashboardCards:()=>br,refreshDashboardCardsOfType:()=>yr,removeDashboardCard:()=>hr,saveDashboardCard:()=>lr,startAddDashboardCard:()=>Ye,startDashboardCardRemove:()=>We,startDashboardCardRpc:()=>Je,startQueryDashboardCard:()=>nr,startRefreshDashboardCard:()=>tr,startRefreshDashboardCards:()=>er});var o={};a.r(o),a.d(o,{getAvailableCard:()=>kr,getAvailableCardBySelf:()=>qr,getAvailableCards:()=>Pr});var c={};a.r(c),a.d(c,{getAvailableCard:()=>$r,getAvailableCardBySelf:()=>jr,getAvailableCards:()=>Qr});var u={};a.r(u),a.d(u,{areCardsLoaded:()=>ra,canEditCard:()=>Kr,getCallingDashboardCardRpcs:()=>na,getDashboardCard:()=>Wr,getDashboardCardConfig:()=>Mr,getDashboardCardQueryArgs:()=>Zr,getDashboardCardSettings:()=>Yr,getDashboardCards:()=>Gr,getDashboardCardsByType:()=>Jr,isAddingCard:()=>ta,isCallingDashboardCardRpc:()=>sa,isQueryingDashboardCard:()=>ia,isRefreshingDashboardCards:()=>ea,isRemovingCard:()=>aa,isRequestingCards:()=>Xr});var l={};a.r(l),a.d(l,{getDashboardCardConfig:()=>ca,getDashboardCards:()=>oa});var h={};a.r(h),a.d(h,{CLOSE_EDIT_CARDS:()=>va,NAVIGATE:()=>Ra,NAVIGATE_BACK:()=>Ea,OPEN_EDIT_CARDS:()=>Ia,RECEIVE_STATIC_STATS:()=>ma,RECEIVE_SUGGESTED_SHARE_USERS:()=>Ca,RECEIVE_USER:()=>Sa,REGISTER_CARD:()=>Ha,USING_TOUCH:()=>Oa,closeEditCards:()=>Da,openEditCards:()=>ya,receiveStaticStats:()=>ga,receiveSuggestedShareUsers:()=>fa,receiveUser:()=>Aa,registerCard:()=>_a,usingTouch:()=>pa,viewCreateDashboard:()=>la,viewDashboard:()=>ua,viewHelp:()=>ha,viewPrevious:()=>ba});var b={};a.r(b),a.d(b,{getCurrentPage:()=>wa,getCurrentPageAttr:()=>Ba,getRegisteredCard:()=>Pa,getStaticStats:()=>Na,getSuggestedShareUsers:()=>La,getUser:()=>Fa,getViewingDashboardId:()=>xa,isEditingCards:()=>Va,isUsingTouch:()=>Ua});var y={};a.r(y),a.d(y,{getStaticStats:()=>ja,getSuggestedShareUsers:()=>Qa,getUser:()=>$a});var D={};a.r(D),a.d(D,{RECEIVE_PRIMARY_DASHBOARD:()=>Wa,receivePrimaryDashboard:()=>za,setPrimaryDashboard:()=>Ga});var f={};a.r(f),a.d(f,{getPrimaryDashboard:()=>Za});var A={};a.r(A),a.d(A,{getPrimaryDashboard:()=>Ma});var g=a(87462),p=a(6293),_=a(92819),R=a(64893),E=a(48015),C=a(87514),S=a.n(C),I=a(31511);function v(e){return{type:"API_FETCH",request:e}}function m(e="info",r,a={}){return{type:"CREATE_NOTICE",status:e,content:r,options:{context:"ithemes-security",...a}}}const O={API_FETCH:({request:e})=>S()(e).catch(I.xJ),SELECT:({selectorName:e,args:r})=>(0,E.select)("ithemes-security/dashboard")[e](...r),CREATE_NOTICE({status:e,content:r,options:a}){a.autoDismiss&&(a.id=a.id||(0,_.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,E.dispatch)("core/notices").removeNotice(a.id,a.context)),a.autoDismiss)),(0,E.dispatch)("core/notices").createNotice(e,r,a)}};var H=a(73470),T=a(95122),w=a(65760);function B(e,r){return{type:K,queryId:e,dashboards:r}}function x(e){return{type:X,dashboard:e}}function L(e,r){return{type:ee,dashboardId:e,layout:r}}function F(e,r){return{type:re,dashboardId:e,layout:r}}function V(e,r){return{type:ae,dashboard:e,context:r}}function N(e,r,a){return{type:te,dashboard:e,created:r,context:a}}function U(e,r,a){return{type:se,dashboard:e,context:r,error:a}}function P(e){return{type:le,headers:e}}function k(e){return{type:de,dashboardId:e}}function q(e){return{type:ne,dashboardId:e}}function Q(e,r){return{type:ie,dashboardId:e,error:r}}function $(e){return{type:oe,dashboardId:e}}function j(e){return{type:ce,dashboardId:e}}function z(e,r){return{type:ue,dashboardId:e,error:r}}function*G(e,r){let a;yield V(e,r);try{a=yield Y(e)}catch(a){return yield U(e,r,a),void(yield m("error",(0,T.sprintf)((0,T.__)("Error when creating dashboard: %s","better-wp-security"),a.message)))}return yield x(a),yield N(e,a,r),yield m("success",(0,T.__)("Dashboard Created","better-wp-security"),{autoDismiss:1e4}),a}function*W(e){let r;yield k(e.id);try{r=yield Y(e)}catch(r){return yield Q(e.id,r),yield m("error",(0,T.sprintf)((0,T.__)("Error when saving dashboard: %s","better-wp-security"),r.message)),r}return yield x(r),yield q(e.id),r}function*Y(e){return yield v({path:(0,H.addQueryArgs)("/ithemes-security/v1/dashboards"+(e.id?"/"+e.id:""),{_embed:1}),method:e.id?"PUT":"POST",data:e})}function*Z(e,r){const a=(0,w.Ai)(e,r);if(yield L(e,a),(0,E.select)("ithemes-security/dashboard").canEditDashboard(e))return yield M(e,a,!1)}function*M(e,r,a=!0){let t;yield F(e,r);try{t=yield v({path:`/ithemes-security/v1/dashboards/${e}/layout`,method:"PUT",data:r})}catch(e){return!1}return a&&(yield L(e,t)),t}function*J(e){yield $(e);try{yield v({path:`/ithemes-security/v1/dashboards/${e}`,method:"DELETE"})}catch(r){return yield z(e,r),yield m("error",(0,T.sprintf)((0,T.__)("Error when deleting dashboard: %s","better-wp-security"),r.message)),r}return yield j(e),!0}const K="RECEIVE_DASHBOARD_QUERY",X="RECEIVE_DASHBOARD",ee="RECEIVE_DASHBOARD_LAYOUT",re="SAVING_DASHBOARD_LAYOUT",ae="START_ADD_DASHBOARD",te="FINISH_ADD_DASHBOARD",se="FAILED_ADD_DASHBOARD",de="START_SAVE_DASHBOARD",ne="FINISH_SAVE_DASHBOARD",ie="FAILED_SAVE_DASHBOARD",oe="START_DELETE_DASHBOARD",ce="FINISH_DELETE_DASHBOARD",ue="FAILED_DELETE_DASHBOARD",le="RECEIVE_DASHBOARD_COLLECTION_HEADERS",he={byId:{},queries:{},layouts:{},savingLayouts:{},adding:[],saving:[],deleting:[],collectionHeaders:{}};var be=a(28306),ye=a(38085);function De(e,...r){return(0,E.select)("core/data").isResolving("ithemes-security/dashboard",e,r)}function fe(e,...r){return(0,E.select)("core/data").hasFinishedResolution("ithemes-security/dashboard",e,r)}function Ae(e){return ge(e,"available")}const ge=(0,be.Z)(((e,r)=>(0,_.filter)((0,_.map)(e.dashboard.queries[r],(r=>e.dashboard.byId[r])),_.isObject)),((e,r)=>[e.dashboard.queries[r],e.dashboard.byId]));function pe(e,r){return e.dashboard.byId[r]}function _e(e,r){return e.dashboard.byId[r]}function Re(e,r){return function(e,r,a){return(0,_.get)(e,["dashboard","byId",r,"_links","self",0,"targetHints","allow"],[])}(e,r).includes("PUT")}function Ee(e){return e.dashboard.collectionHeaders.allow&&e.dashboard.collectionHeaders.allow.split(", ").includes("POST")}const Ce=(0,be.Z)(((e,r)=>(0,_.filter)((0,_.get)(e,["dashboard","byId",r,"_links","create-form"],[]),(e=>(0,_.get)(e,["targetHints","allow"],[]).includes("POST"))).map((e=>({...e,aboutLink:e.targetHints.link.map(ye.parse).filter((e=>!!e.about)).map((e=>e.about))[0]})))),((e,r)=>[e.dashboard.byId[r]]));function Se(e,r,a){const t=(0,E.select)("ithemes-security/dashboard").getAvailableCardBySelf(a);return!(!t||!t.max)&&(0,E.select)("ithemes-security/dashboard").getDashboardCardsByType(r,a).length>=t.max}function Ie(){return De("getAvailableDashboards")}function ve(e,r){return De("getDashboardLayout",r)}function me(e,r){return fe("getDashboardLayout",r)}function Oe(){return fe("canCreateDashboards")}function He(e,r){return e.dashboard.savingLayouts[r]}function Te(e,r){return e.dashboard.layouts[r]}const we=(0,be.Z)(((e,r)=>(0,w.BP)(r,(0,_.get)((0,E.select)("ithemes-security/dashboard").getDashboardLayout(r),"cards",[]),(0,E.select)("ithemes-security/dashboard").getDashboardCards(r)||[])),((e,r)=>[e.dashboard.layouts[r],e.availableCards,e.cards.byDashboard[r]]));function Be(e,r){return e.dashboard.adding.includes(r)}function xe(e,r){return e.dashboard.saving.includes(r)}function Le(e,r){return e.dashboard.deleting.includes(r)}function*Fe(){const e=yield v({path:(0,H.addQueryArgs)("/ithemes-security/v1/dashboards",{_embed:1})});yield B("available",e)}const Ve={*fulfill(){const e=yield v({path:"/ithemes-security/v1/dashboards",method:"HEAD",parse:!1});yield P((0,I.N4)(e.headers))},isFulfilled:e=>!!e.dashboard.collectionHeaders.allow};function*Ne(){yield E.controls.resolveSelect("ithemes-security/dashboard","getAvailableDashboards")}function*Ue(e){const r=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${e}`,{_embed:1,context:"edit"})});yield x(r)}function*Pe(e){const r=yield v({path:`/ithemes-security/v1/dashboards/${e}/layout`});yield L(e,r)}function ke(e){return{type:qe,cards:e}}const qe="RECEIVE_AVAILABLE_CARDS";function Qe(e,r){return{type:gr,dashboardId:e,cards:r}}function $e(e,r){return{type:pr,dashboardId:e,card:r}}function je(e,r){return{type:_r,cardId:e,queryArgs:r}}function ze(e,r,a){return{type:Rr,cardId:e,data:r,links:a}}function Ge(e,r){return{type:Er,dashboardId:e,cardId:r}}function We(e,r){return{type:Cr,dashboardId:e,cardId:r}}function Ye(e,r,a){return{type:Sr,collectionEP:e,card:r,context:a}}function Ze(e,r,a){return{type:Ir,collectionEP:e,card:r,context:a}}function Me(e,r,a,t){return{type:vr,collectionEP:e,card:r,context:a,error:t}}function Je(e,r,a){return{type:mr,cardId:e,href:r,data:a}}function Ke(e,r,a,t){return{type:Or,cardId:e,href:r,data:a,response:t}}function Xe(e,r,a,t){return{type:Hr,cardId:e,href:r,data:a,error:t}}function er(e){return{type:Tr,dashboardId:e}}function rr(e){return{type:wr,dashboardId:e}}function ar(e,r){return{type:Br,dashboardId:e,error:r}}function tr(e){return{type:xr,cardId:e}}function sr(e){return{type:Lr,cardId:e}}function dr(e,r){return{type:Fr,cardId:e,error:r}}function nr(e){return{type:Vr,cardId:e}}function ir(e){return{type:Nr,cardId:e}}function or(e,r){return{type:Ur,cardId:e,error:r}}function*cr(e){const r=yield E.controls.select("ithemes-security/dashboard","getDashboardAddableCardLDOs",e);for(const e of r)yield*ur(e.href,{})}function*ur(e,r,a){let t;yield Ye(e,r,a);try{t=yield v({url:(0,H.addQueryArgs)(e,{_embed:1}),method:"POST",data:r})}catch(t){return yield Me(e,r,a,t),void(yield m("error",(0,T.sprintf)((0,T.__)("Error when adding card to dashboard: %s","better-wp-security"),t.message)))}yield Ze(e,r,a),yield $e(t.dashboard,t)}function*lr(e,r){const a=r.id;let t;try{t=yield v({path:`/ithemes-security/v1/dashboards/${e}/cards/${r.card}${a?"/"+a:""}`,method:a?"PUT":"POST",data:r})}catch(e){return yield m("error",(0,T.sprintf)((0,T.__)("Error when saving dashboard card: %s","better-wp-security"),e.message)),e}return yield $e(e,t),t}function*hr(e,r,a=!0){yield We(e,r.id),a&&(yield Ge(e,r.id));try{yield v({path:`/ithemes-security/v1/dashboards/${e}/cards/${r.card}/${r.id}`,method:"DELETE",parse:!1})}catch(t){return a&&(yield $e(e,r)),void(yield m("error",(0,T.sprintf)((0,T.__)("Error when removing card from dashboard: %s","better-wp-security"),t.message)))}a||(yield Ge(e,r.id))}function*br(e){yield er(e);const r=(0,E.select)("ithemes-security/dashboard"),a=r.getDashboardCards(e),t={_fields:["id","data","_links"],cards:{}};for(const e of a)(0,_.set)(t,["cards",e.card,e.id],r.getDashboardCardQueryArgs(e.id));let s;try{s=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${e}/cards`,t)})}catch(r){return yield ar(e,r),yield m("warning",(0,T.sprintf)((0,T.__)("Refreshing dashboard data failed: %s","better-wp-security"),r.message),{autoDismiss:!0}),r}const d={};for(const e of s)d[e.id]=e.data,yield ze(e.id,e.data,e._links);return yield rr(e),d}function*yr(e,r){r=(0,_.castArray)(r);const a=(0,E.select)("ithemes-security/dashboard").getDashboardCards(e);for(const e of a)r.includes(e.card)&&(0,E.dispatch)("ithemes-security/dashboard").refreshDashboardCard(e.id)}function*Dr(e){const r=(0,E.select)("ithemes-security/dashboard").getDashboardCard(e);if(!r)throw new Error("No card loaded with that id.");yield tr(e);const a=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${r.dashboard}/cards/${r.card}/${e}`,{...(0,E.select)("ithemes-security/dashboard").getDashboardCardQueryArgs(e),_fields:["data","_links"]})});return yield ze(e,a.data,a._links),yield sr(e),a.data}function*fr(e,r){const a=(0,E.select)("ithemes-security/dashboard").getDashboardCard(e);if(!a)throw new Error("No card loaded with that id.");yield nr(e);const t=yield v({path:(0,H.addQueryArgs)(`/ithemes-security/v1/dashboards/${a.dashboard}/cards/${a.card}/${e}`,{...r,_fields:["data","_links"]})});return yield ze(e,t.data,t._links),yield je(e,r),yield ir(e),t.data}function*Ar(e,r,a){let t;yield Je(e,r,a);try{t=yield v({url:r,method:"POST",data:a})}catch(t){return yield Xe(e,r,a,t),yield m("error",(0,T.sprintf)((0,T.__)("Error when performing card action: %s","better-wp-security"),t.message)),t}return yield Ke(e,r,a,t),yield Dr(e),t}const gr="RECEIVE_DASHBOARD_CARDS",pr="RECEIVE_DASHBOARD_CARD",_r="RECEIVE_DASHBOARD_CARD_QUERY_ARGS",Rr="RECEIVE_DASHBOARD_CARD_DATA",Er="REMOVE_DASHBOARD_CARD",Cr="START_REMOVE_DASHBOARD_CARD",Sr="START_ADD_DASHBOARD_CARD",Ir="FINISH_ADD_DASHBOARD_CARD",vr="FAILED_ADD_DASHBOARD_CARD",mr="START_DASHBOARD_CARD_RPC",Or="FINISH_DASHBOARD_CARD_RPC",Hr="FAILED_DASHBOARD_CARD_RPC",Tr="START_REFRESH_DASHBOARD_CARDS",wr="FINISH_REFRESH_DASHBOARD_CARDS",Br="FAILED_REFRESH_DASHBOARD_CARDS",xr="START_REFRESH_DASHBOARD_CARD",Lr="FINISH_REFRESH_DASHBOARD_CARD",Fr="FAILED_REFRESH_DASHBOARD_CARD",Vr="START_QUERY_DASHBOARD_CARD",Nr="FINISH_QUERY_DASHBOARD_CARD",Ur="FAILED_QUERY_DASHBOARD_CARD",Pr=(0,be.Z)((e=>Object.values(e.availableCards)),(e=>[e.availableCards]));function kr(e,r){return e.availableCards[r]}const qr=(0,be.Z)(((e,r)=>(0,_.find)(e.availableCards,(e=>(0,_.get)(e,["_links","self",0,"href"])===r))),(e=>[e.availableCards]));function*Qr(){try{const e=yield v({path:"/ithemes-security/v1/dashboard-available-cards"});yield ke(e)}catch(e){yield ke([])}}function*$r(){yield(0,E.select)("ithemes-security/dashboard").getAvailableCards()}function*jr(){yield(0,E.select)("ithemes-security/dashboard").getAvailableCards()}const zr={byId:{},byDashboard:{},queryArgs:{},deleting:[],adding:[],rpcs:{},refreshingDashboards:[],querying:[]},Gr=(0,be.Z)(((e,r)=>(0,_.map)(e.cards.byDashboard[r],(r=>e.cards.byId[r]))),((e,r)=>[e.cards.byDashboard[r],e.cards.byId]));function Wr(e,r){return e.cards.byId[r]}function Yr(e,r){return(0,_.get)(e,["cards","byId",r,"settings"])}function Zr(e,r){return e.cards.queryArgs[r]}function Mr(e,r){const a=(0,E.select)("ithemes-security/dashboard").getDashboardCard(r);if(a)return(0,E.select)("ithemes-security/dashboard").getAvailableCard(a.card)}function Jr(e,r,a){const t=(0,E.select)("ithemes-security/dashboard").getDashboardCards(r),s=[];for(const e of t)(0,_.get)(e,["_links","about",0,"href"])===a&&s.push(e);return s}function Kr(e,r,a){return!(!(0,E.select)("ithemes-security/dashboard").canEditDashboard(r)||!a)}function Xr(e,r){return De("getDashboardCards",r)}function ea(e,r){return e.cards.refreshingDashboards.includes(r)}function ra(e,r){return fe("getDashboardCards",r)}function aa(e,r){return e.cards.deleting.includes(r)}function ta(e,r){return e.cards.adding.includes(r)}function sa(e,r,a){return e.cards.rpcs[r]&&e.cards.rpcs[r].includes(a)}const da=[];function na(e,r){return e.cards.rpcs[r]||da}function ia(e,r){return e.cards.querying.includes(r)}function*oa(e){const r=yield v({path:`/ithemes-security/v1/dashboards/${e}/cards?_embed=1`});yield Qe(e,r)}function*ca(e){const r=(0,E.select)("ithemes-security/dashboard").getDashboardCard(e);r&&!(0,E.select)("ithemes-security/dashboard").getAvailableCard(r.card)&&(0,E.select)("ithemes-security/dashboard").getAvailableCards()}function ua(e){return{type:Ra,page:"view-dashboard",attr:{id:e}}}function la(){return{type:Ra,page:"create-dashboard"}}function ha(){return{type:Ra,page:"help"}}function ba(){return{type:Ea}}function ya(){return{type:Ia}}function Da(){return{type:va}}function fa(e){return{type:Ca,users:e}}function Aa(e){return{type:Sa,user:e}}function ga(e,r){return{type:ma,stats:e,query:r}}function pa(e=!0){return{type:Oa,isUsing:e}}function _a(e,r){return{type:Ha,slug:e,settings:r}}const Ra="NAVIGATE",Ea="NAVIGATE_BACK",Ca="RECEIVE_SUGGESTED_SHARE_USERS",Sa="RECEIVE_USER",Ia="OPEN_EDIT_CARDS",va="CLOSE_EDIT_CARDS",ma="RECEIVE_STATIC_STATS",Oa="USING_TOUCH",Ha="REGISTER_CARD",Ta={view:{page:"",attr:{}},previousView:null,editingCards:!1,suggestedShareUsers:[],users:{byId:{}},staticStats:{data:{},query:{}},usingTouch:!1,cards:{}};function wa(e){return e.app.view.page}function Ba(e){return e.app.view.attr}function xa(e){return"create-dashboard"===e.app.view.page?e.app.previousView?.attr.id:"view-dashboard"===e.app.view.page?e.app.view.attr.id:void 0}function La(e){return e.app.suggestedShareUsers}function Fa(e,r){return e.app.users.byId[r]}function Va(e){return e.app.editingCards}function Na(e){return e.app.staticStats.data}function Ua(e){return e.app.usingTouch}function Pa(e,r){return e.app.cards[r]}var ka=a(81834),qa=a.n(ka);function*Qa(){const e=yield v({path:(0,H.addQueryArgs)("/wp/v2/users",{roles:"administrator"})});yield fa(e)}function*$a(e){const r=yield v({path:`/wp/v2/users/${e}`});yield Aa(r)}const ja={*fulfill(e){const r="/ithemes-security/v1/dashboard-static",a=yield v({path:(0,_.isEmpty)(e)?r:(0,H.addQueryArgs)(r,e)});yield ga(a,e)},isFulfilled:(e,r)=>qa()(e.app.staticStats.query,r)};function za(e){return{type:Wa,dashboardId:e}}function*Ga(e){yield E.controls.dispatch("ithemes-security/core","saveCurrentUser",{meta:{_itsec_primary_dashboard:e}},!0),yield za(e)}const Wa="RECEIVE_PRIMARY_DASHBOARD",Ya={primaryDashboard:void 0};function Za(e){return e.user.primaryDashboard}function*Ma(){const e=yield E.controls.resolveSelect("ithemes-security/core","getCurrentUser");yield za(e.meta._itsec_primary_dashboard)}const Ja={reducer:(0,E.combineReducers)({dashboard:function(e=he,r){switch(r.type){case K:return{...e,byId:{...e.byId,...(0,_.keyBy)(r.dashboards,"id")},queries:{...e.queries,[r.queryId]:(0,_.map)(r.dashboards,(e=>e.id))}};case X:return{...e,byId:{...e.byId,[r.dashboard.id]:r.dashboard},queries:{...e.queries,available:e.queries.available.includes(r.dashboard.id)?e.queries.available:[...e.queries.available,r.dashboard.id]}};case ee:return{...e,layouts:{...e.layouts,[r.dashboardId]:r.layout},savingLayouts:{...e.savingLayouts,[r.dashboardId]:!1}};case re:return{...e,savingLayouts:{...e.savingLayouts,[r.dashboardId]:!0}};case ae:return r.context?{...e,adding:[...e.adding,r.context]}:e;case te:case se:return{...e,adding:e.adding.filter((e=>e!==r.context))};case de:return{...e,saving:[...e.saving,r.dashboardId]};case ne:case ie:return{...e,saving:e.saving.filter((e=>e!==r.dashboardId))};case le:return{...e,collectionHeaders:r.headers};case oe:return{...e,deleting:[...e.deleting,r.dashboardId]};case ce:return{...e,deleting:e.deleting.filter((e=>e!==r.dashboardId)),byId:(0,_.omit)(e.byId,[r.dashboardId])};case ue:return{...e,deleting:e.deleting.filter((e=>e!==r.dashboardId))};default:return e}},availableCards:function(e={},r){switch(r.type){case qe:return{...e,...(0,_.keyBy)(r.cards,"slug")};case gr:const a={};for(const t of r.cards)if((0,_.has)(t,["_embedded","about",0])){const r=t._embedded.about[0].slug;e[r]||(a[r]=t._embedded.about[0])}return(0,_.isEmpty)(a)?e:{...e,...a};default:return e}},cards:function(e=zr,r){switch(r.type){case gr:return{...e,byId:{...e.byId,...(0,_.keyBy)(r.cards,"id")},byDashboard:{...e.byDashboard,[r.dashboardId]:(0,_.map)(r.cards,(e=>e.id))}};case pr:return{...e,byId:{...e.byId,[r.card.id]:r.card},byDashboard:{...e.byDashboard,[r.dashboardId]:e.byDashboard[r.dashboardId]&&e.byDashboard[r.dashboardId].includes(r.card.id)?e.byDashboard[r.dashboardId]:[...(0,_.get)(e,["byDashboard",r.dashboardId],[]),r.card.id]}};case _r:return{...e,queryArgs:{...e.queryArgs,[r.cardId]:r.queryArgs}};case Rr:return{...e,byId:{...e.byId,[r.cardId]:{...e.byId[r.cardId],data:r.data,_links:r.links}}};case Cr:return{...e,deleting:[...e.deleting,r.cardId]};case Er:return{...e,byId:(0,_.omit)(e.byId,r.cardId),byDashboard:{...e.byDashboard,[r.dashboardId]:(0,_.filter)(e.byDashboard[r.dashboardId],(e=>e!==r.cardId))},deleting:(0,_.filter)(e.deleting,(e=>e!==r.cardId))};case Sr:return r.context?{...e,adding:[...e.adding,r.context]}:e;case Ir:case vr:return{...e,adding:e.adding.filter((e=>e!==r.context))};case mr:return{...e,rpcs:{...e.rpcs,[r.cardId]:[...e.rpcs[r.cardId]||[],r.href]}};case Or:case Hr:return{...e,rpcs:{...e.rpcs,[r.cardId]:(e.rpcs[r.cardId]||[]).filter((e=>e!==r.href))}};case Tr:return{...e,refreshingDashboards:[...e.refreshingDashboards,r.dashboardId]};case wr:case Br:return{...e,refreshingDashboards:e.refreshingDashboards.filter((e=>e!==r.dashboardId))};case Vr:return{...e,querying:[...e.querying,r.cardId]};case Nr:return{...e,querying:e.querying.filter((e=>e!==r.cardId))};default:return e}},app:function(e=Ta,r){switch(r.type){case Ra:return{...e,view:{page:r.page,attr:r.attr||{}},previousView:e.view};case Ea:return{...e,view:e.previousView||Ta.view,previousView:null};case Ca:return{...e,suggestedShareUsers:r.users,users:{...e.users,byId:{...e.users.byId,...(0,_.keyBy)(r.users,"id")}}};case Sa:return{...e,users:{...e.users,byId:{...e.users.byId,[r.user.id]:r.user}}};case te:return["create-dashboard-scratch","create-dashboard-default"].includes(r.context)?{...e,editingCards:!0,view:{page:"view-dashboard",attr:{id:r.created.id}}}:e;case Ia:return{...e,editingCards:!0};case va:return{...e,editingCards:!1};case ma:return{...e,staticStats:{data:r.stats,query:r.query}};case Oa:return{...e,usingTouch:r.isUsing};case Ha:return{...e,cards:{...e.cards,[r.slug]:r.settings}};default:return e}},user:function(e=Ya,r){return r.type===Wa?{...e,primaryDashboard:r.dashboardId}:e}}),controls:{...O},actions:{...t,...n,...i,...h,...D},selectors:{...s,...o,...u,...b,...f},resolvers:{...d,...c,...l,...y,...A}};function Ka({type:e="secondary",...r}){return(0,p.createElement)(R.Fill,(0,g.Z)({name:`AdminBar${(0,_.capitalize)(e)}`},r))}function Xa({type:e="secondary",...r}){return(0,p.createElement)(R.Slot,(0,g.Z)({name:`AdminBar${(0,_.capitalize)(e)}`},r))}function et(e){return(0,p.createElement)(R.Fill,(0,g.Z)({name:"BelowToolbar"},e))}function rt(e){return(0,p.createElement)(R.Slot,(0,g.Z)({name:"BelowToolbar"},e))}function at(e){return(0,p.createElement)(R.Fill,(0,g.Z)({name:"EditCards"},e))}function tt(e){return(0,p.createElement)(R.Slot,(0,g.Z)({name:"EditCards"},e))}(0,E.registerStore)("ithemes-security/dashboard",Ja),a.p=window.itsecWebpackPublicPath},65760:(e,r,a)=>{"use strict";a.d(r,{Ai:()=>R,BP:()=>E,Bi:()=>C,E$:()=>w,E_:()=>l,GP:()=>H,IF:()=>v,M0:()=>f,Mf:()=>m,_U:()=>T,bK:()=>b,hN:()=>y,j$:()=>g,lh:()=>O,pD:()=>S,pr:()=>p,qt:()=>h,sP:()=>A,sv:()=>D});var t=a(92819),s=a(59588),d=a.n(s),n=a(48015),i=a(95122),o=a(54761),c=a(6293),u=a(31511);const l=(0,c.createContext)({canManage:!1,installType:""});function h(){return(0,c.useContext)(l)}function b(){const{canCreate:e,canEdit:r}=(0,n.useSelect)((e=>({canCreate:e("ithemes-security/dashboard").canCreateDashboards(),canEdit:e("ithemes-security/dashboard").canEditDashboard(e("ithemes-security/dashboard").getViewingDashboardId())})),[]);return e||r}const y=Object.freeze(["wide","large","medium","mobile"]),D=Object.freeze({wide:4,large:3,medium:2,mobile:1}),f=400,A=20,g=Object.freeze(y.reduce(((e,r)=>({...e,[r]:f*D[r]+A*(D[r]-1)})),{}));function p(e){const r=y.find((r=>g[r]+A<=e));return D[r]*(f+A)}const _=["minW","minH","maxW","maxH"];function R(e,r){const a=(0,n.select)("ithemes-security/dashboard"),t={};for(const e in r){if(!r.hasOwnProperty(e))continue;const s=r[e];for(const r of s){const s=a.getDashboardCard(parseInt(r.i));s&&(t[s.id]?(t[s.id].size[e]={w:r.w,h:r.h},t[s.id].position[e]={x:r.x&&r.x!==1/0?r.x:0,y:r.y&&r.y!==1/0?r.y:0}):t[s.id]={id:s.id,card:s.card,size:{[e]:{w:r.w,h:r.h}},position:{[e]:{x:r.x&&r.x!==1/0?r.x:0,y:r.y&&r.y!==1/0?r.y:0}}})}}return{cards:Object.values(t)}}function E(e,r,{cards:a={}}){const s=(0,t.zipObject)(Object.keys(g),(0,t.times)(Object.keys(g).length,(()=>[]))),d={};for(const r of a){d[r.id]=!0;const a=(0,n.select)("ithemes-security/dashboard").getAvailableCard(r.card);if(a||"unknown"===r.card)for(const t of y)s[t].push(C(e,r,a,t,s[t]))}if(Object.keys(d).length<r.length)for(const a of r)if(!d[a.id]){const r=(0,n.select)("ithemes-security/dashboard").getAvailableCard(a.card);if(r)for(const t of y)s[t].push(C(e,a,r,t,s[t]))}return s}function C(e,r,a,s,d){if(!g[s])return;const i={i:r.id.toString(),x:(0,t.get)(r,["position",s,"x"]),y:(0,t.get)(r,["position",s,"y"]),w:(0,t.get)(r,["size",s,"w"],(0,t.get)(a,["size","defaultW"],1)),h:(0,t.get)(r,["size",s,"h"],(0,t.get)(a,["size","defaultH"],2))};if(a&&a.size)for(const e of _)a.size.hasOwnProperty(e)&&(i[e]=a.size[e]);if(i.minW&&i.minW>i.w&&(i.w=i.minW),i.minH&&i.minH>i.h&&(i.h=i.minH),i.maxW&&i.w>i.maxW&&(i.w=i.maxW),i.maxH&&i.h>i.maxH&&(i.h=i.maxH),d&&void 0===i.x&&void 0===i.x){const e=S(D[s],d,{w:i.w,h:i.h});e&&(i.x=e.x,i.y=e.y)}return i.x=void 0===i.x||null===i.x?0:i.x,i.y=void 0===i.y||null===i.y?1/0:i.y,(0,n.select)("ithemes-security/dashboard").canEditDashboard(e)||(i.static=!0),"unknown"===r.card&&(i.isResizable=!1),i.minW===i.maxW&&i.minH===i.maxH&&(i.isResizable=!1),i}function S(e,r,a){const t=[];for(const a of r){const{x:r,y:s,w:d,h:n}=a;for(let a=0;a<n;a++){t[a]||(t[a]=new Array(e).fill(0));for(let n=0;n<d;n++)t[a+s]||(t[a+s]=new Array(e).fill(0)),t[a+s][n+r]=1}}const{w:s,h:d}=a;for(let r=0;r<t.length;r++)e:for(let a=0;a<e;a++)if(!t[r]||1!==t[r][a]){for(let n=0;n<d;n++)for(let d=0;d<s;d++)if(r+n>t.length||a+d>=e||t[r+n]&&1===t[r+n][a+d])continue e;return{x:a,y:r}}return{x:0,y:t.length}}function I(e,r){return e.x===r.x&&e.y===r.y&&e.w===r.w&&e.h===r.h}const v=d()((function(e,r){if(e===r)return!0;if(Object.keys(e).length!==Object.keys(r).length)return!1;const a=new Map;for(let t=0;t<y.length;t++){const s=y[t];if(e[s]||r[s]){if(!e[s]&&r[s]||e[s]&&!r[s])return!1;if(e[s].length!==r[s].length)return!1;for(let r=0;r<e[s].length;r++)a.set(e[s][r].i,e[s][r]);for(let e=0;e<r[s].length;e++){const t=a.get(r[s][e].i);if(!t)return!1;if(!I(t,r[s][e]))return!1;a.delete(t.i)}if(a.size>0)return!1}}return!0})),m=d()((function(e,r,a){const s=(0,t.keyBy)(r[a],"i"),d=[...e];return d.sort((function(e,r){const a=e.id.toString(),t=r.id.toString();if(!s[a]&&!s[t])return 0;if(s[a]&&!s[t])return 1;if(!s[a]&&s[t])return-1;const d=s[a].y,n=s[t].y,i=s[a].x,o=s[t].x;return d>n?1:d<n?-1:i>o?1:i<o?-1:0})),d})),O=d()((function(e,r){const a=(0,t.keyBy)(r.cards,"id"),s=[...e];return s.sort((function(e,r){const t=e.id,s=r.id;if(!a[t]&&!a[s])return 0;if(a[t]&&!a[s])return 1;if(!a[t]&&a[s])return-1;if(!a[t].position.mobile&&!a[s].position.mobile)return 0;const d=a[t].position.mobile.y,n=a[s].position.mobile.y,i=a[t].position.mobile.x,o=a[s].position.mobile.x;return d>n?1:d<n?-1:i>o?1:i<o?-1:0})),s}));function H(e,r){if(!r)return(0,i.__)("Unknown Card","better-wp-security");let a=r.label;return a=(0,o.applyFilters)(`ithemes-security.dashboard.getCardTitle.${r.slug}`,a,e),(0,o.applyFilters)("ithemes-security.dashboard.getCardTitle",a,e,r)}function T(e,r,a,t){Object.entries(a).forEach((([r,a])=>e[r]!==a&&console.log(`Prop '${r}' changed`))),Object.entries(t).forEach((([e,a])=>r[e]!==a&&console.log(`State '${e}' changed`)))}function w(e){return(0,t.get)(e,["avatar_urls",96],u.sE)}},38085:function(e,r,a){var t,s,d,n;d=function(){var e=/^;\s*([^"=]+)=(?:"([^"]+)"|([^";,]+)(?:[;,]|$))/,r=/^<([^>]*)>/,a=/^\s*,\s*/;return{parse:function(t,s){for(var d,n,i,o=s&&s.extended||!1,c=[];t&&(t=t.trim(),n=r.exec(t));){for(var u={link:n[1]},l=(t=t.slice(n[0].length)).match(a);t&&(!l||l.index>0)&&(d=e.exec(t));)l=(t=t.slice(d[0].length)).match(a),"rel"===d[1]||"rev"===d[1]?(i=(d[2]||d[3]).split(/\s+/),u[d[1]]=i):u[d[1]]=d[2]||d[3];c.push(u),t=t.replace(a,"")}return o?c:c.reduce((function(e,r){return r.rel&&r.rel.forEach((function(a){e[a]=r.link})),e}),{})},stringify:function(e){var r=Object.keys(e).reduce((function(r,a){return r[e[a]]=r[e[a]]||[],r[e[a]].push(a),r}),{});return Object.keys(r).reduce((function(e,a){return e.concat("<"+a+'>; rel="'+r[a].join(" ")+'"')}),[]).join(", ")}}},n=this,e.exports?e.exports=d():"function"==typeof n.define&&n.define.amd?void 0===(s="function"==typeof(t=d)?t.call(r,a,r,e):t)||(e.exports=s):n.li=d()},59588:e=>{e.exports=function(e,r){var a,t,s=0;function d(){var d,n,i=a,o=arguments.length;e:for(;i;){if(i.args.length===arguments.length){for(n=0;n<o;n++)if(i.args[n]!==arguments[n]){i=i.next;continue e}return i!==a&&(i===t&&(t=i.prev),i.prev.next=i.next,i.next&&(i.next.prev=i.prev),i.next=a,i.prev=null,a.prev=i,a=i),i.val}i=i.next}for(d=new Array(o),n=0;n<o;n++)d[n]=arguments[n];return i={args:d,val:e.apply(null,d)},a?(a.prev=i,i.next=a):t=i,s===r.maxSize?(t=t.prev).next=null:s++,a=i,i.val}return r=r||{},d.clear=function(){a=null,t=null,s=0},d}},28306:(e,r,a)=>{"use strict";var t,s;function d(e){return[e]}function n(){var e={clear:function(){e.head=null}};return e}function i(e,r,a){var t;if(e.length!==r.length)return!1;for(t=a;t<e.length;t++)if(e[t]!==r[t])return!1;return!0}function o(e,r){var a,o;function c(){a=s?new WeakMap:n()}function u(){var a,t,s,d,n,c=arguments.length;for(d=new Array(c),s=0;s<c;s++)d[s]=arguments[s];for(n=r.apply(null,d),(a=o(n)).isUniqueByDependants||(a.lastDependants&&!i(n,a.lastDependants,0)&&a.clear(),a.lastDependants=n),t=a.head;t;){if(i(t.args,d,1))return t!==a.head&&(t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.next=a.head,t.prev=null,a.head.prev=t,a.head=t),t.val;t=t.next}return t={val:e.apply(null,d)},d[0]=null,t.args=d,a.head&&(a.head.prev=t,t.next=a.head),a.head=t,t.val}return r||(r=d),o=s?function(e){var r,s,d,i,o,c=a,u=!0;for(r=0;r<e.length;r++){if(!(o=s=e[r])||"object"!=typeof o){u=!1;break}c.has(s)?c=c.get(s):(d=new WeakMap,c.set(s,d),c=d)}return c.has(t)||((i=n()).isUniqueByDependants=u,c.set(t,i)),c.get(t)}:function(){return a},u.getDependants=r,u.clear=c,c(),u}a.d(r,{Z:()=>o}),t={},s="undefined"!=typeof WeakMap},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},48015:e=>{e.exports=function(){return this.wp.data}()},6293:e=>{e.exports=function(){return this.wp.element}()},54761:e=>{e.exports=function(){return this.wp.hooks}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},73470:e=>{e.exports=function(){return this.wp.url}()},92819:e=>{"use strict";e.exports=window.lodash},87462:(e,r,a)=>{"use strict";function t(){return t=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},t.apply(this,arguments)}a.d(r,{Z:()=>t})},71002:(e,r,a)=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}a.d(r,{Z:()=>t})}},e=>{e.O(0,[5307,1511],(()=>(13722,e(e.s=13722))));var r=e.O();((window.itsec=window.itsec||{}).dashboard=window.itsec.dashboard||{}).api=r}]);