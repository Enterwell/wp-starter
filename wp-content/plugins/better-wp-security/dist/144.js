(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[144],{19144:(e,t,n)=>{"use strict";n.d(t,{UQ:()=>we,T2:()=>ue,qb:()=>C,Z8:()=>z,w2:()=>x,Gs:()=>J,y2:()=>X,fv:()=>Ue,KM:()=>Ce,Xp:()=>he,ss:()=>Le,J$:()=>xe,gN:()=>B,eR:()=>Ze,Lu:()=>Re,rN:()=>Ie,ot:()=>j,s8:()=>v,Yw:()=>q,yR:()=>f,$j:()=>Z,x4:()=>re,yA:()=>G,mp:()=>le,in:()=>oe});var s=n(6293),r=n(64893),i=n(95122),a=n(31511),o=n(94184),l=n.n(o),c=n(92819),d=n(9576);function u(e){let{id:t,isVisible:n,children:r}=e;return(0,s.createElement)("div",{className:"itsec-site-scan__details",id:t,style:{display:n?"block":"none"}},(0,s.createElement)("ul",null,r))}function h(e){let{type:t,status:n,description:a,children:o}=e;const m=(0,d.useInstanceId)(h),[p,g]=(0,s.useState)(!1);let b;switch(n){case"clean":b=(0,i.__)("Clean","better-wp-security");break;case"warn":b=(0,i.__)("Warn","better-wp-security");break;case"error":b=(0,i.__)("Error","better-wp-security");break;default:b=n}const f=(0,s.createElement)("span",{className:`itsec-site-scan__status itsec-site-scan__status--${n}`},b);return(0,s.createElement)("div",{className:l()("itsec-site-scan-results-section",`itsec-site-scan-results-${t}-section`)},(0,c.isEmpty)(o)?(0,s.createElement)("p",null,f," ",a):(0,s.createElement)(s.Fragment,null,(0,s.createElement)("p",null,f,a,(0,s.createElement)(r.Button,{variant:"link",className:"itsec-site-scan-toggle-details",onClick:()=>g(!p),"aria-expanded":p,"aria-controls":`itsec-site-scan__details--${m}`},p?(0,i.__)("Hide Details","better-wp-security"):(0,i.__)("Show Details","better-wp-security"))),(0,s.createElement)(u,{id:`itsec-site-scan__details--${m}`,isVisible:p},o)))}const m=function(e){let{results:t,showErrorDetails:n=!1}=e;const r=t;return(0,s.createElement)(h,{status:"error",description:(0,i.__)("The scan failed to properly scan the site.","better-wp-security")},(0,s.createElement)("p",null,(0,i.sprintf)((0,i.__)("Error Message: %s","better-wp-security"),r.getErrorMessage())),(0,s.createElement)("p",null,(0,i.sprintf)((0,i.__)("Error Code: %s","better-wp-security"),r.getErrorCode())),n&&r.getErrorData()&&(0,s.createElement)(s.Fragment,null,(0,s.createElement)("p",null,(0,i.__)("If you contact support about this error, please provide the following debug details:","better-wp-security")),(0,s.createElement)("pre",null,JSON.stringify({code:r.getErrorCode(),data:r.getErrorData()},null,2))))};function p(e){let{status:t,children:n}=e;return(0,s.createElement)("li",{className:`itsec-site-scan__detail itsec-site-scan__detail--${t}`},(0,s.createElement)("span",null,n))}const g=function(e){let{results:t}=e;return t.errors.length>0&&(0,s.createElement)(h,{type:"system-error",status:"error",description:(0,i.__)("The scan failed to properly scan the site.","better-wp-security")},t.errors.map(((e,t)=>(0,s.createElement)(p,{key:t,status:"error"},e.message))))},b=function(e){let{results:t,entry:n}=e,r=(0,c.get)(t,["_embedded","ithemes-security:site-scan-issues",0],[]);return(0,c.isArray)(r)||(r=[]),(0,s.createElement)(h,{type:"malware",status:n.status,description:n.title},r.filter((e=>e.entry===n.slug)).map(((e,t)=>(0,s.createElement)(p,{key:t,status:e.status},(0,s.createElement)("a",{href:e.link},e.description)))))},f=function(e){let{results:t,showSiteUrl:n=!0,showErrorDetails:r=!0}=e;const o=t.url;let l;return(0,a.ZE)(t)?l=(0,a.NC)(t):"error"===t.code&&(l=(0,a.NC)(t.errors[0])),(0,s.createElement)("div",{className:"itsec-site-scan-results"},n&&o&&(0,s.createElement)("h4",null,(0,i.sprintf)((0,i.__)("Site: %s","better-wp-security"),o)),l?(0,s.createElement)(m,{results:l,showErrorDetails:r}):(0,s.createElement)(s.Fragment,null,(0,s.createElement)(g,{results:t}),t.entries.map(((e,n)=>(0,s.createElement)(b,{results:t,entry:e,key:n})))))};function v(e){let{json:t}=e;return(0,s.createElement)("pre",{className:"itsec-component-print-r"},E((0,c.cloneDeep)(t)))}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if((0,c.isString)(e))return 0===e.length?(0,s.createElement)("strong",null,"[empty string]"):e;if((0,c.isNumber)(e))return(0,s.createElement)("strong",null,`[number] ${e}`);if((0,c.isBoolean)(e))return(0,s.createElement)("strong",null,e?"[boolean] true":"[boolean] false");if(null==e)return(0,s.createElement)("strong",null,"null");if((0,c.isArray)(e)||(0,c.isPlainObject)(e)){const i=[];if(r&&i.push((0,s.createElement)("strong",{key:"header"},"Array")),0===(0,c.size)(e))return i.push("()"),i;if(n===t)return i.push(`(${e.length})`),i;let a=0;for(const t of(0,c.keys)(e))t.length>a&&(a=t.length);const o=y(n);return(0,c.forEach)(e,((e,r)=>{i.push((0,s.createElement)(s.Fragment,{key:r},"\n",o,r,y(a-(0,c.toString)(r).length," "),"  ",(0,s.createElement)("strong",null,"=>")," ",E(e,t,n+1)))})),i}return(0,s.createElement)("strong",null,"[*]")}function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"    ",n="";for(let s=0;s<=e;s++)n+=t;return n}var _=n(99196),N=n(35800);const k=(0,_.lazy)((()=>n.e(544).then(n.bind(n,85544))));function I(){return(0,s.createElement)("span",null,(0,i.__)("Error when loading. Please refresh.","better-wp-security"))}function C(e){let{addErrorBoundary:t=!0,...n}=e;const i=(0,s.createElement)(_.Suspense,{fallback:(0,s.createElement)(r.Spinner,null)},(0,s.createElement)(k,n));return t?(0,s.createElement)(N.ErrorBoundary,{FallbackComponent:I},i):i}var w=n(4942);const S=()=>{};class O extends s.Component{constructor(e){super(e),this.state={isHovering:!1},this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.setIsHovering=this.setIsHovering.bind(this),this.unsetIsHovering=this.unsetIsHovering.bind(this),this.componentWillUnmount=this.componentWillUnmount.bind(this),this.timerIds=[]}onMouseEnter(e){this.props.onMouseEnter({e,setIsHovering:this.setIsHovering,unsetIsHovering:this.unsetIsHovering})}onMouseLeave(e){this.props.onMouseLeave({e,setIsHovering:this.setIsHovering,unsetIsHovering:this.unsetIsHovering})}onMouseOver(e){this.props.onMouseOver({e,setIsHovering:this.setIsHovering,unsetIsHovering:this.unsetIsHovering})}onMouseOut(e){this.props.onMouseOut({e,setIsHovering:this.setIsHovering,unsetIsHovering:this.unsetIsHovering})}componentWillUnmount(){this.clearTimers()}setIsHovering(){this.clearTimers();const e=setTimeout((()=>{const e={isHovering:!0};this.setState(e,(()=>{this.props.onHoverChanged(e)}))}),this.props.hoverDelayInMs);this.timerIds.push(e)}unsetIsHovering(){this.clearTimers();const e=setTimeout((()=>{const e={isHovering:!1};this.setState(e,(()=>{this.props.onHoverChanged(e)}))}),this.props.hoverOffDelayInMs);this.timerIds.push(e)}clearTimers(){const e=this.timerIds;for(;e.length;)clearTimeout(e.pop())}render(){const{children:e,className:t}=this.props;return(0,s.createElement)("div",{className:t,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},e)}}function Z(e){let{size:t,color:n,paused:r}=e;const i={};return t&&(i["--itsec-size"]=(0,c.isNumber)(t)?`${t}px`:t),n&&(i["--itsec-color"]=(0,c.startsWith)(n,"--")?`var(${n})`:n),(0,s.createElement)("div",{style:i,className:l()("itsec-spinner",{"itsec-spinner--paused":r})},(0,s.createElement)("div",null),(0,s.createElement)("div",null))}(0,w.Z)(O,"displayName","HoverDetector"),(0,w.Z)(O,"defaultProps",{hoverDelayInMs:0,hoverOffDelayInMs:0,onHoverChanged:S,onMouseEnter:e=>{let{setIsHovering:t}=e;return t()},onMouseLeave:e=>{let{unsetIsHovering:t}=e;return t()},onMouseOver:S,onMouseOut:S,shouldDecorateChildren:!0}),n(30379);var T=n(87462);function x(e){let t,n,{value:i,onChange:a,options:o,label:d,help:u,disabled:h,readOnly:m,className:p}=e;return(0,c.isArray)(i)?(t=e=>i.includes(e.value),n=e=>t=>a(t?[...i,e.value]:i.filter((t=>t!==e.value)))):(t=e=>i[e.value]||!1,n=e=>t=>a({...i,[e.value]:t})),(0,s.createElement)("fieldset",{className:l()("components-base-control",p)},(0,s.createElement)("div",{className:"components-base-control__field"},(0,s.createElement)("legend",{className:"components-base-control__label"},d),u&&(0,s.createElement)("p",{className:"components-base-control__help"},u),(0,s.createElement)("div",{className:"itsec-components-checkbox-group-control__options"},o.map((e=>(0,s.createElement)(r.CheckboxControl,(0,T.Z)({},(0,c.omit)(e,["value","disabled","readOnly"]),{key:e.value,checked:t(e),onChange:n(e),disabled:h||e.disabled,readOnly:m||e.readOnly,className:t(e)&&"itsec-components-checkbox-group-control__option--is-checked"})))))))}var M=n(59588),L=n.n(M);let D,P;D=Symbol.iterator;class H{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(0,w.Z)(this,"tree",void 0),(0,w.Z)(this,"name",void 0),(0,w.Z)(this,"data",void 0),(0,w.Z)(this,"parent",void 0),(0,w.Z)(this,"children",void 0),this.tree=e,this.name=t,this.data=n,this.parent=s,this.children=r}getParent(){return this.parent?this.tree.nodes[this.parent]:null}getAllParents(){const e=[];let t=this.getParent();for(;t;)e.push(t.name),t=t.getParent();return e}hasChildren(){return this.children.length>0}getAllChildren(){const e=[];if(!this.hasChildren())return e;for(const t of this)e.push(t.name,...t.getAllChildren());return e}*[D](){for(let e=0;e<this.children.length;e++){const t=this.children[e];yield this.tree.nodes[t]}}}P=Symbol.iterator;class A{constructor(){(0,w.Z)(this,"nodes",{}),(0,w.Z)(this,"ordered",[])}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.ordered.push(e),this.nodes[e]?(this.nodes[e].data=t,this.nodes[e].parent=n):this.nodes[e]=new H(this,e,t,n),n&&(this.nodes[n]?this.nodes[n].children.push(e):this.nodes[n]=new H(this,n))}*[P](){for(let e=0;e<this.ordered.length;e++){const t=this.ordered[e];this.nodes[t].parent||(yield this.nodes[t])}}}const R=L()((e=>{const t=new A;for(const n of e)t.add(n.value,n,n.parent);return t}));class $ extends s.Component{constructor(){super(...arguments),(0,w.Z)(this,"props",void 0),this.renderOption=this.renderOption.bind(this),this.isChecked=this.isChecked.bind(this),this.isIndeterminate=this.isIndeterminate.bind(this),this.onChange=this.onChange.bind(this)}indeterminate(e){e.indeterminate=!0}isChecked(e){return!!e&&((0,c.isArray)(this.props.value)?this.props.value.includes(e.name)||this.isChecked(e.getParent()):this.props.value[e.name]||this.isChecked(e.getParent()))}isIndeterminate(e){if(!e.hasChildren())return!1;for(const t of e){if(this.isChecked(t))return!0;if(this.isIndeterminate(t))return!0}return!1}onChange(e,t){const n=[e.name,...e.getAllChildren()],s=t?[]:e.getAllParents();if((0,c.isArray)(this.props.value)){let e;e=t?[...this.props.value,...n]:this.props.value.filter((e=>!n.includes(e)&&!s.includes(e))),this.props.onChange(e)}else this.props.onChange({...this.props.value,...n.reduce(((e,n)=>e[n]=t),{}),...s.reduce(((e,t)=>e[t]=!1),{})})}render(){const{label:e,help:t,options:n}=this.props,r=R(n);return(0,s.createElement)("div",{className:"components-base-control"},(0,s.createElement)("div",{className:"components-base-control__field"},(0,s.createElement)("div",{className:"components-base-control__label"},e),t&&(0,s.createElement)("p",{className:"components-base-control__help"},t)),(0,s.createElement)("ul",{className:"components-hierarchical-checkbox-control__group"},Array.from(r,this.renderOption)))}renderOption(e){const{value:t,selectable:n=!0,...r}=e.data,i=this.isChecked(e),a=!i&&this.isIndeterminate(e);return(0,s.createElement)("li",{key:t,className:l()("components-hierarchical-checkbox-control__option",{"components-hierarchical-checkbox-control__option--has-children":e.hasChildren()})},(0,s.createElement)(z,(0,T.Z)({},r,{checked:!!n&&i,disabled:!n||this.props.disabled,indeterminate:a,onChange:t=>this.onChange(e,t)})),e.hasChildren()&&(0,s.createElement)("ul",{className:"components-hierarchical-checkbox-control__group"},Array.from(e,this.renderOption)))}}const B=$;var F=n(48015);const j=(0,d.compose)([(0,F.withSelect)(((e,t)=>{let{context:n="ithemes-security"}=t;return{notices:e("core/notices").getNotices(n)}})),(0,F.withDispatch)(((e,t)=>{let{context:n="ithemes-security"}=t;return{onRemove:t=>e("core/notices").removeNotice(t,n)}}))])((function(e){let{notices:t,onRemove:n}=e;const i=(0,c.filter)(t,(e=>e.isDismissible&&(!e.type||"default"===e.type))),a=(0,c.filter)(t,(e=>!(e.isDismissible||e.type&&"default"!==e.type))),o=(0,c.filter)(t,{type:"snackbar"});return(0,s.createElement)(s.Fragment,null,(0,s.createElement)(r.NoticeList,{notices:a,className:"components-editor-notices__pinned"}),(0,s.createElement)(r.NoticeList,{notices:i,className:"components-editor-notices__dismissible",onRemove:n}),r.SnackbarList&&(0,s.createElement)(r.SnackbarList,{notices:o,className:"components-editor-notices__snackbar",onRemove:n}))})),K=function(e){let{className:t,status:n,children:a,onRemove:o=c.noop,isDismissible:d=!0,actions:u=[]}=e;const h=l()(t,"notice","notice-alt","notice-"+n,{"is-dismissible":d});return(0,s.createElement)("div",{className:h},(0,s.createElement)("p",null,a,u.map(((e,t)=>{let{className:n,label:i,onClick:a,url:c,isLink:d=!1}=e;return(0,s.createElement)(r.Button,{key:t,href:c,isSmall:!d&&!c,variant:(c||d)&&"link",onClick:c?void 0:()=>{o(),a()},className:l()("notice__action",n)},i)}))),d&&(0,s.createElement)("button",{type:"button",className:"notice-dismiss",onClick:o},(0,s.createElement)("span",{className:"screen-reader-text"},(0,i.__)("Dismiss this notice","better-wp-security"))))};(0,d.compose)([(0,F.withSelect)(((e,t)=>{let{context:n="ithemes-security"}=t;return{notices:e("core/notices").getNotices(n)}})),(0,F.withDispatch)(((e,t)=>{let{context:n="ithemes-security"}=t;return{onRemove:t=>e("core/notices").removeNotice(t,n)}}))])((function(e){let{notices:t,onRemove:n}=e;const i=function(e){if(!r.SnackbarList)return e.length;let t=0;for(const n of e)"snackbar"!==n.type&&t++;return t}(t),a=function(e){const t=(0,s.useRef)();return(0,s.useEffect)((()=>{t.current=e})),t.current}(i);(0,s.useEffect)((()=>{i>a&&window.itsecSettingsPage&&window.itsecSettingsPage.scrollTop()}),[i,a]);const o=r.SnackbarList?(0,c.filter)(t,{type:"snackbar"}):[];return(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{className:"itsec-module-settings-notice-list"},t.map((e=>{return"snackbar"===e.type&&r.SnackbarList?null:(0,s.createElement)(K,(0,T.Z)({},(0,c.omit)(e,["content"]),{key:e.id,onRemove:(t=e.id,()=>n(t))}),e.content);var t}))),r.SnackbarList&&(0,s.createElement)(r.SnackbarList,{notices:o,className:"components-editor-notices__snackbar",onRemove:n}))}));var U=n(11984),V=n(28184),W=n(79526);function z(e){let{id:t,label:n,hideLabelFromVision:i,className:a,heading:o,checked:c,help:u,onChange:h,indeterminate:m,...p}=e;const g=(0,d.useInstanceId)(z);return t=t||`itsec-inspector-checkbox-control-${g}`,(0,s.createElement)(r.BaseControl,{label:o,id:t,help:u,className:a},(0,s.createElement)("span",{className:"components-checkbox-control__input-container"},(0,s.createElement)("input",(0,T.Z)({id:t,className:l()("components-checkbox-control__input",{"components-checkbox-control__input--indeterminate":m}),type:"checkbox",value:"1",onChange:e=>h(e.target.checked),checked:c,"aria-describedby":u?t+"__help":void 0},p,{ref:e=>e&&(e.indeterminate=m)})),c&&(0,s.createElement)(U.Z,{icon:V.Z,className:"components-checkbox-control__checked",role:"presentation"}),m&&(0,s.createElement)(U.Z,{icon:W.Z,className:"components-checkbox-control__checked",role:"presentation"})),n&&(i?(0,s.createElement)(r.VisuallyHidden,{as:"label",htmlFor:t},n):(0,s.createElement)("label",{className:"components-checkbox-control__label",htmlFor:t},n)))}function q(e){let{help:t,label:n,multiple:i=!1,onChange:a,options:o=[],className:l,hideLabelFromVision:u,...h}=e;const m=`inspector-select-control-${(0,d.useInstanceId)(q)}`,p=(0,c.groupBy)(o,"optgroup");return!(0,c.isEmpty)(o)&&(0,s.createElement)(r.BaseControl,{label:n,hideLabelFromVision:u,id:m,help:t,className:l},(0,s.createElement)("select",(0,T.Z)({id:m,className:"components-select-control__input",onChange:e=>{if(i){const t=[...e.target.options].filter((e=>{let{selected:t}=e;return t})).map((e=>{let{value:t}=e;return t}));a(t)}else a(e.target.value)},"aria-describedby":t?`${m}__help`:void 0,multiple:i},h),(0,c.map)(p,((e,t)=>{const n=e.map(((e,t)=>(0,s.createElement)("option",{key:`${e.label}-${e.value}-${t}`,value:e.value,disabled:e.disabled},e.label)));return"undefined"===t?n:(0,s.createElement)("optgroup",{label:t,key:t},n)}))))}function G(e){let{value:t,onChange:n,...i}=e;(0,c.isArray)(t)||(t=(0,c.isString)(t)?[t]:[]);const[a,o]=(0,s.useState)(t.join("\n"));return t.join("\n").trim()!==a.trim()&&o(t.join("\n")),(0,s.createElement)(r.TextareaControl,(0,T.Z)({value:a,onChange:e=>{o(e),n(e.split("\n").map((e=>e.trim())).filter((e=>e.length>0)))}},i))}function J(e){let{id:t,checked:n,onChange:r,label:i,className:a,...o}=e;return t=(0,d.useInstanceId)(J,"itsec-chip-control")||t,(0,s.createElement)("div",{className:l()("itsec-chip-control",a)},(0,s.createElement)("input",(0,T.Z)({type:"checkbox",checked:n,onChange:e=>r(e.target.checked),id:t},o)),(0,s.createElement)("label",{htmlFor:t},i))}function Q(e){let{tabId:t,onClick:n,children:i,selected:a,...o}=e;return(0,s.createElement)(r.Button,(0,T.Z)({role:"tab",tabIndex:a?null:-1,"aria-selected":a,id:t,onClick:n},o),i)}class Y extends s.Component{constructor(){super(...arguments),this.handleClick=this.handleClick.bind(this),this.onNavigate=this.onNavigate.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}handleClick(e){const{onSelect:t=c.noop}=this.props;t(e)}onNavigate(e,t){const n=this.event;n&&"tab"===n.target.getAttribute("role")&&n.preventDefault(),t.click()}onKeyDown(e){this.event=e}render(){const{activeClass:e="is-active",className:t,instanceId:n,orientation:i="horizontal",tabs:a,selected:o,isStyled:d}=this.props,u=(0,c.find)(a,{name:o})||a[0],h=n+"-"+u.name;return(0,s.createElement)("div",{className:l()("itsec-tab-panel",t,{"itsec-tab-panel--styled":d})},(0,s.createElement)(r.NavigableMenu,{role:"tablist",orientation:i,onNavigate:this.onNavigate,onKeyDown:this.onKeyDown,className:"components-tab-panel__tabs"},a.map((t=>(0,s.createElement)(Q,{className:l()("itsec-tab-panel__tab",t.className,{[e]:t.name===u.name}),tabId:n+"-"+t.name,"aria-controls":n+"-"+t.name+"-view",selected:t.name===u.name,key:t.name,onClick:(0,c.partial)(this.handleClick,t.name)},t.title)))),u&&(0,s.createElement)("div",{"aria-labelledby":h,role:"tabpanel",id:h+"-view",className:"components-tab-panel__tab-content",tabIndex:"0"},this.props.children(u)))}}const X=(0,d.withInstanceId)(Y);var ee=n(81834),te=n.n(ee),ne=n(91991);class se extends s.Component{constructor(){super(...arguments),this.handleClick=this.handleClick.bind(this),this.onNavigate=this.onNavigate.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.toggleTab=this.toggleTab.bind(this),this.getSelectedTabs=this.getSelectedTabs.bind(this),this.isSelected=this.isSelected.bind(this),this.getSelectedId=this.getSelectedId.bind(this),this.getLabelledBy=this.getLabelledBy.bind(this),this.getTabId=this.getTabId.bind(this),this.getTabPanelId=this.getTabPanelId.bind(this),this.isTabDisabled=this.isTabDisabled.bind(this),this.isNonMultiSelectableTabSelected=this.isNonMultiSelectableTabSelected.bind(this)}handleClick(e,t){t.metaKey||t.ctrlKey?this.toggleTab(e):this.props.onSelect([e])}onNavigate(e,t){const n=this.event;if(n){if("tab"===n.target.getAttribute("role")&&n.preventDefault(),n.ctrlKey)return;if(n.shiftKey){if(this.isTabDisabled(this.props.tabs[e]))return;const t=this.props.tabs[e].name;return void this.toggleTab(t)}}t.click()}onKeyDown(e){if(!e.nativeEvent&&(this.event=e,e.ctrlKey&&("Space"===e.code||32===e.keyCode))){e.preventDefault();const t=e.target.dataset.tabname;t&&this.toggleTab(t)}}toggleTab(e){const t=(0,c.find)(this.props.tabs,{name:e});t&&!1===t.allowMultiple||(this.props.selected.includes(e)?this.props.onSelect(this.props.selected.filter((t=>t!==e))):this.props.onSelect([...this.props.selected,e]))}getSelectedTabs(){const e=this.props.selected;!e.length&&this.props.initialTab&&e.push(this.props.initialTab);const t=[];return this.props.tabs.forEach((e=>{this.props.selected.includes(e.name)&&t.push(e)})),t}isSelected(e,t){return e.some((e=>e.name===t.name))}isTabDisabled(e){const{pressedModifierKeys:t}=this.props;if(this.props.selected.includes(e.name))return!1;if(!1!==e.allowMultiple&&!this.isNonMultiSelectableTabSelected())return!1;if(t.meta||t.ctrl)return!0;if(t.shift){const{activeElement:e}=document;if(e.parentElement&&e.parentElement.id===`components-tab-panel__tabs-${this.props.instanceId}`)return!0}return!1}isNonMultiSelectableTabSelected(){if(1!==this.props.selected.length)return!1;const e=(0,c.find)(this.props.tabs,{name:this.props.selected[0]});return e&&!1===e.allowMultiple}getSelectedId(e){return 1===e.length?this.getTabPanelId(e[0].name):`components-tab-panel__panel-${this.props.instanceId}-${(0,c.map)(e,"name").join("-")}`}getLabelledBy(e){return e.map((e=>this.getTabId(e.name))).join(",")}getTabId(e){return`components-tab-panel__tab-${this.props.instanceId}-${e}`}getTabPanelId(e){return`components-tab-panel__panel-${this.props.instanceId}-${e}`}componentDidUpdate(e){if(1!==this.props.selected.length)return;if(!te()(this.props.selected,e.selected))return;const t=this.props.selected[0];if((0,c.find)(this.props.tabs,{name:t}))return;const n=(0,c.findIndex)(e.tabs,{name:t});if(-1===n)return;const s=Math.max(n-1,0),r=this.props.tabs[s];r&&this.props.onSelect([r.name])}render(){const{tabs:e,className:t,activeClass:n="is-active",orientation:i="horizontal"}=this.props,a=this.getSelectedTabs(),o=this.getSelectedId(a);return(0,s.createElement)("div",{className:t},(0,s.createElement)(r.NavigableMenu,{role:"tablist","aria-multiselectable":!0,orientation:i,onNavigate:this.onNavigate,onKeyDown:this.onKeyDown,className:"components-tab-panel__tabs",id:`components-tab-panel__tabs-${this.props.instanceId}`},e.map((e=>{const t=this.isSelected(a,e),r=t&&a.length>1?o:this.getTabPanelId(e.name);return(0,s.createElement)(Q,{className:l()(e.className,{[n]:t}),tabId:this.getTabId(e.name),"aria-controls":r,selected:t,disabled:this.isTabDisabled(e),key:e.name,onClick:(0,c.partial)(this.handleClick,e.name),"data-tabname":e.name},e.title)}))),a.length>0&&(0,s.createElement)("div",{"aria-labelledby":this.getLabelledBy(a),role:"tabpanel",id:o,className:"components-tab-panel__tab-content",tabIndex:"0"},this.props.children(a)))}}(0,d.compose)([d.withInstanceId,ne.lo])(se);class re extends s.Component{constructor(){super(...arguments),(0,w.Z)(this,"onSelect",(e=>{this.setState({selected:e})})),this.state={selected:this.props.initialTab||""}}render(){return(0,s.createElement)(X,(0,T.Z)({},this.props,{selected:this.state.selected,onSelect:this.onSelect}))}}var ie=n(64239),ae=n(81019);function oe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;for(let s=0;s<e.length;s++){const r=t(e[s],n,s);if(r!==oe.skip){if(r===oe.halt)return r;if((0,c.isArray)(e[s].children)&&oe.halt===oe(e[s].children,t,e[s]))return oe.halt}}}function le(e){let{id:t,tree:n,active:i,setActive:a,onActivate:o,onLoad:l,label:c,help:d,...u}=e;const h=(0,s.useRef)(),m=(0,s.useMemo)((()=>{const e={};return oe(n,((t,n,s)=>{e[t.id]={item:t,index:s,parent:n?.id}})),e}),[n]),[p,g]=(0,s.useState)([]),[b,f]=(0,s.useState)([]),v=t+"__item__",E=async e=>{!0===e.children&&l&&(f((t=>[...t,e.id])),await l(e.id),f((t=>t.filter((t=>t!==e.id))))),g((t=>t.includes(e.id)?t.filter((t=>t!==e.id)):[...t,e.id]))};return(0,s.createElement)(r.BaseControl,{help:d,className:"itsec-tree"},(0,s.createElement)("span",{className:"components-base-control__label",id:t+"__tree_label"},c),(0,s.createElement)("ul",(0,T.Z)({ref:h,id:t,role:"tree",tabIndex:0,onKeyDown:async e=>{u.onKeyDown&&u.onKeyDown(e);const{keyCode:t}=e;if(o&&[ae.ENTER,ae.SPACE].includes(t)&&o(i),![ae.UP,ae.DOWN,ae.RIGHT,ae.LEFT].includes(t))return;e.stopPropagation(),e.preventDefault();const s=m[i];if(!s)return void a(n[0].id);const{item:r,parent:l}=s;let c;switch(t){case ae.UP:c=function(e,t,n){let s;return oe(e,(e=>e.id===t?oe.halt:(s=e,!1===e.children||n.includes(e.id)?void 0:oe.skip))),s}(n,r.id,p)?.id;break;case ae.DOWN:c=function(e,t,n){let s,r=!1;return oe(e,(e=>(s=e,r?oe.halt:(e.id===t&&(r=!0),!1===e.children||n.includes(e.id)?void 0:oe.skip)))),s}(n,r.id,p)?.id;break;case ae.RIGHT:r.children&&(p.includes(r.id)?c=r.children?.[0].id:await E(r));break;case ae.LEFT:r.children&&p.includes(r.id)?await E(r):c=l}if(c&&(a(c),h.current)){const e=h.current.ownerDocument.getElementById(v+c);e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():(0,ie.Z)(e,{scrollMode:"if-needed"})}},onFocus:i?void 0:()=>a(n[0].id),"aria-activedescendant":i?v+i:void 0,"aria-labelledby":t+"__tree_label"},u),n.map((e=>(0,s.createElement)(ce,{key:e.id,idBase:v,active:i,setActive:a,expandedIds:p,onToggle:E,loadingIds:b,item:e})))))}function ce(e){const{idBase:t,item:n,expandedIds:r,loadingIds:i,onToggle:a,active:o,setActive:c}=e,d=!!n.children,u=r.includes(n.id);return(0,s.createElement)("li",{id:t+n.id,role:"treeitem","aria-selected":o===n.id?"true":void 0,"aria-expanded":d?u:void 0,className:l()("itsec-tree__item",{"itsec-tree__item--loading":i.includes(n.id)})},(0,s.createElement)("span",{onClick:async()=>{await a(n),c(n.id)},"aria-label":n.label},n.label),d&&n.children.length>0&&(0,s.createElement)("ul",{role:"group"},n.children.map((t=>(0,s.createElement)(ce,(0,T.Z)({key:t.id},e,{item:t}))))))}oe.halt=Symbol("halt"),oe.skip=Symbol("skip");const de=["group","treeitem","option","menuitem","tab"].join(" "),ue=(0,s.forwardRef)((function(e,t){let{active:n,onKeyDown:r=c.noop,onNavigate:i,orientation:a="vertical",cycle:o=!0,descendantRoles:l=de,as:d="div",children:u,...h}=e;const m=(0,s.useRef)();return(0,s.useImperativeHandle)(t,(()=>({focus(){m.current.focus()}}))),(0,s.createElement)(d,(0,T.Z)({ref:m,tabIndex:0,"aria-activedescendant":n,"aria-orientation":a,onKeyDown:e=>{const t=function(e,t){let n=[ae.DOWN],s=[ae.UP];return"horizontal"===t&&(n=[ae.RIGHT],s=[ae.LEFT]),"both"===t&&(n=[ae.RIGHT,ae.DOWN],s=[ae.LEFT,ae.UP]),(0,c.includes)(n,e)?1:(0,c.includes)(s,e)?-1:(0,c.includes)([ae.DOWN,ae.UP,ae.LEFT,ae.RIGHT],e)?0:void 0}(e.keyCode,a);if(r(e,t),void 0===t)return;e.stopPropagation(),e.preventDefault();const s=function(e,t){const n=t.split(" ").map((e=>`[role="${e}"]`)).join(", ");return e.querySelectorAll(n)}(m.current,l),d=(0,c.findIndex)(s,{id:n}),u=o?function(e,t,n){const s=e+n;return s<0?t+s:s>=t?s-t:s}(d,s.length,t):d+t;if(u>=0&&u<s.length){const e=s[u];!function(e,t){if(t.scrollIntoViewIfNeeded)return void t.scrollIntoViewIfNeeded();const n=e.ownerDocument.defaultView.getComputedStyle(e),s=parseInt(n.getPropertyValue("border-top-width")),r=t.offsetTop-e.offsetTop<e.scrollTop,i=t.offsetTop-e.offsetTop+t.clientHeight-s>e.scrollTop+e.clientHeight;(r||i)&&(e.scrollTop=t.offsetTop-e.offsetTop-e.clientHeight/2-s+t.clientHeight/2,e.scrollLeft=0)}(m.current,e),i(e.id)}}},h),u)}));function he(){return(0,s.createElement)("div",{style:{flexGrow:1},"aria-hidden":!0,className:"itsec-component-flex-spacer"})}var me=n(52117);const pe=(0,me.Z)(r.Dashicon,{shouldForwardProp:e=>"size"!==e&&"padding"!==e,target:"e15jp5o50"})("border-radius:50%;font-size:calc(",(e=>{let{size:t}=e;return t})," - (",(e=>{let{padding:t}=e;return t})," * 2));padding:",(e=>{let{padding:t}=e;return t}),";padding-left:calc(",(e=>{let{padding:t}=e;return t})," + 0.5px);background:",(e=>{let{theme:t}=e;return t.colors.primary.base}),";color:#ffffff;");function ge(e){let{size:t=20,className:n}=e;const r=`var(--itsec-recommended-icon-size, ${"number"==typeof t?`${t}px`:t})`,i=`calc(${r} / 5)`;return(0,s.createElement)(pe,{className:n,icon:"star-filled",size:r,padding:i})}const be={error:{primary:"#551515",secondary:"#F7ABAB",icon:"warning"},info:{primary:"#005169",secondary:"#ecfaff",icon:"info"},warning:{primary:"#a9582e",secondary:"#fdddcd",icon:"flag"},success:{primary:"#237739",secondary:"#ddf1e2",icon:"yes-alt"}},fe=(0,me.Z)("div",{target:"e2e3eg46"})("display:flex;padding:.75rem .5rem;border-radius:4px;margin-bottom:",(e=>{let{noMargins:t}=e;return!t&&"1rem"}),";background:",(e=>{let{type:t}=e;return be[t].secondary}),";border:",(e=>{let{type:t,hasBorder:n}=e;return n&&`1px solid ${be[t].primary}`}),";"),ve=(0,me.Z)("h3",{target:"e2e3eg45"})("font-size:1.25rem;margin:0 0 0.5rem 0;color:",(e=>{let{type:t}=e;return be[t].primary}),";"),Ee=(0,me.Z)(r.Dashicon,{shouldForwardProp:e=>"type"!==e,target:"e2e3eg44"})("color:",(e=>{let{type:t}=e;return be[t].primary}),";margin-right:0.5rem;"),ye=(0,me.Z)(ge,{target:"e2e3eg43"})({name:"u7ytkp",styles:"margin-right:0.5rem"}),_e=(0,me.Z)("ul",{target:"e2e3eg42"})({name:"ti75j2",styles:"margin:0"}),Ne=(0,me.Z)("li",{target:"e2e3eg41"})("margin:0 0 0.25rem 0;color:",(e=>{let{type:t}=e;return be[t].primary}),";&:last-child{margin-bottom:0;}"),ke=(0,me.Z)(r.Button,{shouldForwardProp:e=>"type"!==e,target:"e2e3eg40"})("margin-left:auto;padding:0!important;min-width:0!important;min-height:0!important;height:min-content!important;&:hover{color:",(e=>{let{theme:t}=e;return t.colors.primary.base}),";}.dashicon{color:",(e=>{let{type:t}=e;return be[t].primary}),";margin-left:0;margin-right:0;&:hover{color:",(e=>{let{theme:t}=e;return t.colors.primary.base}),";}}");function Ie(e){let{type:t="info",title:n,messages:r=[],className:i,onDismiss:a,hasBorder:o,recommended:d,noMargins:u}=e;return r=(0,c.castArray)(r),r.length?(0,s.createElement)(fe,{type:t,hasBorder:o,recommended:d,noMargins:u,className:l()("itsec-message-list",`itsec-message-list--type-${t}`,i)},d?(0,s.createElement)(ye,null):(0,s.createElement)(Ee,{icon:be[t].icon,type:t}),(0,s.createElement)("div",null,n&&(0,s.createElement)(ve,null,n),(0,s.createElement)(_e,null,r.map(((e,n)=>(0,s.createElement)(Ne,{key:n,type:t},e))))),a&&(0,s.createElement)(ke,{icon:"dismiss",type:t,onClick:a})):null}function Ce(e){let{errors:t,apiError:n,schemaError:r,title:i,className:o,hasBorder:l,noMargins:c}=e;const d=[...t||[],...(0,a.Y3)(n),...(r||[]).map((e=>e.stack))];return d.length?(0,s.createElement)(Ie,{messages:d,title:i,className:o,hasBorder:l,noMargins:c,type:"error"}):null}function we(e){let{panels:t,header:n="h3",expanded:r,setExpanded:i,isStyled:a,className:o,allowNone:c}=e;const u=(0,d.useInstanceId)(we,"itsec-accordion"),h=(0,s.useRef)([]),m=e=>{i(c&&e===r?"":e)},p=t.some((e=>!!e.description));return(0,s.createElement)("div",{id:u,className:l()("itsec-accordion",o,{"itsec-accordion--styled":a,"itsec-accordion--has-description":p})},t.map(((e,t)=>{let{name:i,text:a,className:o,render:c=Oe,...d}=e;return(0,s.createElement)(s.Fragment,{key:i},(0,s.createElement)(Se,(0,T.Z)({id:u+"__trigger__"+i,name:i},d,{as:n,controls:u+"__panel__"+i,isExpanded:r===i,onTrigger:m,refs:h,index:t,className:o})),(0,s.createElement)(c,{name:i,text:a,className:l()("itsec-accordion__panel",o,{"itsec-accordion__panel--is-expanded":r===i}),role:"region",id:u+"__panel__"+i,"aria-labelledby":u+"__trigger__"+i}))})))}function Se(e){let{id:t,name:n,title:i,description:a,showSpinner:o,icon:c,controls:d,isExpanded:u,onTrigger:h,className:m,as:p,refs:g,index:b}=e;const f=!0===o?(0,s.createElement)(Z,{size:30}):o;return(0,s.createElement)(p,{className:l()("itsec-accordion__header",m,{"itsec-accordion__header--is-expanded":u,"itsec-accordion__header--has-graphic":f||c})},(0,s.createElement)(r.Button,{id:t+n,icon:u?"arrow-up-alt2":"arrow-down-alt2",onClick:()=>h(n),"aria-expanded":u,"aria-controls":d,ref:e=>g.current[b]=e,onKeyDown:e=>{if(e.keyCode!==ae.UP&&e.keyCode!==ae.DOWN)return;e.preventDefault();const t=e.keyCode===ae.UP?-1:1,n=function(e,t,n){const s=e+n;return s<0?t+s:s>=t?s-t:s}(b,g.current.length,t);g.current[n]?.focus()}},(0,s.createElement)("span",{className:"itsec-accordion__header-title"},i),a&&(0,s.createElement)("span",{className:"itsec-accordion__header-description"},a),f||c&&(0,s.createElement)(r.Dashicon,{icon:c,className:"itsec-accordion__header-icon"})))}function Oe(e){let{text:t,name:n,...r}=e;return(0,s.createElement)("div",r,(0,s.createElement)("p",null,t))}function Ze(e){let{icon:t,className:n,label:i,children:a}=e;const[o,c]=(0,s.useState)(!1);return(0,s.createElement)(r.Button,{icon:t,label:i,onClick:()=>c(!o),"aria-expanded":o,"aria-haspopup":!0,className:l()("itsec-icon-popover__trigger",n&&`${n}__trigger`)},o&&(0,s.createElement)(r.Popover,{noArrow:!1,position:"bottom center",className:l()("itsec-icon-popover",n),focusOnMount:"container",onFocusOutside:()=>c(!1)},a))}var Te=n(73727);function xe(e){let{help:t,to:n}=e;return(0,s.createElement)(Ze,{icon:"info",className:"itsec-help-popover",label:(0,i.__)("Help","better-wp-security")},(0,s.createElement)(Re,{content:t,tagName:"p"}),n&&(0,s.createElement)("footer",null,(0,s.createElement)(Te.rU,{component:(0,ne.Sj)(r.Button),text:(0,i.__)("More","better-wp-security"),to:n,icon:"arrow-right-alt",iconPosition:"right"})))}var Me=n(31600);function Le(e){let{topic:t,fallback:n}=e;const r=(0,F.useSelect)((e=>e(Me.HELP_STORE_NAME).isEnabled()));return void 0===r?null:r?(0,s.createElement)(Pe,{topic:t,fallback:n}):(0,s.createElement)(De,null)}function De(){const[e,t]=(0,s.useState)(!0),[n,a]=(0,s.useState)(!1),{enableHelp:o}=(0,F.useDispatch)(Me.HELP_STORE_NAME);return e&&(0,s.createElement)(r.Modal,{title:(0,i.__)("Privacy Notice","better-wp-security"),onRequestClose:()=>t(!1),className:"itsec-help-list__enable-modal"},(0,s.createElement)("p",null,(0,i.__)("Loading help remotely requires making an API request to iThemes.com. Only the requested help topic is transmitted.","better-wp-security")),(0,s.createElement)("footer",null,(0,s.createElement)("a",{href:"https://www.liquidweb.com/about-us/policies/privacy-policy/"},(0,i.__)("Privacy Policy","better-wp-security")),(0,s.createElement)(r.Button,{isBusy:n,onClick:async()=>{a(!0),await o(),a(!1)},variant:"primary"},(0,i.__)("Continue","better-wp-security"))))}function Pe(e){let{topic:t,fallback:n}=e;const{help:r,isLoaded:a,fallbackHelp:o,fallbackLoaded:l}=(0,F.useSelect)((e=>({help:e(Me.HELP_STORE_NAME).getHelp(t),isLoaded:e(Me.HELP_STORE_NAME).hasFinishedResolution("getHelp",[t]),fallbackHelp:n?e(Me.HELP_STORE_NAME).getHelp(n):[],fallbackLoaded:!n||e(Me.HELP_STORE_NAME).hasFinishedResolution("getHelp",[n])})));if(!a||!l)return null;const d=(0,c.groupBy)([...r,...o],"type");return(0,s.createElement)(React.Fragment,null,(0,s.createElement)(He,{title:(0,i.__)("Help Center","better-wp-security"),icon:"sos",link:"https://help.ithemes.com/hc/en-us/categories/200147050/",items:d.hc}),(0,s.createElement)(He,{title:(0,i.__)("Blog","better-wp-security"),icon:"book-alt",link:"https://ithemes.com/blog/",items:d.post}),(0,s.createElement)(He,{title:(0,i.__)("Video","better-wp-security"),icon:"youtube",link:"https://www.youtube.com/channel/UCYSDQEcxAppePTn5E7iNpFg",items:d.video}))}function He(e){let{title:t,icon:n,link:a,items:o}=e;return(0,s.createElement)(r.Card,{className:l()("itsec-help-list-section",{"itsec-help-list-section--has-content":!!o})},(0,s.createElement)("header",null,(0,s.createElement)("a",{href:a},(0,s.createElement)(r.Dashicon,{icon:n,className:"itsec-help-list-section__icon"}),(0,s.createElement)("h3",null,t),(0,s.createElement)(r.Dashicon,{icon:"arrow-right-alt",className:"itsec-help-list-section__more"}))),(0,s.createElement)("section",null,o?o.map((e=>(0,s.createElement)("article",{key:e.title},(0,s.createElement)("a",{href:e.link},(0,s.createElement)("h4",null,e.title),(0,s.createElement)(Re,{content:e.description,tagName:"p"}))))):(0,s.createElement)("p",null,(0,i.__)("No relevant content at this time.","better-wp-security"))))}var Ae=n(63108);function Re(e){let{transform:t,...n}=e;return(0,s.createElement)(Ae.Lu,(0,T.Z)({},n,{transform:(e,r)=>{if(t){const n=t(e,r);if(void 0!==n)return n}if("a"===e.tagName.toLowerCase()&&e.dataset.itsecPath&&!n.noHtml)return(0,s.createElement)(Te.rU,{to:e.dataset.itsecPath},r)}}))}var $e=n(62845),Be=n(87514),Fe=n.n(Be),je=n(73470);const{useGlobalState:Ke}=(0,$e.r8)({cache:{}});function Ue(e){let{id:t,value:n,disabled:i,readonly:a,onChange:o,label:l,description:u,isMultiple:h=!1,path:m,query:p={},labelAttr:g,idAttr:b="id",searchArg:f="search"}=e;const[v,E]=Ke("cache"),y=(0,d.useInstanceId)(Ue,"itsec-entity-select-control");t=t||y;const[_,N]=(0,s.useState)(""),k=function(e,t,n,r,i,a,o){return(0,s.useCallback)((s=>Fe()({path:(0,je.addQueryArgs)(e,{...t,[i]:s})}).then((e=>e.map((e=>({value:e[r],label:e[n]}))))).then((t=>(o({...a,[e]:{...a[e]||{},...(0,c.mapValues)((0,c.keyBy)(t,"value"),"label")}}),t)))),[e,t,n,r,i,a])}(m,p,g,b,f,v,E);let I;return h?I=(n||[]).filter((e=>void 0!==e)).map((e=>({value:e,label:v[m]?.[e]||e}))):n&&(I={value:n,label:v[m]?.[n]||n}),(0,s.createElement)(r.BaseControl,{className:"itsec-entity-select-control",label:l,help:(0,s.createElement)(Re,{noWrap:!0,content:u}),id:t},(0,s.createElement)(C,{"aria-label":l,"aria-describedby":u?t+"__help":void 0,classNamePrefix:"itsec-entity-select-control-as",inputId:t,isDisabled:i||a,isMulti:h,isClearable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:k,value:I,onChange:e=>o(h?(e||[]).map((e=>e.value)):e?.value),inputValue:_,onInputChange:N}))}},31511:(e,t,n)=>{"use strict";n.d(t,{sE:()=>I,x4:()=>g,PN:()=>h,pL:()=>N,NC:()=>y,N4:()=>_,CO:()=>S,AW:()=>w,SU:()=>C,ZE:()=>E,UC:()=>O,xJ:()=>k,z8:()=>v,Y3:()=>Z,bv:()=>f});var s=n(92819),r=n(6293),i=n(73470),a=n(4942),o=n(13092),l=n(86033);function c(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var d=new WeakMap,u=new WeakMap;class h{constructor(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;c(this,d,{writable:!0,value:{}}),c(this,u,{writable:!0,value:{}}),(0,a.Z)(this,"add",((e,t,n)=>((0,l.Z)(this,d)[e]||((0,l.Z)(this,d)[e]=[]),(0,l.Z)(this,d)[e].push(t),n&&((0,l.Z)(this,u)[e]||((0,l.Z)(this,u)[e]=[]),(0,l.Z)(this,u)[e].push(n)),this))),(0,a.Z)(this,"hasErrors",(()=>this.getErrorCodes().length>0)),(0,a.Z)(this,"getErrorCodes",(()=>Object.keys((0,l.Z)(this,d)))),(0,a.Z)(this,"getErrorCode",(()=>this.getErrorCodes()[0])),(0,a.Z)(this,"getErrorMessages",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(t)return(0,l.Z)(e,d)[t];const n=[];for(const t in(0,l.Z)(e,d))(0,l.Z)(e,d).hasOwnProperty(t)&&n.concat((0,l.Z)(e,d)[t]);return n})),(0,a.Z)(this,"getErrorMessage",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return t=t||e.getErrorCode(),e.getErrorMessages(t)[0]})),(0,a.Z)(this,"getErrorData",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return t=t||e.getErrorCode(),(0,l.Z)(e,u)[t]})),(0,a.Z)(this,"getAllErrorMessages",(()=>{const e=[];for(const t in(0,l.Z)(this,d))(0,l.Z)(this,d).hasOwnProperty(t)&&e.push(...(0,l.Z)(this,d)[t]);return e})),t&&(n&&((0,l.Z)(this,d)[t]=[n]),s&&((0,l.Z)(this,u)[t]=s))}static fromPHPObject(e){const t=new h;return(0,o.Z)(t,d,e.errors),(0,o.Z)(t,u,e.error_data),t}static fromApiError(e){const t=new h;if((0,l.Z)(t,d)[e.code]=[e.message],(0,l.Z)(t,u)[e.code]=[e.data],e.additional_errors)for(const n of e.additional_errors)(0,l.Z)(t,d)[n.code]=[n.message],n.data&&((0,l.Z)(t,u)||(0,o.Z)(t,u,[]),(0,l.Z)(t,u)[n.code].push(n.data));return t}}var m=n(95122);class p extends Error{constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];super(e.message||(0,m.__)("An unknown error occurred.","better-wp-security"),...n),Error.captureStackTrace&&Error.captureStackTrace(this,p),this.__response=e;for(const t in e)e.hasOwnProperty(t)&&Object.defineProperty(this,t,{value:e[t],configurable:!0,enumerable:!0,writable:!0})}toString(){return this.__response.toString()}getResponse(){return this.__response}}class g{constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];(0,a.Z)(this,"type",void 0),(0,a.Z)(this,"error",void 0),(0,a.Z)(this,"data",void 0),(0,a.Z)(this,"success",void 0),(0,a.Z)(this,"info",void 0),(0,a.Z)(this,"warning",void 0),this.type=e,this.error=t,this.data=n,this.success=s,this.info=r,this.warning=i,Object.seal(this)}isSuccess(){return this.type===g.SUCCESS}static async fromResponse(e){const t=t=>{const n=e.headers?.get(`X-Messages-${t}`);return n?JSON.parse(n):[]},n=204!==e.status&&e.json?await e.json():null,s=y(n),r=s.hasErrors()?g.ERROR:g.SUCCESS,i=t("Success"),a=t("Info"),o=t("Warning");return new g(r,s,n,i,a,o)}}Object.defineProperty(g,"SUCCESS",{value:"success",writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(g,"ERROR",{value:"error",writable:!1,enumerable:!1,configurable:!1});const b=(0,r.createContext)({getUrl(e){e="settings"===e?"itsec":"itsec-"+e;const t=(0,i.removeQueryArgs)(document.location.href,...Object.keys((0,i.getQueryArgs)(document.location.href)));return(0,i.addQueryArgs)(t,{page:e})}});function f(e){const{getUrl:t}=(0,r.useContext)(b);return t(e)}function v(e){if(e<=999)return e.toString();if(e<=9999){const t=(e/1e3).toFixed(1);return"0"===t.charAt(t.length-1)?t.replace(".0","k"):`${t}k`}if(e<=99999)return e.toString().substring(0,2)+"k";if(e<=999999)return e.toString().substring(0,3)+"k";if(e<=9999999){const t=(e/1e6).toFixed(1);return"0"===t.charAt(t.length-1)?t.replace(".0","m"):`${t}m`}if(e<=99999999)return e.toString().substring(0,2)+"m";if(e<=999999999)return e.toString().substring(0,3)+"m";if(e<=9999999999){const t=(e/1e9).toFixed(1);return"0"===t.charAt(t.length-1)?t.replace(".0","b"):`${t}b`}return e}function E(e){if(!(0,s.isPlainObject)(e))return!1;const t=Object.keys(e);return 2===t.length&&t.includes("errors")&&t.includes("error_data")}function y(e){return e instanceof h?e:E(e)?h.fromPHPObject(e):function(e){if(!(0,s.isPlainObject)(e))return!1;const t=Object.keys(e);return(3===t.length||4===t.length)&&!(4===t.length&&!t.includes("additional_errors"))&&t.includes("code")&&t.includes("message")&&t.includes("data")}(e)?h.fromApiError(e):new h}function _(e){const t={};for(const[n,s]of e)t[n]=s;return t}function N(e,t){const n=[[],[]];for(const s of e)n[t(s)?0:1].push(s);return n}function k(e){if(e instanceof Error)throw e;throw new p(e)}const I="https://secure.gravatar.com/avatar/d7a973c7dab26985da5f961be7b74480?s=96&d=mm&f=y&r=g";function C(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,s.get)(e,["_links","self",0,"targetHints",t],n?void 0:[])}function w(e){return function(e,t){return(0,s.get)(e,["_links","self",0,"href"])}(e)}function S(e,t){if(e&&e.links)for(const n of e.links)if(n.rel===t)return n}function O(e,t){if("object"!==e.type)return e;let n;for(const r in t)t.hasOwnProperty(r)&&"hidden"===t[r]["ui:widget"]&&(n||(n=(0,s.cloneDeep)(e)),delete n.properties[r]);return n||e}function Z(e){let t=[];if(!e)return t;const n=e instanceof h?e:y((0,s.pick)(e,["code","message","data"]));return"rest_invalid_param"===n.getErrorCode()&&(t=Object.values(n.getErrorData().params)),[...n.getAllErrorMessages(),...t]}},30379:(e,t,n)=>{var s=n(99196);function r(e){return s.createElement("svg",e,[s.createElement("defs",{key:0},s.createElement("style",null,".cls-1{fill:#0083e3;}")),s.createElement("g",{id:"Layer_2","data-name":"Layer 2",key:1},s.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},[s.createElement("path",{className:"cls-1",d:"M102.41,40.58V8a1.74,1.74,0,0,0-1.71-1.74S63.49.22,51.08,0,1.78,6,1.78,6A1.74,1.74,0,0,0,0,7.74V40.58s-1.16,27.36,17.44,48.9c16.52,19.13,30.32,23.66,33.2,24.44a2.6,2.6,0,0,0,1.11,0c2.92-.79,16.7-5.35,33.18-24.44C103.53,67.94,102.41,40.58,102.41,40.58Zm-25,43c-11.21,13-20.79,18.57-25.67,20.8a1.6,1.6,0,0,1-1.14,0C45.76,102.09,36.17,96.5,25,83.53,8.49,64.45,9.15,39.45,9.16,39.19v-25a.86.86,0,0,1,.6-.78A170.63,170.63,0,0,1,50.93,8.21h.71a164.87,164.87,0,0,1,41,5.18.86.86,0,0,1,.6.78V39.23C93.27,39.45,93.92,64.45,77.46,83.53Z",key:0}),s.createElement("path",{className:"cls-1",d:"M51.1,31.87a8.86,8.86,0,1,0,8.83,8.88A8.87,8.87,0,0,0,51.1,31.87Z",key:1}),s.createElement("path",{className:"cls-1",d:"M84.1,39.41v-18a.78.78,0,0,0-.59-.73,156.44,156.44,0,0,0-31.86-3.28H51a162.74,162.74,0,0,0-32,3.34.78.78,0,0,0-.59.73V39.54c0,1.33,0,22.31,13.59,38C39.53,86.36,46.14,91.3,50.7,94a1.12,1.12,0,0,0,1,0c4.53-2.69,11.14-7.63,18.77-16.46C84.41,61.43,84.1,39.66,84.1,39.41ZM63.51,71.6c-1.09,1.28-2.16,2.45-3.2,3.54-.24.25-.43.17-.43-.18V67.4c0-5.72,5.55-8.63,7.38-9.43a1,1,0,0,0,.58-.86V51.37a.38.38,0,0,0-.58-.38A44.13,44.13,0,0,1,34.9,51a.39.39,0,0,0-.58.38v5.74a1,1,0,0,0,.59.84c6.08,2.33,7.32,6.29,7.32,9.52V74.9c0,.35-.19.43-.43.18q-1.53-1.6-3.16-3.48c-11.44-13.26-11.37-31.84-11.37-32V29a.76.76,0,0,1,.62-.72,152.22,152.22,0,0,1,23-1.83h.69a147.44,147.44,0,0,1,22.69,1.76.75.75,0,0,1,.62.72v10.3C74.89,39.58,75,58.31,63.51,71.6Z",key:2})]))])}r.defaultProps={width:"200px",viewBox:"0 0 102.43 113.98"},e.exports=r,r.default=r}}]);