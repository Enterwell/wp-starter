(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[8830],{67788:(e,t,n)=>{"use strict";n.r(t);var a=n(6293),r=n(95122),i=n(3571),l=n(92819),s=n(87514),o=n.n(s),c=n(48015),u=n(65813),d=n(7980),m=n(50460),p=n(31600),h=n(64893),f=n(9576),g=n(71930),E=n(36179),b=n(1986),_=n(52117);const y=(0,_.Z)(g.Tg,{target:"ehnc1sx3"})("border:1px solid ",(({theme:e})=>e.colors.border.normal),";"),v=(0,_.Z)("dl",{target:"ehnc1sx2"})({name:"ti75j2",styles:"margin:0"}),x=(0,_.Z)("dt",{target:"ehnc1sx1"})({name:"akdqam",styles:"margin-top:1rem"}),N=(0,_.Z)("dd",{target:"ehnc1sx0"})({name:"98gkun",styles:"margin:.25rem 0 0 0"}),C=["a","i","b","h2","h3","h4","h5","h6","p"];function S({notification:e,settings:t,onChange:n,usersAndRoles:i,apiError:l}){const s=!e.optional||t.enabled;return(0,a.createElement)(React.Fragment,null,(0,a.createElement)(y,null,(0,a.createElement)(g.mr,{title:e.l10n.label,description:(0,a.createElement)(b.Lu,{content:e.l10n.description,noWrap:!0}),hasBorder:!0}),(0,a.createElement)(d.PrimaryForm,{apiError:l,hasPadding:!0},e.optional&&(0,a.createElement)(h.CheckboxControl,{className:"itsec-nc-notification__enabled",label:(0,r.__)("Enabled","better-wp-security"),checked:t.enabled,onChange:e=>n({...t,enabled:e}),__nextHasNoMarginBottom:!0}),s&&(0,a.createElement)(React.Fragment,null,(0,a.createElement)(I,{notification:e,settings:t,onChange:n}),(0,a.createElement)(O,{notification:e,settings:t,onChange:n}),(0,a.createElement)(w,{notification:e,settings:t,onChange:n,usersAndRoles:i})))),(0,a.createElement)(j,null))}function I({notification:e,settings:t,onChange:n}){const i=(0,a.createElement)("span",null,(0,r.sprintf)((0,r.__)("You can use HTML in your message. Allowed HTML includes: %s.","better-wp-security"),C.join(", "))," ",!!e.tags&&(0,a.createInterpolateElement)((0,r.__)("This notification supports email tags. Tags are formatted as follows <tag />.","better-wp-security"),{tag:(0,a.createElement)("code",null,"{{ $tag_name }}")}));return(0,a.createElement)(d.PrimaryFormSection,{heading:(0,r.__)("Customize","better-wp-security")},e.subject_editable&&(0,a.createElement)(h.TextControl,{label:(0,r.__)("Subject","better-wp-security"),placeholder:e.l10n.subject,value:t.subject||e.l10n.subject,onChange:e=>n({...t,subject:e})}),e.message_editable&&(0,a.createElement)(React.Fragment,null,(0,a.createElement)(h.TextareaControl,{label:(0,r.__)("Message","better-wp-security"),placeholder:e.l10n.message,rows:10,value:t.message||e.l10n.message,onChange:e=>n({...t,message:e}),help:i}),e.tags&&(0,a.createElement)(v,null,(0,l.map)(e.l10n.tags,((e,t)=>(0,a.createElement)(a.Fragment,{key:t},(0,a.createElement)(x,null,(0,a.createElement)("code",null,t)),(0,a.createElement)(N,null,e)))))))}function O({notification:e,settings:t,onChange:n}){const i=(0,f.useInstanceId)(w,"itsec-nc-notification__schedule");return(0,l.isPlainObject)(e.schedule)?(0,a.createElement)(d.PrimaryFormSection,{heading:(0,a.createElement)("label",{htmlFor:i},(0,r.__)("Schedule","better-wp-security"))},(0,a.createElement)(h.SelectControl,{id:i,options:e.l10n.schedule,value:t.schedule,onChange:e=>n({...t,schedule:e})})):null}function w({notification:e,settings:t,onChange:n,usersAndRoles:i}){const l=(0,f.useInstanceId)(w,"itsec-nc-notification__recipients");switch(e.recipient){case"user":return(0,a.createElement)(d.PrimaryFormSection,{className:"itsec-nc-notification__recipients",heading:(0,r.__)("Recipient","better-wp-security")},(0,r.__)("Site Users","better-wp-security"));case"admin":return(0,a.createElement)(d.PrimaryFormSection,{className:"itsec-nc-notification__recipients",heading:(0,r.__)("Recipient","better-wp-security")},(0,r.__)("Admin Emails","better-wp-security"));case"per-use":return(0,a.createElement)(d.PrimaryFormSection,{className:"itsec-nc-notification__recipients",heading:(0,r.__)("Recipient","better-wp-security")},(0,r.__)("Specified when sending","better-wp-security"));case"email-list":return(0,a.createElement)(d.PrimaryFormSection,{heading:(0,a.createElement)("label",{htmlFor:l},(0,r.__)("Recipient","better-wp-security"))},(0,a.createElement)(E.yA,{id:l,help:(0,r.__)("The email address(es) this notification will be sent to. One address per line.","better-wp-security"),value:t.email_list,onChange:e=>n({...t,email_list:e})}));case"user-list":return(0,a.createElement)(d.PrimaryFormSection,{className:"itsec-nc-notification__recipients itsec-nc-notification__recipients--user-list",heading:(0,a.createElement)("label",{htmlFor:l},(0,r.__)("Recipient","better-wp-security"))},(0,a.createElement)(h.SelectControl,{value:t.recipient_type,onChange:e=>n({...t,recipient_type:e}),id:l,options:[{value:"default",label:(0,r.__)("Default Recipients","better-wp-security")},{value:"custom",label:(0,r.__)("Custom","better-wp-security")}]}),"custom"===t.recipient_type&&(0,a.createElement)(z,{help:(0,r.__)("Select which users should be emailed.","better-wp-security"),value:t.user_list||[],onChange:e=>n({...t,user_list:e}),usersAndRoles:i}))}}const L=(0,_.Z)("div",{target:"esifd2m2"})({name:"mdhyel",styles:"width:100%;max-width:600px;flex-grow:1"}),k=(0,_.Z)(g.xv,{target:"esifd2m1"})({name:"1wfa6r1",styles:"color:#6C6C6C;margin-bottom:6rem"}),R=(0,_.Z)(g.zx,{target:"esifd2m0"})({name:"1fo50kt",styles:"margin-top:1.5rem"});function T({usersAndRoles:e,apiError:t}){const{goNext:n}=(0,d.useNavigation)(),i=(0,f.useViewportMatch)("medium");return(0,a.createElement)(L,null,i&&(0,a.createElement)(k,{as:"p",align:"center",size:g.yH.EXTRA_LARGE,variant:g.rK.MUTED,text:(0,r.__)("You’re almost done, just one last topic to cover!","better-wp-security")}),(0,a.createElement)(d.OnboardHeader,{title:(0,r.__)("Notifications","better-wp-security"),description:(0,r.__)("Manage and configure email notifications sent by Solid Security related to various features.","better-wp-security"),showIndicator:!0}),(0,a.createElement)(B,{usersAndRoles:e,apiError:t}),(0,a.createElement)(R,{variant:"primary",onClick:n,text:(0,r.__)("Complete Setup","better-wp-security")}))}var D=n(16550);function A({asyncNotifications:e,asyncUsersAndRoles:t}){const{url:n,path:r,params:{root:i}}=(0,D.$B)(),{status:s,value:o}=e,{status:u,value:m}=t,h=(0,c.useSelect)((e=>e(p.MODULES_STORE_NAME).getError("notification-center")),[]);if("success"!==s&&("pending"!==s||!o)||"success"!==u)return null;const f=(0,a.createElement)(d.ChildPages,{pages:(0,l.map)(o,(e=>({title:e.l10n.label,to:`${n}/${e.slug}`,id:e.slug})))});return(0,a.createElement)(D.rs,null,(0,a.createElement)(D.AW,{path:`${r}/:child`},f,(0,a.createElement)(F,{notifications:o,usersAndRoles:m,apiError:h})),(0,a.createElement)(D.AW,{path:r},f,"settings"===i&&(0,a.createElement)(Z,{usersAndRoles:m,apiError:h}),"settings"!==i&&(0,a.createElement)(T,{usersAndRoles:m,apiError:h})))}function F({notifications:e,usersAndRoles:t,apiError:n}){const{child:r}=(0,D.UO)(),{settings:i}=(0,c.useSelect)((e=>({settings:e(p.MODULES_STORE_NAME).getEditedSetting("notification-center","notifications")})),[]),{editSetting:l}=(0,c.useDispatch)(p.MODULES_STORE_NAME),s=(0,a.useCallback)((e=>l("notification-center","notifications",{...i,[r]:e})),[r,l,i]);return i?(0,a.createElement)(S,{notification:e[r],usersAndRoles:t,settings:i[r]||{},onChange:s,apiError:n}):null}const M=(0,_.Z)(h.Flex,{target:"eyrh6u90"})({name:"hltamm",styles:"margin-top:2rem"});function j({setErrors:e}){const{isDirty:t,isSaving:n}=(0,c.useSelect)((e=>({isDirty:e(p.MODULES_STORE_NAME).areSettingsDirty("notification-center"),isSaving:e(p.MODULES_STORE_NAME).isSavingSettings("notification-center")})),[]),{saveSettings:i,resetSettingEdits:l,validateSettings:s}=(0,c.useDispatch)(p.MODULES_STORE_NAME);return(0,a.createElement)(M,{justify:"end"},(0,a.createElement)(h.FlexItem,null,(0,a.createElement)(g.zx,{onClick:()=>l("notification-center"),disabled:!t,text:(0,r.__)("Undo Changes","better-wp-security")})),(0,a.createElement)(h.FlexItem,null,(0,a.createElement)(g.zx,{onClick:async()=>{const t=await s("notification-center");!0===t?(e?.([]),i("notification-center")):e?.(t.errorText)},disabled:!t,isBusy:n,variant:"primary",text:(0,r.__)("Save All Changes","better-wp-security")})))}const P=(0,_.Z)(g.Tg,{target:"eigqvon0"})("border:1px solid ",(({theme:e})=>e.colors.border.normal),";");function Z({usersAndRoles:e,apiError:t}){const[n,i]=(0,a.useState)([]);return(0,a.createElement)(React.Fragment,null,(0,a.createElement)(P,null,(0,a.createElement)(g.mr,{title:(0,r.__)("Notifications","better-wp-security"),description:(0,r.__)("Manage and configure email notifications sent by Solid Security related to various features.","better-wp-security"),hasBorder:!0}),(0,a.createElement)(B,{usersAndRoles:e,errors:n,apiError:t,hasPadding:!0})),(0,a.createElement)(j,{setErrors:i}))}function B({usersAndRoles:e,errors:t,apiError:n,hasPadding:i}){const{fromEmail:l,defaultRecipients:s}=(0,c.useSelect)((e=>({isDirty:e(p.MODULES_STORE_NAME).areSettingsDirty("notification-center"),fromEmail:e(p.MODULES_STORE_NAME).getEditedSetting("notification-center","from_email")||"",defaultRecipients:e(p.MODULES_STORE_NAME).getEditedSetting("notification-center","default_recipients")||{}})),[]),{editSetting:o}=(0,c.useDispatch)(p.MODULES_STORE_NAME);return(0,a.createElement)(d.PrimaryForm,{apiError:n,errors:t,hasPadding:i},(0,a.createElement)(h.TextControl,{type:"email",value:l,onChange:e=>o("notification-center","from_email",e),label:(0,r.__)("From Email","better-wp-security"),help:(0,r.__)("Solid Security will send notifications from this email address. Leave blank to use the WordPress default.","better-wp-security")}),(0,a.createElement)(g.X6,{level:3,size:g.yH.LARGE,weight:g.fs.HEAVY,variant:g.rK.DARK,text:(0,r.__)("Default Recipients","better-wp-security")}),(0,a.createElement)(z,{help:(0,r.__)("Set the default recipients for any admin-facing notifications.","better-wp-security"),value:s.user_list||[],onChange:e=>o("notification-center","default_recipients",{...s,user_list:e}),usersAndRoles:e}))}function z({value:e,onChange:t,usersAndRoles:n,help:i}){return(0,a.createElement)("fieldset",{className:"itsec-nc-user-role-list"},i&&(0,a.createElement)("legend",null,i),(0,a.createElement)("ul",{className:"itsec-nc-user-role-list__group"},n.roles.map((({value:n,label:i})=>(0,a.createElement)("li",{key:n},(0,a.createElement)(h.CheckboxControl,{label:(0,r.sprintf)((0,r.__)("All “%s” Users","better-wp-security"),i),checked:e.includes(n),onChange:a=>t(a?[...e,n]:e.filter((e=>e!==n)))}))))),(0,a.createElement)("ul",{className:"itsec-nc-user-role-list__group"},n.users.map((({value:n,label:r})=>(0,a.createElement)("li",{key:n},(0,a.createElement)(h.CheckboxControl,{label:r,checked:e.includes(n),onChange:a=>t(a?[...e,n]:e.filter((e=>e!==n)))}))))))}const U=()=>o()({path:"/ithemes-security/rpc/notification-center/available-users-roles"});function W(){const e=(0,c.useSelect)((e=>e(p.MODULES_STORE_NAME).getActiveModules())),t=(0,u.r5)((0,a.useCallback)((()=>o()({path:"/ithemes-security/rpc/notification-center/notifications"})),[e])),n=(0,u.r5)(U);return function(e){const{registerProvider:t}=(0,c.useDispatch)(m.G);(0,a.useEffect)((()=>{t("notifications",(0,r.__)("Notifications","better-wp-security"),50,(({evaluate:t,results:n})=>(0,l.reduce)(e,((e,a,r)=>t.stringMatch(a.l10n.label)||t.stringMatch(a.l10n.description)?(n.items.push({title:a.l10n.label,description:a.l10n.description,route:`/settings/notification-center/${r}`}),e++):e),0)))}),[e,t])}(t.value),(0,a.createElement)(d.Page,{id:"notification-center",title:(0,r.__)("Notifications","better-wp-security"),icon:"email-alt",priority:20,roots:["onboard","import","settings"],key:t.status+n.status},(()=>(0,a.createElement)(A,{asyncNotifications:t,asyncUsersAndRoles:n})))}n.p=window.itsecWebpackPublicPath,(0,r.setLocaleData)({"":{}},"ithemes-security-pro"),(0,i.registerPlugin)("itsec-notification-center-settings",{render:()=>(0,a.createElement)(W,null)})},33590:(e,t,n)=>{"use strict";n.d(t,{bB:()=>$,ZP:()=>X});var a={};n.r(a),n.d(a,{BaseInput:()=>u,CheckboxWidget:()=>p,CheckboxesWidget:()=>h,IncludeExcludeWidget:()=>R,RadioWidget:()=>O,SelectWidget:()=>y,TextareaWidget:()=>x,ToggleWidget:()=>m});var r={};n.r(r),n.d(r,{EntitySelectField:()=>j,FileTreeField:()=>W,TextareaListField:()=>Z,TitleField:()=>A});var i=n(92819),l=n(87462),s=n(6293),o=n(64893),c=n(36179);const u=function(e){const{id:t,label:n,value:a,readonly:r,disabled:u,onBlur:d,onFocus:m,options:p,onChange:h,schema:f,uiSchema:g={},...E}=e;p.inputType?E.type=p.inputType:E.type||("number"===f.type?(E.type="number",E.step="any"):"integer"===f.type?(E.type="number",E.step="1"):E.type="text"),p.autocomplete&&(E.autoComplete=p.autocomplete),f.multipleOf&&(E.step=f.multipleOf),void 0!==f.minimum&&(E.min=f.minimum),void 0!==f.maximum&&(E.max=f.maximum);const b=g["ui:description"]||f.description;return(0,s.createElement)(o.TextControl,(0,l.Z)({label:n,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:b}),readOnly:r,disabled:u,value:a||""},(0,i.omit)(E,["autofocus","formContext","registry","rawErrors"]),{onChange:e=>h(""===e?p.emptyValue:e),onBlur:d&&(e=>d(E.id,e.target.value)),onFocus:m&&(e=>m(E.id,e.target.value))}))};var d=n(54639);function m({schema:e,uiSchema:t={},id:n,value:a,disabled:r,readonly:i,label:l,onBlur:u,onFocus:m,onChange:p}){const h=d.P6.schemaRequiresTrueValue(e),f=t["ui:description"]||e.description;return(0,s.createElement)(o.ToggleControl,{checked:a||!1,onChange:p,required:h,disabled:r,readOnly:i,label:l,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:f}),onBlur:u&&(e=>u(n,e.target.checked)),onFocus:m&&(e=>m(n,e.target.checked))})}function p({schema:e,uiSchema:t={},id:n,value:a,disabled:r,readonly:i,label:l,onBlur:u,onFocus:m,onChange:p}){const h=d.P6.schemaRequiresTrueValue(e),f=t["ui:description"]||e.description;return(0,s.createElement)(o.CheckboxControl,{checked:a||!1,onChange:p,required:h,disabled:r,readOnly:i,label:l,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:f}),onBlur:u&&(e=>u(n,e.target.checked)),onFocus:m&&(e=>m(n,e.target.checked))})}function h(e){const{disabled:t,options:n,value:a,readonly:r,onChange:i,label:l,schema:o,uiSchema:u={}}=e,{enumOptions:d,enumDisabled:m=[],enumDescriptions:p=[],style:h}=n,f=u["ui:description"]||o.description,g=d.map(((e,t)=>({...e,disabled:m.includes(e.value),help:p[t]&&(0,s.createElement)(c.Lu,{noWrap:!0,content:p[t]})})));return(0,s.createElement)(c.w2,{value:a||[],onChange:i,options:g,label:l||u["ui:title"]||o.title,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:f}),readOnly:r,disabled:t,style:h})}const{asNumber:f,guessType:g}=d.P6,E=new Set(["number","integer"]);function b(e,t){const{type:n,items:a}=e;if(""!==t){if("array"===n&&a&&E.has(a.type))return t.map(f);if("boolean"===n)return"true"===t;if("number"===n)return f(t);if(e.enum){if(e.enum.every((e=>"number"===g(e))))return f(t);if(e.enum.every((e=>"boolean"===g(e))))return"true"===t}return t}}function _(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const y=function(e){const{schema:t,uiSchema:n={},id:a,options:r,value:i,label:l,required:u,disabled:d,readonly:m,multiple:p,onChange:h,onBlur:f,onFocus:g,placeholder:E}=e,{enumOptions:y,enumDisabled:v}=r,x=p?[]:"",N=[];p||void 0!==t.default||N.push({value:"",label:E});for(const e of y)N.push({...e,disabled:v&&v.includes(e.value)});const C=n["ui:description"]||t.description;return(0,s.createElement)(o.SelectControl,{multiple:p,options:N,value:void 0===i?x:i,label:l,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:C}),required:u,disabled:d,readOnly:m,onChange:e=>h(b(t,e)),onBlur:f&&(e=>f(a,b(t,_(e,p)))),onFocus:g&&(e=>g(a,b(t,_(e,p))))})},{getUiOptions:v}=d.P6;function x({schema:e,uiSchema:t={},id:n,value:a,disabled:r,readonly:u,label:d,onBlur:m,onFocus:p,onChange:h,...f}){const g=v(t),{rows:E,placeholder:b,description:_=e.description}=g;return(0,s.createElement)(o.TextareaControl,(0,l.Z)({value:void 0===a?"":a,onChange:h,disabled:r,readOnly:u,label:d,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:_}),onBlur:m&&(e=>m(n,e.target.value)),onFocus:p&&(e=>p(n,e.target.value)),rows:E,placeholder:b},(0,i.without)(f,["autofocus","formContext","registry","rawErrors"])))}const{asNumber:N,guessType:C}=d.P6,S=new Set(["number","integer"]);function I(e,t){const{type:n,items:a}=e;if(""!==t){if("array"===n&&a&&S.has(a.type))return t.map(N);if("boolean"===n)return"true"===t;if("number"===n)return N(t);if(e.enum){if(e.enum.every((e=>"number"===C(e))))return N(t);if(e.enum.every((e=>"boolean"===C(e))))return"true"===t}return t}}function O({schema:e,uiSchema:t={},id:n,options:a,value:r,label:i,required:l,disabled:u,readonly:d,onChange:m,onBlur:p,onFocus:h}){const{enumOptions:f}=a,g=t["ui:description"]||e.description;return(0,s.createElement)(o.RadioControl,{selected:r,options:f,label:i,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:g}),required:l,disabled:u,readOnly:d,onChange:t=>m(I(e,t)),onBlur:p&&(t=>p(n,I(e,t.target.value))),onFocus:h&&(t=>h(n,I(e,t.target.value)))})}var w=n(95122),L=n(82839),k=n(81019);function R({id:e,disabled:t,options:n,value:a,onChange:r,schema:l,autofocus:c,readonly:u}){const{enumOptions:d,enumDisabled:m=[],excludeList:{title:p=(0,w.__)("Excluded","better-wp-security"),description:h=(0,w.__)("The list of items to exclude from the selection.","better-wp-security"),button:f=(0,w.__)("Include","better-wp-security")}={},includeList:{title:g=(0,w.__)("Included","better-wp-security"),description:E=(0,w.__)("The list of items to include in the selection.","better-wp-security"),button:b=(0,w.__)("Exclude","better-wp-security")}={},title:_=l.title,description:y=l.description}=n;(0,s.useEffect)((()=>{const e=d.map((e=>e.value)),t=a.filter((t=>e.includes(t)));t.length!==a.length&&r(t)}),[a,d,r]);const[v,x]=(0,i.partition)(d,(e=>!a.includes(e.value)));return(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},_&&(0,s.createElement)(o.BaseControl.VisualLabel,null,_),y&&(0,s.createElement)("p",null,y),(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:e},(0,s.createElement)(T,{id:e+"__exclude",options:v,label:p,description:h,button:f,disabled:t||u,disabledOptions:m,autofocus:c,onToggle:e=>{(0,L.speak)((0,w.sprintf)((0,w.__)("Moved %1$s to %2$s.","better-wp-security"),(0,i.find)(v,{value:e}).label,g)),r([...a,e])}}),(0,s.createElement)(T,{id:e+"__include",options:x,label:g,description:E,button:b,disabled:t||u,disabledOptions:m,onToggle:e=>{(0,L.speak)((0,w.sprintf)((0,w.__)("Moved %1$s to %2$s.","better-wp-security"),(0,i.find)(x,{value:e}).label,p)),r(a.filter((t=>t!==e)))}})))}function T({id:e,label:t,description:n,options:a,button:r,onToggle:l,disabled:u,disabledOptions:d=[],autofocus:m}){const p=e+"__option__",[h,f]=(0,s.useState)("");return h&&!(0,i.find)(a,{value:h})&&f(""),(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,s.createElement)(o.BaseControl,{id:e,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:n}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,s.createElement)("span",{className:"components-base-control__label",id:e+"__label"},t),(0,s.createElement)(c.T2,{role:"listbox",id:e,active:h&&p+h,"aria-labelledby":e+"__label","aria-describedby":n&&e+"__help",onNavigate:e=>f(e.substr(p.length)),onKeyDown:({keyCode:e})=>{if(!h||e!==k.DELETE&&e!==k.BACKSPACE)return;const t=(0,i.findIndex)(a,{value:h}),n=t+1<a.length?t+1:t-1;l(h),f(a[n]?.value||"")},autoFocus:m},a.map((e=>(0,s.createElement)("div",{id:p+e.value,key:e.value,role:u||d.includes(e.value)?"presentation":"option","aria-selected":e.value===h||void 0,onClick:u||d.includes(e.value)?void 0:()=>f(e.value)},e.label))))),(0,s.createElement)(o.Button,{variant:"secondary",disabled:!h,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>l(h),"aria-keyshortcuts":"Delete Backspace"},r))}const D="*";function A(e){const{id:t,title:n,required:a}=e;return(0,s.createElement)("span",{className:"itsec-rjsf-title-field",id:t},n,a&&(0,s.createElement)("span",{className:"required"},D))}var F=n(1986);const{getUiOptions:M}=d.P6;function j({uiSchema:e,schema:t,idSchema:n,name:a,formData:r,disabled:i,readonly:l,onChange:o}){const c=M(e);return(0,s.createElement)(F.fv,{id:n.$id,value:r,disabled:i,readonly:l,onChange:o,isMultiple:"array"===t.type,label:e["ui:title"]||t.title||a,description:e["ui:description"]||t.description,path:c.path,query:c.query,labelAttr:c.labelAttr,idAttr:c.idAttr,searchArg:c.searchArg})}const{getUiOptions:P}=d.P6;function Z({uiSchema:e,schema:t,name:n,formData:a,disabled:r,readonly:i,onChange:l}){const o=e["ui:title"]||t.title||n,u=e["ui:description"]||t.description,d=P(e),{rows:m,placeholder:p}=d;return(0,s.createElement)(c.yA,{label:o,help:(0,s.createElement)(c.Lu,{noWrap:!0,content:u}),disabled:r,readonly:i,rows:m,value:a,onChange:l,placeholder:p})}var B=n(87514),z=n.n(B),U=n(73470);function W({idSchema:e,formData:t,onChange:n,uiSchema:a,schema:r,name:l,disabled:u,readonly:d,autofocus:m}){const p=e.$id,h=a["ui:title"]||r.title||l,f=a["ui:description"]||r.description,[g,E]=(0,s.useState)([]),[b,_]=(0,s.useState)("");(0,s.useEffect)((()=>{z()({path:(0,U.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(E)}),[]);const y=e=>{n(t.includes(e)?t.filter((t=>t!==e)):[...t,e])};return(0,s.createElement)("div",{className:"itsec-rjsf-file-tree"},f&&(0,s.createElement)(c.Lu,{content:f,tagName:"p"}),(0,s.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,s.createElement)("div",null,(0,s.createElement)(c.mp,{tree:g,id:p,label:(0,w.__)("File Selector","better-wp-security"),active:b,setActive:_,onActivate:y,onLoad:async e=>{const t=await z()({path:(0,U.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),n=(0,i.cloneDeep)(g);(0,c.in)(n,(n=>{if(n.id===e)return n.children=t,c.in.halt})),E(n)}}),(0,s.createElement)(o.Button,{variant:"secondary",disabled:!b,className:"itsec-rjsf-file-tree__select",onClick:()=>y(b),"aria-keyshortcuts":"Enter Space"},(0,w.__)("Select","better-wp-security"))),(0,s.createElement)(c.yA,{value:t,onChange:n,className:"itsec-rjsf-file-tree__list",label:h,disabled:u,readonly:d,autoFocus:m})))}function $({name:e,...t}){return(0,s.createElement)(o.Fill,(0,l.Z)({name:`RjsfField${e}`},t))}function q({name:e,...t}){return(0,s.createElement)(o.Slot,(0,l.Z)({name:`RjsfField${e}`},t))}const{ADDITIONAL_PROPERTY_FLAG:H,getUiOptions:V}=d.P6;function K(e){const{id:t,classNames:n,disabled:a,label:r,onKeyChange:i,onDropPropertyClick:l,readonly:c,required:u,schema:d,uiSchema:m}=e,p=`${r} Key`,h=d.hasOwnProperty(H),{removable:f}=V(m);return h&&!1!==f?(0,s.createElement)("div",{className:n},(0,s.createElement)("div",{className:"row"},(0,s.createElement)("div",{className:"col-xs-5 form-additional"},(0,s.createElement)(o.TextControl,{label:p,required:u,id:`${t}-key`,onBlur:e=>i(e.target.value)})),(0,s.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,s.createElement)("div",{className:"col-xs-2"},(0,s.createElement)(o.Button,{icon:"no-alt",isDestructive:!0,disabled:a||c,onClick:l(r)})))):(0,s.createElement)("div",{className:n},e.children)}const{canExpand:Y}=d.P6;function G({className:e,onClick:t,disabled:n}){return(0,s.createElement)("div",{className:"row"},(0,s.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`},(0,s.createElement)(o.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,w.__)("Add","better-wp-security"),tabIndex:"0",onClick:t,disabled:n})))}const Q={FieldTemplate:function(e){const{children:t,errors:n,hidden:a,schema:r,uiSchema:i,formContext:l,onChange:c}=e;if(a)return null;const{resettable:u}=V(i);return(0,s.createElement)(K,e,t,(0,s.createElement)(q,{name:e.id,fillProps:e}),u&&(0,s.createElement)(o.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>c(r.default)},(0,w.__)("Restore Default","better-wp-security")),!0!==l?.disableInlineErrors&&n)},ObjectFieldTemplate:function(e){const{TitleField:t,DescriptionField:n,schema:a,uiSchema:r,properties:i}=e;if(!i.length)return null;const l=(r["ui:sections"]||[]).reduce(((e,t)=>({...e,[t.fields.find((e=>!!a.properties[e]))]:t})),{});return(0,s.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:e.idSchema.$id},(r["ui:title"]||e.title)&&(0,s.createElement)(t,{id:`${e.idSchema.$id}__title`,title:e.title||r["ui:title"],required:e.required,formContext:e.formContext}),e.description&&(0,s.createElement)(n,{id:`${e.idSchema.$id}__description`,description:(0,s.createElement)(c.Lu,{noWrap:!0,content:e.description}),formContext:e.formContext}),i.map((({name:e,content:t})=>l[e]?(0,s.createElement)(s.Fragment,{key:e},(0,s.createElement)("h3",{className:"itsec-rjsf-section-title"},l[e].title),l[e].description&&(0,s.createElement)("p",{className:"itsec-rjsf-section-description"},(0,s.createElement)(c.Lu,{noWrap:!0,content:l[e].description})),t):t)),Y(a,r,e.formData)&&(0,s.createElement)(G,{className:"object-property-expand",onClick:e.onAddClick(a),disabled:e.disabled||e.readonly}))},ErrorList:function({errors:e}){return(0,s.createElement)(c.KM,{errors:e.map((({stack:e}={})=>e)).filter((e=>!!e))})},widgets:a,fields:r},X=Q},50460:(e,t,n)=>{"use strict";n.d(t,{G:()=>P,o:()=>L});var a={};n.r(a),n.d(a,{REGISTER_PROVIDER:()=>F,registerProvider:()=>A});var r={};n.r(r),n.d(r,{getProviders:()=>M});var i=n(87462),l=n(6293),s=n(73727),o=n(16550),c=n(90071),u=n(92819),d=n(64893),m=n(95122),p=n(48015),h=n(9576),f=n(81019),g=n(82839),E=n(71930),b=n(65813),_=n(36179),y=n(86033),v=n(13092);function x(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var N=new WeakMap,C=new WeakMap,S=new WeakMap,I=new WeakMap,O=new WeakMap;class w{constructor(e,t){x(this,N,{writable:!0,value:void 0}),x(this,C,{writable:!0,value:void 0}),x(this,S,{writable:!0,value:void 0}),x(this,I,{writable:!0,value:void 0}),x(this,O,{writable:!0,value:void 0}),(0,v.Z)(this,N,e),(0,v.Z)(this,C,t),(0,v.Z)(this,S,t.select(P).getProviders()),this._prepare()}_prepare(){(0,v.Z)(this,O,(0,y.Z)(this,N).split(/\s+/g).map((e=>e.trim().toLowerCase())).filter((e=>!!e)));const e=(0,y.Z)(this,N).endsWith(" ");(0,v.Z)(this,I,new RegExp((0,y.Z)(this,O).map(((t,n)=>n+1!==(0,y.Z)(this,O).length||e?`(?=.*\\b${(0,u.escapeRegExp)(t)}\\b)`:`(?=.*\\b${(0,u.escapeRegExp)(t)})`)).join("")+".+","gi"))}_stringMatch(e){return e&&(0,y.Z)(this,I).test(e)}_keywordMatch(e){return!(!e||!e.length)&&e.some((e=>(0,y.Z)(this,O).some(((t,n)=>e.includes(" ")?this._stringMatch(e):n===(0,y.Z)(this,O).length-1?e.startsWith(t):t===e))))}getResults(){if((0,y.Z)(this,N).length<3)return[{},0];let e=0;const t=[],n={stringMatch:e=>this._stringMatch(e),keywordMatch:e=>this._keywordMatch(e)};for(const a of(0,y.Z)(this,S)){const r={title:a.title,items:[],groups:{}};e+=a.callback({evaluate:n,results:r,registry:(0,y.Z)(this,C)}),!r.items.length&&(0,u.isEmpty)(r.groups)||t.push(r)}return[t,e]}}const L=(0,l.forwardRef)((function({onPick:e=u.noop,showResults:t},n){const[a,r]=(0,l.useState)(""),[s,o]=(0,l.useState)(!1),c=(0,l.useRef)(),d=(0,l.useRef)(),[_,y]=(0,l.useState)([]),v=(0,p.useRegistry)(),x=(0,l.useCallback)((e=>{const t=new w(e,v).getResults();y(t[0]),(0,g.speak)((0,m.sprintf)((0,m._n)("%d result found.","%d results found.",t[1],"better-wp-security"),t[1]))}),[v]),N=(0,h.useDebounce)(x,50),C=(0,l.useCallback)((e=>{c.current&&(e.preventDefault(),c.current.focus())}),[c]);return(0,h.useKeyboardShortcut)("/",C),(0,l.createElement)("div",(0,i.Z)({className:"itsec-search"},(0,b.Zk)((()=>o(!1)))),(0,l.createElement)("div",null,(0,l.createElement)(E.lD,{value:a,onChange:e=>{r(e),N(e)},onFocus:()=>o(!0),onKeyDown:e=>{e.keyCode===f.DOWN&&(e.preventDefault(),d.current.focus())},ref:(0,b.qq)([n,c]),placeholder:(0,m.__)("Search for features, settings, and more","better-wp-security"),omitSeparators:!0,size:"large"}),(s||t)&&a.length>=3&&(0,l.createElement)(k,{results:_,exitSearch:t=>{e(t),o(!1)},ref:d,onPick:e})))})),k=(0,l.forwardRef)((function({results:e,exitSearch:t,onPick:n},a){const r=(0,l.useRef)();(0,l.useImperativeHandle)(a,(()=>({focus(){r.current.focus()}})));const s=(0,h.useInstanceId)(k,"itsec-search"),p=s+"__result__",g=function(){const e=(0,o.k6)();return(t,n="push")=>e[n]((0,c.ob)(t))}(),[E,b]=(0,l.useState)("");return(0,u.isEmpty)(e)?null:(0,l.createElement)(React.Fragment,null,(0,l.createElement)(d.VisuallyHidden,{id:s+"__label"},(0,m.__)("Search Results","better-wp-security")),(0,l.createElement)(_.T2,{className:"itsec-search__results",id:s,active:E&&p+E,onNavigate:e=>b(e.substring(p.length)),onKeyDown:({keyCode:e})=>{!E||e!==f.ENTER&&e!==f.SPACE||(n(E),g(E),t())},onFocus:()=>{if(!E&&!(0,u.isEmpty)(e)){const[,t]=Object.entries(e)[0];if(t.items?.length)b(t.items[0].route);else if(!(0,u.isEmpty)(t.groups)){const[,e]=Object.entries(t.groups)[0];b(e.items[0].route)}}},role:"listbox",descendantRoles:"option",ref:r,"aria-labelledby":s+"__label"},(0,u.map)(e,((e,n)=>(0,l.createElement)(R,(0,i.Z)({key:n},e,{active:E,idPrefix:p,exitSearch:t}))))))}));function R({title:e,items:t,groups:n,...a}){const r=(0,h.useInstanceId)(k,"itsec-search__kind");return(0,l.createElement)("ul",{className:"itsec-search__kind",role:"group","aria-labelledby":r},(0,l.createElement)("li",{role:"presentation",id:r},e),(t||[]).map((e=>(0,l.createElement)(D,(0,i.Z)({key:e.route},e,a)))),(0,u.map)(n,((e,t)=>(0,l.createElement)(T,(0,i.Z)({key:t},e,a)))))}function T({title:e,items:t,...n}){const a=(0,h.useInstanceId)(k,"itsec-search__group");return(0,l.createElement)("ul",{className:"itsec-search__group",role:"group","aria-labelledby":a},(0,l.createElement)("li",{role:"presentation",id:a},(0,l.createElement)("span",null,e)),(t||[]).map((e=>(0,l.createElement)(D,(0,i.Z)({key:e.route},e,n)))))}function D({title:e,description:t,route:n,active:a,idPrefix:r,exitSearch:i}){return(0,l.createElement)("li",{className:"itsec-search__result",role:"option","aria-selected":a===n||void 0,id:r+n,"aria-label":e},(0,l.createElement)(s.rU,{to:n,tabIndex:-1,onClick:()=>i(n)},(0,l.createElement)("span",null,e),(0,l.createElement)(_.Lu,{content:t,noHtml:!0,tagName:"p"})))}function A(e,t,n,a){return{type:F,slug:e,title:t,priority:n,callback:a}}const F="REGISTER_PROVIDER",M=(0,n(28306).Z)((e=>(0,u.sortBy)(e.providers,"priority")),(e=>e.providers)),j={providers:{}},P="ithemes-security/search";(0,p.registerStore)(P,{actions:a,selectors:r,reducer:function(e=j,t){return t.type===F?{...e,providers:{...e.providers,[t.slug]:(0,u.omit)(t,["type"])}}:e}})},1986:(e,t,n)=>{"use strict";n.d(t,{U9:()=>Le,qb:()=>$,a7:()=>q,kS:()=>Ne,fv:()=>m,KM:()=>f,nU:()=>oe,TR:()=>pe,Lu:()=>x,uC:()=>le,T:()=>L,b:()=>k,Ph:()=>W,_g:()=>ie,ge:()=>J,Qf:()=>ee,oB:()=>ke});var a=n(6293),r=n(62845),i=n(92819),l=n(87514),s=n.n(l),o=n(73470),c=n(64893),u=n(9576);const{useGlobalState:d}=(0,r.r8)({cache:{}});function m({id:e,value:t,disabled:n,readonly:r,onChange:l,label:p,description:h,isMultiple:f=!1,path:g,query:E={},labelAttr:b,idAttr:_="id",searchArg:y="search"}){const[v,N]=d("cache"),C=(0,u.useInstanceId)(m,"itsec-entity-select-control");e=e||C;const[S,I]=(0,a.useState)(""),O=function(e,t,n,r,l,c,u){return(0,a.useCallback)((a=>s()({path:(0,o.addQueryArgs)(e,{...t,[l]:a})}).then((e=>e.map((e=>({value:e[r],label:e[n]}))))).then((t=>(u({...c,[e]:{...c[e]||{},...(0,i.mapValues)((0,i.keyBy)(t,"value"),"label")}}),t)))),[e,t,n,r,l,c,u])}(g,E,b,_,y,v,N);let w;return f?w=(t||[]).filter((e=>void 0!==e)).map((e=>({value:e,label:v[g]?.[e]||e}))):t&&(w={value:t,label:v[g]?.[t]||t}),(0,a.createElement)(c.BaseControl,{className:"itsec-entity-select-control",label:p,help:h&&(0,a.createElement)(x,{noWrap:!0,content:h}),id:e,__nextHasNoMarginBottom:!0},(0,a.createElement)($,{"aria-label":p,"aria-describedby":h?e+"__help":void 0,classNamePrefix:"itsec-entity-select-control-as",inputId:e,isDisabled:n||r,isMulti:f,isClearable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:O,value:w,onChange:e=>l(f?(e||[]).map((e=>e.value)):e?.value),inputValue:S,onInputChange:I}))}var p=n(71930),h=n(31511);function f({errors:e,apiError:t,schemaError:n,title:r,className:i,hasBorder:l}){const s=[...e||[],...(0,h.Y3)(t),...(n||[]).map((e=>e.stack))];return s.length?(0,a.createElement)(p.rN,{messages:s,heading:r,className:i,hasBorder:l,type:"danger"}):null}var g=n(52117);const E=(0,g.Z)("div",{target:"e103ploj0"})({name:"1ff36h2",styles:"flex-grow:1"});function b(){return(0,a.createElement)(E,{"aria-hidden":!0})}var _=n(87462),y=n(63108),v=n(73727);function x({transform:e,...t}){return(0,a.createElement)(y.Lu,(0,_.Z)({},t,{transform:(n,r)=>{if(e){const t=e(n,r);if(void 0!==t)return t}if("a"===n.tagName.toLowerCase()&&n.dataset.itsecPath&&!t.noHtml)return(0,a.createElement)(v.rU,{to:n.dataset.itsecPath},r)}}))}var N=n(95122),C=n(65813),S=n(54639),I=n(33590);const O=(0,S.Zz)(I.ZP),w=(0,g.Z)(O,{target:"e1yg558d0"})(".itsec-rjsf-object-fieldset{display:grid;grid-template-columns:[label fields] minmax(0, 1fr);grid-template-rows:auto;grid-gap:.5rem 0;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){grid-template-columns:[label] 10rem [fields] minmax(0, 1fr);}}.itsec-rjsf-section-description{margin-top:0;grid-column:fields;}>.field-object>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field,&>.itsec-rjsf-section-title{grid-column:label;font-size:1rem;padding-right:1rem;margin-bottom:0;&:not(:first-child){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){&+*{border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;}}}}&>.form-group:not(.field-object){grid-column:label/fields-end;}&>.itsec-rjsf-section-title~.form-group{grid-column:fields;}&>.field-object{grid-column:label/fields-end;}&>.field-description{margin-top:0;}}.itsec-rjsf-object-fieldset>*>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field{grid-column:label;font-size:1rem;padding-right:1rem;}&>.form-group{grid-column:fields;}&>.field-description{grid-column:fields;margin-top:0;}}.components-base-control__label,.components-input-control__label,label,caption,legend{color:",(({theme:e})=>e.colors.text.dark),";}.itsec-highlighted-search-result{.components-base-control__label,.components-input-control__label,label,caption{border-bottom:3px solid ",(({theme:e})=>e.colors.border.info),";padding-bottom:3px;margin-bottom:6px;}.components-base-control__field{margin-bottom:12px;}}.field-object:not(:first-child):not(:empty){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:1rem;padding-top:1rem;}.field-object:empty{display:none;}.itsec-rjsf-title-field+.field-object:not(:first-child),.itsec-rjsf-section-description+.field-object:not(:first-child){border-top:none;margin-top:0;padding-top:0;}");function L({saveLabel:e,isSaving:t,saveDisabled:n,cancelLabel:r,onCancel:i,cancelRoute:l,undoLabel:s,undoDisabled:o,onUndo:d,children:m,errors:p,apiError:h,schemaError:g,withCard:E,alignActions:b,...y}){let v=(0,u.useInstanceId)(L,"itsec-schema-form");v=y.id||v;const x=(0,a.createElement)(React.Fragment,null,(0,a.createElement)(f,{errors:p,apiError:h,schemaError:g}),(0,a.createElement)(k,(0,_.Z)({},y,{id:v})));return(0,a.createElement)(c.Flex,{direction:"column",gap:7,justify:"start",expanded:!1},(0,a.createElement)(c.FlexItem,null,E&&(0,a.createElement)(c.Card,null,(0,a.createElement)(c.CardBody,null,x)),!E&&x),(0,a.createElement)(c.FlexItem,null,(0,a.createElement)(R,{id:v,saveLabel:e,cancelLabel:r,isSaving:t,saveDisabled:n,onCancel:i,cancelRoute:l,undoLabel:s,undoDisabled:o,onUndo:d,align:b},m)))}function k({className:e,...t}){return(0,a.createElement)(w,(0,_.Z)({},t,{className:e,additionalMetaSchemas:[n(27171)]}),(0,a.createElement)(React.Fragment,null))}function R({id:e,saveLabel:t=(0,N.__)("Save","better-wp-security"),isSaving:n,saveDisabled:r,cancelLabel:i=(0,N.__)("Cancel","better-wp-security"),onCancel:l,cancelRoute:s,undoLabel:o=(0,N.__)("Undo Changes","better-wp-security"),undoDisabled:u,onUndo:d,align:m,children:h}){return(0,a.createElement)(c.Flex,{align:m},l&&(0,a.createElement)(c.FlexItem,null,(0,a.createElement)(p.zx,{variant:"tertiary",type:"button",onClick:l},i)),s&&(0,a.createElement)(c.FlexItem,null,(0,a.createElement)(v.rU,{component:(0,C.Sj)(p.zx),variant:"tertiary",type:"button",to:s},i)),!m&&(0,a.createElement)(b,null),h,d&&(0,a.createElement)(c.FlexItem,null,(0,a.createElement)(p.zx,{variant:"secondary",disabled:u,onClick:d},o)),(0,a.createElement)(c.FlexItem,null,(0,a.createElement)(p.zx,{variant:"primary",isBusy:n,disabled:n||r,form:e,type:"submit"},t)))}var T=n(99196),D=n(35800),A=n(12614),F=n(29508);const M=(0,T.lazy)((()=>Promise.all([n.e(4699),n.e(3157)]).then(n.bind(n,23157)))),j=(0,T.lazy)((()=>Promise.all([n.e(4699),n.e(4136)]).then(n.bind(n,64136)))),P=(0,T.lazy)((()=>Promise.all([n.e(4699),n.e(1323)]).then(n.bind(n,31323))));function Z(){return(0,a.createElement)("span",null,(0,N.__)("Error when loading. Please refresh.","better-wp-security"))}const B=(0,F.iv)({name:"1nml846",styles:"input{min-height:0;}input:focus{box-shadow:none;}"});function z(){const e=(0,A.u)();return(0,a.useCallback)((t=>({...t,colors:{...t.colors,primary:e.colors.primary.base,primary75:e.colors.secondary.base,primary50:e.colors.tertiary.base,primary25:e.colors.surface.secondary}})),[e])}function U(){return(0,a.useMemo)((()=>({control:(e,t)=>({...e,minHeight:36,borderColor:t.isFocused?e.borderColor:"rgb(148, 148, 148)",borderRadius:2}),dropdownIndicator:e=>({...e,padding:6}),clearIndicator:e=>({...e,padding:6}),loadingIndicator:e=>({...e,padding:6}),valueContainer:e=>({...e,paddingTop:0,paddingBottom:0}),input:e=>({...e,paddingTop:0,paddingBottom:0})})),[])}function W({addErrorBoundary:e=!0,className:t,...n}){const r=z(),i=U(),l=(0,a.createElement)(T.Suspense,{fallback:(0,a.createElement)(c.Spinner,null)},(0,a.createElement)(M,(0,_.Z)({},n,{className:(0,F.cx)(t,B),theme:r,styles:i})));return e?(0,a.createElement)(D.ErrorBoundary,{FallbackComponent:Z},l):l}function $({addErrorBoundary:e=!0,className:t,...n}){const r=z(),i=U(),l=(0,a.createElement)(T.Suspense,{fallback:(0,a.createElement)(c.Spinner,null)},(0,a.createElement)(j,(0,_.Z)({},n,{className:(0,F.cx)(t,B),theme:r,styles:i})));return e?(0,a.createElement)(D.ErrorBoundary,{FallbackComponent:Z},l):l}function q({addErrorBoundary:e=!0,className:t,...n}){const r=z(),i=U(),l=(0,a.createElement)(T.Suspense,{fallback:(0,a.createElement)(c.Spinner,null)},(0,a.createElement)(P,(0,_.Z)({},n,{className:(0,F.cx)(t,B),theme:r,styles:i})));return e?(0,a.createElement)(D.ErrorBoundary,{FallbackComponent:Z},l):l}var H=n(32010),V=n(60976);const K=(0,g.Z)(p.Tg,{target:"ecpy66c3"})({name:"1x94tvs",styles:"display:flex;align-items:center;flex-shrink:0;padding:.5rem 1.5rem;min-height:calc(30px + 1rem);& .components-button:focus{box-shadow:none;}"}),Y=(0,g.Z)(c.Toolbar,{target:"ecpy66c2"})({name:"gxzf6f",styles:"border:none;max-width:100%;margin-left:auto"}),G=(0,g.Z)("div",{target:"ecpy66c1"})({name:"hlx1h5",styles:"display:flex;gap:0.5rem;margin:0 2rem 0 1rem;flex-grow:1"}),Q=(0,g.Z)(V.Ae,{target:"ecpy66c0"})({name:"1jxlbx4",styles:"height:2rem;width:2rem"});function X({area:e,...t}){return(0,a.createElement)(c.Slot,(0,_.Z)({name:`Toolbar${e}`},t))}function J({area:e="actions",...t}){return(0,a.createElement)(c.Fill,(0,_.Z)({name:`Toolbar${e}`},t))}function ee(){const e=(0,h.bv)("dashboard"),t=(0,u.useViewportMatch)("medium","<");return(0,a.createElement)(K,{role:"region","aria-label":(0,N.__)("Toolbar","better-wp-security")},t?(0,a.createElement)(Q,null):(0,a.createElement)(pe,null),(0,a.createElement)(X,{area:"main"},(e=>(0,a.createElement)(G,null,e))),(0,a.createElement)(Y,{label:(0,N.__)("Toolbar Actions","better-wp-security")},(0,a.createElement)(c.ToolbarButton,{icon:H.Z,href:e,text:(0,N.__)("Dashboard","better-wp-security")}),(0,a.createElement)(X,{area:"actions"})))}const te=(0,g.Z)("nav",{target:"e28bhoc2"})("display:flex;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";"),ne=(0,g.Z)(v.OL,{target:"e28bhoc1"})("display:flex;text-decoration:none;align-items:center;&.active{box-shadow:inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),";}&:focus{color:",(({theme:e})=>e.colors.text.dark),";box-shadow:inset 0 0 0 2px ",(({theme:e})=>e.colors.border.info),",inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),"!important;border-radius:3px!important;}"),ae=(0,g.Z)(p.xv,{target:"e28bhoc0"})({name:"1i2l0vb",styles:"padding:.75rem 1.25rem"}),re=(0,a.createContext)({size:p.yH.LARGE});function ie({className:e,size:t=p.yH.LARGE,children:n}){const r=(0,a.useMemo)((()=>({size:t})),[t]);return(0,a.createElement)(te,{className:e},(0,a.createElement)(re.Provider,{value:r},n))}function le({title:e,...t}){const{size:n}=(0,a.useContext)(re);return(0,a.createElement)(ne,t,(0,a.createElement)(ae,{size:n,weight:p.fs.HEAVY,text:e,align:"center"}))}const se=(0,g.Z)(V.Ae,{shouldForwardProp:e=>"isSmall"!==e,target:"ewrt4zq0"})("height:",(({isSmall:e})=>e?"56px":"120px"),";width:",(({isSmall:e})=>e?"56px":"120px"),";");function oe({icon:e,isSmall:t=!1}){return(0,u.useMediaQuery)("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)")?e:(0,a.createElement)(se,{isSmall:t})}var ce=n(48015),ue=n(31600);const de=(0,g.Z)(V.sX,{target:"e1bzve6y1"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;"),me=(0,g.Z)(V.Pb,{target:"e1bzve6y0"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;");function pe({size:e=25,className:t}){const{installType:n}=(0,ce.useSelect)((e=>({installType:e(ue.coreStore).getInstallType()})),[]);return"free"===n?(0,a.createElement)(de,{size:e,className:t}):(0,a.createElement)(me,{size:e,className:t})}var he=n(59588),fe=n.n(he),ge=n(76292),Ee=n.n(ge),be=n(82506),_e=n(82521);const ye=(0,g.Z)("div",{target:"e1hwued11"})({name:"aj6rbz",styles:"display:flex;gap:0.5rem"}),ve=(0,g.Z)(p.zx,{target:"e1hwued10"})({name:"1o3nkn",styles:"margin-left:auto"}),xe=fe()((()=>[{value:"24-hours",label:(0,N.__)("24 Hours","better-wp-security")},{value:"week",label:(0,N.__)("7 Days","better-wp-security")},{value:"30-days",label:(0,N.__)("30 Days","better-wp-security")},{value:"custom",label:(0,N.__)("Custom","better-wp-security")}]));function Ne({value:e,onChange:t}){const[n,r]=(0,a.useState)(!1),[l,s]=(0,a.useState)(void 0),[o,u]=(0,a.useState)(void 0);let[d,m]=(0,a.useState)(void 0);const h=e,f=function(e){if(!e)return"";const t=new window.Date;let n,a;switch(e){case"24-hours":return(0,N.__)("24 Hours","better-wp-security");case"30-days":n=(0,_e.dateI18n)("M j",t.setDate(t.getDate()-30)),a=(0,_e.dateI18n)("M j, Y");break;case"week":n=(0,_e.dateI18n)("M j",t.setDate(t.getDate()-7)),a=(0,_e.dateI18n)("M j, Y");break;default:n=(0,_e.dateI18n)("M j",e.start),a=(0,_e.dateI18n)("M j, Y",e.end)}return(0,N.sprintf)((0,N.__)("%1$s - %2$s","better-wp-security"),n,a)}(h);return d=d||((0,i.isString)(h)?h:"custom"),(0,a.createElement)("div",null,(0,a.createElement)(p.zx,{onClick:()=>r(!n),title:f,"aria-expanded":n,"aria-label":(0,N.sprintf)((0,N.__)("%s (click to edit)","better-wp-security"),f),variant:"tertiary",text:f,icon:be.Z,iconPosition:"right"}),n&&(0,a.createElement)(c.Modal,{title:(0,N.__)("Change Date Period","better-wp-security"),onRequestClose:()=>r(!1)},(0,a.createElement)(c.SelectControl,{options:xe(),value:d,onChange:e=>m(e)}),(0,a.createElement)(ye,null,"custom"===d&&(0,a.createElement)(React.Fragment,null,(0,a.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,a.createElement)(p.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,N.sprintf)((0,N.__)("From: %s (click to edit","better-wp-security"),(0,_e.dateI18n)("M j",l)),text:(0,N.sprintf)((0,N.__)("From %s","better-wp-security"),(0,_e.dateI18n)("M j",l))}),renderContent:()=>(0,a.createElement)(c.DatePicker,{currentDate:l,onChange:s,isInvalidDate:e=>{if((0,_e.isInTheFuture)(e))return!0;const t=new window.Date;return t.setDate(t.getDate()-60),e<t}})}),(0,a.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,a.createElement)(p.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,N.sprintf)((0,N.__)("To: %s (click to edit","better-wp-security"),(0,_e.dateI18n)("M j",o)),text:(0,N.sprintf)((0,N.__)("To: %s (click to edit","better-wp-security"),(0,_e.dateI18n)("M j",o))}),renderContent:()=>(0,a.createElement)(c.DatePicker,{currentDate:o,onChange:u,isInvalidDate:e=>!!(0,_e.isInTheFuture)(e)||(0,_e.getDate)(l)>e})})),(0,a.createElement)(ve,{variant:"primary",onClick:e=>{let n;if(e.preventDefault(),"custom"===d){const e=Ee()(l).set({hour:0,minute:0,second:0}),t=Ee()(o).set({hour:23,minute:59,second:59});n={start:(0,_e.format)("Y-m-d\\TH:i:s",e),end:(0,_e.format)("Y-m-d\\TH:i:s",t)}}else n=d;t(n),r(!1)},text:(0,N.__)("Apply","better-wp-security")}))))}const Ce=(0,g.Z)(c.Icon,{target:"e1vmfdpe1"})({name:"1svyz14",styles:"background-color:#438C56;border-radius:2rem"}),Se=(0,g.Z)(c.Icon,{target:"e1vmfdpe0"})({name:"x749hy",styles:"background-color:#E6505466;border-radius:2rem;height:0.813rem!important;width:0.813rem!important;padding:2px"});var Ie=n(28184),Oe=n(65202),we=n(67527);function Le(){const{versionActive:e,versionSettings:t,installType:n}=(0,ce.useSelect)((e=>({versionActive:e(ue.modulesStore).isActive("version-management"),versionSettings:e(ue.modulesStore).getSettings("version-management"),installType:e(ue.coreStore).getInstallType()})),[]),r=e&&t.update_if_vulnerable,i="free"===n,l=r?(0,N.__)("Real-Time Updates Active","better-wp-security"):(0,N.__)("Real-Time Updates Inactive","better-wp-security"),s=i?(0,N.__)("Upgrade","better-wp-security"):(0,N.__)("Enable “Auto Update If Fixes Vulnerability” in Version Management","better-wp-security"),o=r?(0,a.createElement)(Ce,{icon:Ie.Z}):(0,a.createElement)(Se,{icon:Oe.Z,style:{fill:"#8A2424"}});return(0,a.createElement)(p.Ct,{text:l,icon:o,iconColor:"#FFFFFF",tooltip:s})}function ke(){const{hasPatchstack:e,installType:t}=(0,ce.useSelect)((e=>({hasPatchstack:e(ue.coreStore).hasPatchstack(),installType:e(ue.coreStore).getInstallType()})),[]),n="free"===t,r=e?(0,N.__)("Virtual Patching Active","better-wp-security"):(0,N.__)("Virtual Patching Inactive","better-wp-security"),i=n?(0,N.__)("Upgrade","better-wp-security"):null,l=e?we.Z:(0,a.createElement)(Se,{icon:Oe.Z,style:{fill:"#8A2424"}});return(0,a.createElement)(p.Ct,{text:r,icon:l,iconColor:"#6817C5",tooltip:i})}},28306:(e,t,n)=>{"use strict";var a,r;function i(e){return[e]}function l(){var e={clear:function(){e.head=null}};return e}function s(e,t,n){var a;if(e.length!==t.length)return!1;for(a=n;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}function o(e,t){var n,o;function c(){n=r?new WeakMap:l()}function u(){var n,a,r,i,l,c=arguments.length;for(i=new Array(c),r=0;r<c;r++)i[r]=arguments[r];for(l=t.apply(null,i),(n=o(l)).isUniqueByDependants||(n.lastDependants&&!s(l,n.lastDependants,0)&&n.clear(),n.lastDependants=l),a=n.head;a;){if(s(a.args,i,1))return a!==n.head&&(a.prev.next=a.next,a.next&&(a.next.prev=a.prev),a.next=n.head,a.prev=null,n.head.prev=a,n.head=a),a.val;a=a.next}return a={val:e.apply(null,i)},i[0]=null,a.args=i,n.head&&(n.head.prev=a,a.next=n.head),n.head=a,a.val}return t||(t=i),o=r?function(e){var t,r,i,s,o,c=n,u=!0;for(t=0;t<e.length;t++){if(!(o=r=e[t])||"object"!=typeof o){u=!1;break}c.has(r)?c=c.get(r):(i=new WeakMap,c.set(r,i),c=i)}return c.has(a)||((s=l()).isUniqueByDependants=u,c.set(a,s)),c.get(a)}:function(){return n},u.getDependants=t,u.clear=c,c(),u}n.d(t,{Z:()=>o}),a={},r="undefined"!=typeof WeakMap},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},7980:e=>{e.exports=function(){return this.itsec.pages.settings}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},82521:e=>{e.exports=function(){return this.wp.date}()},6293:e=>{e.exports=function(){return this.wp.element}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash},76292:e=>{"use strict";e.exports=window.moment}},e=>{e.O(0,[7271,1930,5307,9443,135,1511,976,6179],(()=>(67788,e(e.s=67788))));var t=e.O();((window.itsec=window.itsec||{})["notification-center"]=window.itsec["notification-center"]||{}).settings=t}]);