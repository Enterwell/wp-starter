(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[7118],{20183:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BANS_STORE_NAME:()=>We,CORE_STORE_NAME:()=>Bt,HELP_STORE_NAME:()=>tt,MODULES_STORE_NAME:()=>ut,apiFetch:()=>V,apiFetchBatch:()=>K,apiFetchResult:()=>B,awaitPromise:()=>$,controls:()=>X,coreStore:()=>_l,createNotice:()=>j,dispatch:()=>G,fetch:()=>Y,firewallStore:()=>Mu,logsStore:()=>_o,modulesStore:()=>Rr,parseFetchResponse:()=>W,patchstackStore:()=>Wn,select:()=>M,siteScannerStore:()=>Sn,toolsStore:()=>zr,updateSettings:()=>Z,userSecurityStore:()=>Xi,vulnerabilitiesStore:()=>Vs});var s={};r.r(s),r.d(s,{FAILED_CREATE_BAN:()=>Ae,FAILED_DELETE_BAN:()=>xe,FAILED_QUERY:()=>he,FAILED_UPDATE_BAN:()=>Pe,FINISH_CREATE_BAN:()=>qe,FINISH_DELETE_BAN:()=>Qe,FINISH_QUERY:()=>_e,FINISH_UPDATE_BAN:()=>be,RECEIVE_BAN:()=>ve,RECEIVE_QUERY:()=>Ie,START_CREATE_BAN:()=>Te,START_DELETE_BAN:()=>Ne,START_QUERY:()=>Se,START_UPDATE_BAN:()=>Re,createBan:()=>Ee,deleteBan:()=>me,failedCreateBan:()=>oe,failedDeleteBan:()=>ge,failedUpdateBan:()=>ae,fetchQueryNextPage:()=>se,finishCreateBan:()=>le,finishDeleteBan:()=>fe,finishUpdateBan:()=>de,path:()=>ee,query:()=>te,receiveBan:()=>ie,receiveQuery:()=>ne,refreshQuery:()=>re,startCreateBan:()=>ue,startDeleteBan:()=>ye,startUpdateBan:()=>ce,updateBan:()=>pe});var n={};r.r(n),r.d(n,{getBan:()=>we,getBans:()=>Le,getQueryHeader:()=>Oe,getQueryHeaderLink:()=>De,getQueryHeaderLinks:()=>Fe,getQueryParams:()=>ke,getQueryResults:()=>Ce,isDeleting:()=>Ve,isQuerying:()=>Be,isUpdating:()=>He});var i={};r.r(i),r.d(i,{getBans:()=>Me});var u={};r.r(u),r.d(u,{RECEIVE_HELP:()=>je,enableHelp:()=>Ze,fetchHelp:()=>$e});var o={};r.r(o),r.d(o,{getHelp:()=>Je,isEnabled:()=>Xe});var l={};r.r(l),r.d(l,{getHelp:()=>ze});var c={};r.r(c),r.d(c,{EDIT_MODULE:()=>bt,EDIT_SETTING:()=>Ct,EDIT_SETTINGS:()=>Lt,FAILED_SAVING_MODULES:()=>Qt,FAILED_SAVING_SETTINGS:()=>kt,FINISH_SAVING_MODULES:()=>xt,FINISH_SAVING_SETTINGS:()=>wt,RECEIVE_MODULE:()=>Rt,RECEIVE_MODULES:()=>vt,RECEIVE_SETTINGS:()=>Ut,RESET_MODULE_EDITS:()=>Pt,RESET_SETTING_EDIT:()=>Dt,RESET_SETTING_EDITS:()=>Ft,START_SAVING_MODULES:()=>Nt,START_SAVING_SETTINGS:()=>Ot,activateModule:()=>at,deactivateModule:()=>dt,editModule:()=>ot,editSetting:()=>ft,editSettings:()=>gt,fetchModules:()=>ht,receiveModule:()=>qt,receiveModules:()=>Tt,receiveSettings:()=>At,resetModuleEdits:()=>ct,resetSettingEdits:()=>Et,saveModules:()=>lt,saveSettings:()=>pt,setModulesStatus:()=>yt,updateSettings:()=>mt,validateSettings:()=>It});var a={};r.r(a),r.d(a,{__unstableGetAllEditedSettings:()=>cr,__unstableGetAllSettings:()=>lr,areSettingsDirty:()=>ur,getActiveModules:()=>Wt,getDirtyModules:()=>Jt,getDirtySettings:()=>ir,getEditedModule:()=>Yt,getEditedModules:()=>Gt,getEditedSetting:()=>sr,getEditedSettings:()=>rr,getError:()=>or,getModule:()=>$t,getModuleEdits:()=>jt,getModules:()=>Mt,getSetting:()=>er,getSettingEdits:()=>tr,getSettingSchema:()=>ar,getSettings:()=>zt,getSettingsConditionalSchema:()=>yr,isActive:()=>Zt,isModuleDirty:()=>Xt,isSavingModule:()=>Kt,isSavingSettings:()=>nr});var d={};r.r(d),r.d(d,{__unstableGetAllEditedSettings:()=>mr,__unstableGetAllSettings:()=>pr,getActiveModules:()=>hr,getEditedModule:()=>_r,getEditedModules:()=>Ir,getEditedSetting:()=>Ar,getEditedSettings:()=>qr,getModule:()=>Sr,getModules:()=>fr,getSetting:()=>Tr,getSettings:()=>Er});var y={};r.r(y),r.d(y,{FAILED_TOGGLE_TOOL:()=>Cr,FINISH_TOGGLE_TOOL:()=>Dr,FINISH_TOOL:()=>Ur,RECEIVE_TOOLS:()=>Qr,START_TOGGLE_TOOL:()=>Lr,START_TOOL:()=>xr,fetchTools:()=>br,runTool:()=>Pr,toggleTool:()=>Nr});var g={};r.r(g),r.d(g,{getLastError:()=>$r,getLastResult:()=>Yr,getResolvedTools:()=>kr,getRunning:()=>Mr,getTool:()=>Br,getTools:()=>wr,getToolsConfig:()=>Vr,isRunning:()=>Gr,isUpdating:()=>Wr});var f={};r.r(f),r.d(f,{getResolvedTools:()=>Kr,getTool:()=>Jr,getTools:()=>jr});var E={};r.r(E),r.d(E,{FAILED_ACTION:()=>Ss,FAILED_QUERY:()=>ps,FINISH_ACTION:()=>Is,FINISH_QUERY:()=>Es,RECEIVE_QUERY:()=>gs,RECEIVE_VULNERABILITY:()=>_s,START_ACTION:()=>ms,START_QUERY:()=>fs,applyVulnerabilityAction:()=>as,deactivateSoftware:()=>cs,fetchQueryNextPage:()=>is,fetchQueryPrevPage:()=>ns,fixVulnerability:()=>ls,muteVulnerability:()=>os,query:()=>rs,receiveQuery:()=>ds,receiveVulnerability:()=>ys,refreshQuery:()=>ss});var p={};r.r(p),r.d(p,{getQueryHeader:()=>bs,getQueryHeaderLink:()=>qs,getQueryHeaderLinks:()=>As,getQueryParams:()=>Ps,getQueryResults:()=>Ts,getVulnerabilities:()=>hs,getVulnerability:()=>Ns,getVulnerabilityActions:()=>xs,getVulnerabilityById:()=>Qs,isApplyingAction:()=>Fs,isDeactivatingSoftware:()=>Ds,isFixing:()=>Cs,isMuting:()=>Ls,isQuerying:()=>Us,queryHasNextPage:()=>Rs,queryHasPrevPage:()=>vs});var m={};r.r(m),r.d(m,{getVulnerabilities:()=>Os,getVulnerabilityById:()=>ks});var I={};r.r(I),r.d(I,{FAILED_QUERY:()=>tn,FAILED_SCAN:()=>un,FINISH_QUERY:()=>en,FINISH_SCAN:()=>nn,RECEIVE_QUERY:()=>Xs,RECEIVE_SCAN:()=>rn,START_QUERY:()=>zs,START_SCAN:()=>sn,fetchQueryNextPage:()=>$s,fetchQueryPrevPage:()=>Ws,query:()=>Gs,receiveQuery:()=>Js,receiveScan:()=>Ks,refreshQuery:()=>Ys,runScan:()=>js});var S={};r.r(S),r.d(S,{getQueryHeader:()=>dn,getQueryHeaderLink:()=>cn,getQueryHeaderLinks:()=>an,getQueryParams:()=>yn,getQueryResults:()=>ln,getScan:()=>gn,getScans:()=>on,isQuerying:()=>fn,isScanning:()=>En});var _={};r.r(_),r.d(_,{getScans:()=>pn});var h={};r.r(h),r.d(h,{FAILED_QUERY:()=>Qn,FINISH_QUERY:()=>Nn,RECEIVE_QUERY:()=>xn,START_QUERY:()=>Pn,fetchQueryNextPage:()=>vn,fetchQueryPrevPage:()=>An,query:()=>Tn,receiveQuery:()=>bn,refreshQuery:()=>qn});var T={};r.r(T),r.d(T,{getLastFetchError:()=>Vn,getPatchstackVulnerabilities:()=>Un,getPatchstackVulnerability:()=>Ln,getQueryHeader:()=>On,getQueryHeaderLink:()=>Dn,getQueryHeaderLinks:()=>Fn,getQueryParams:()=>kn,getQueryResults:()=>Cn,isQuerying:()=>Bn,queryHasNextPage:()=>wn,queryHasPrevPage:()=>Hn});var q={};r.r(q),r.d(q,{getPatchstackVulnerabilities:()=>Mn});var A={};r.r(A),r.d(A,{CLOSE_QUICK_EDIT:()=>Ri,CONFIRM_QUICK_EDIT:()=>bi,FAILED_ACTION:()=>_i,FAILED_QUERY:()=>mi,FINISH_ACTION:()=>Si,FINISH_QUERY:()=>pi,OPEN_QUICK_EDIT:()=>vi,RECEIVE_QUERY:()=>fi,RECEIVE_USER:()=>hi,REMOVE_SELECTED_USERS:()=>Pi,START_ACTION:()=>Ii,START_QUERY:()=>Ei,TOGGLE_SELECTED_USER:()=>qi,TOGGLE_SELECT_ALL:()=>Ai,UPDATE_SELECTION_TYPE:()=>Ti,applyQueryActionsToUsers:()=>ii,applyQuickActionsToQuery:()=>ni,closeQuickEdit:()=>yi,confirmQuickEdit:()=>gi,fetchQueryNextPage:()=>ei,fetchQueryPrevPage:()=>zn,openQuickEdit:()=>di,query:()=>Jn,quickEditsSuccessSnackbar:()=>ui,receiveQuery:()=>ri,receiveUser:()=>si,refreshQuery:()=>Xn,removeSelectedUsers:()=>ai,toggleSelectAll:()=>li,toggleSelectedUser:()=>ci,updateUserSelectionType:()=>oi});var v={};r.r(v),r.d(v,{getCurrentlySelectedUsers:()=>Bi,getQueryHeader:()=>Di,getQueryHeaderLink:()=>xi,getQueryHeaderLinks:()=>Ui,getQueryParams:()=>Fi,getQueryResults:()=>Qi,getQuickActionsError:()=>Vi,getQuickEditActions:()=>$i,getQuickEditState:()=>Wi,getSelectAllState:()=>Mi,getUser:()=>Oi,getUserById:()=>ki,getUserSelectionType:()=>wi,getUsers:()=>Ni,isApplyingQuickActions:()=>Hi,isQuerying:()=>Gi,isUserSelected:()=>Yi,queryHasNextPage:()=>Ci,queryHasPrevPage:()=>Li});var R={};r.r(R),r.d(R,{getUserById:()=>ji,getUsers:()=>Zi});var b={};r.r(b),r.d(b,{FAILED_QUERY:()=>mu,FINISH_QUERY:()=>pu,RECEIVE_ITEM:()=>fu,RECEIVE_QUERY:()=>gu,START_QUERY:()=>Eu,deleteItem:()=>du,editItem:()=>uu,fetchQueryNextPage:()=>nu,fetchQueryPrevPage:()=>su,query:()=>tu,refreshQuery:()=>ru,resetAllEdits:()=>lu,resetEdits:()=>ou,saveEditedItem:()=>cu,saveItem:()=>au});var P={};r.r(P),r.d(P,{getEditedItem:()=>Nu,getFirewallRules:()=>Iu,getItem:()=>Ru,getItemById:()=>bu,getLastDeleteError:()=>Cu,getLastSaveError:()=>Lu,getQueryHeader:()=>Au,getQueryHeaderLink:()=>_u,getQueryHeaderLinks:()=>hu,getQueryParams:()=>vu,getQueryResults:()=>Su,isDeleting:()=>Uu,isDirty:()=>Qu,isQuerying:()=>Pu,isSaving:()=>xu,queryHasNextPage:()=>qu,queryHasPrevPage:()=>Tu});var N={};r.r(N),r.d(N,{getEditedItem:()=>Fu,getFirewallRules:()=>Du,getItemById:()=>Ou});var Q={};r.r(Q),r.d(Q,{FAILED_QUERY:()=>ro,FINISH_QUERY:()=>to,RECEIVE_LOG:()=>so,RECEIVE_QUERY:()=>zu,START_QUERY:()=>eo,fetchQueryNextPage:()=>ju,fetchQueryPrevPage:()=>Zu,query:()=>Wu,receiveLog:()=>Xu,receiveQuery:()=>Ju,refreshQuery:()=>$u});var x={};r.r(x),r.d(x,{getLog:()=>fo,getLogById:()=>Eo,getLogs:()=>no,getQueryHeader:()=>ao,getQueryHeaderLink:()=>uo,getQueryHeaderLinks:()=>oo,getQueryParams:()=>yo,getQueryResults:()=>io,isQuerying:()=>go,queryHasNextPage:()=>co,queryHasPrevPage:()=>lo});var U={};r.r(U),r.d(U,{getLogById:()=>mo,getLogs:()=>po});var L={};r.r(L),r.d(L,{getActorTypes:()=>Qo,getActors:()=>xo,getBatchMaxItems:()=>Co,getCurrentUser:()=>To,getCurrentUserId:()=>qo,getFeatureFlags:()=>Lo,getIndex:()=>Ro,getInstallType:()=>Fo,getRequirementsInfo:()=>No,getRoles:()=>Po,getSchema:()=>bo,getServerType:()=>Do,getSiteInfo:()=>Uo,getUser:()=>ho,hasPatchstack:()=>Oo,isLiquidWebCustomer:()=>ko,isSavingCurrentUser:()=>vo,isSavingUser:()=>Ao});var C={};r.r(C),r.d(C,{LOAD_INITIAL_FEATURE_FLAGS:()=>sl,RECEIVE_ACTORS:()=>tl,RECEIVE_ACTOR_TYPES:()=>el,RECEIVE_BATCH_MAX_ITEMS:()=>nl,RECEIVE_CURRENT_USER_ID:()=>zo,RECEIVE_INDEX:()=>Jo,RECEIVE_SITE_INFO:()=>rl,RECEIVE_USER:()=>Xo,__unstableLoadInitialFeatureFlags:()=>jo,fetchIndex:()=>wo,fetchUser:()=>Mo,receiveActorTypes:()=>Wo,receiveActors:()=>$o,receiveBatchMaxItems:()=>Ko,receiveCurrentUserId:()=>Yo,receiveIndex:()=>Ho,receiveSiteInfo:()=>Zo,receiveUser:()=>Go,saveCurrentUser:()=>Vo,saveUser:()=>Bo});var D={};r.r(D),r.d(D,{getActorTypes:()=>El,getActors:()=>pl,getBatchMaxItems:()=>Il,getCurrentUser:()=>fl,getIndex:()=>il,getInstallType:()=>al,getRequirementsInfo:()=>ll,getRoles:()=>ol,getSchema:()=>ul,getServerType:()=>cl,getSiteInfo:()=>ml,getUser:()=>gl,hasPatchstack:()=>dl,isLiquidWebCustomer:()=>yl});var F=r(48015),O=r(92819),k=r(87514),w=r.n(k),H=r(31511);function V(e){return{type:"API_FETCH",request:e}}function B(e){return{type:"API_FETCH_RESULT",request:e}}function M(e,t,...r){return{type:"SELECT",storeKey:e,selectorName:t,args:r}}function G(e,t,...r){return{type:"DISPATCH",storeKey:e,actionName:t,args:r}}function Y(e,t){return{type:"FETCH",request:e,init:t}}function W(e){return{type:"PARSE_FETCH_RESPONSE",response:e}}function $(e,t){return{type:"AWAIT_PROMISE",promise:e,delay:t}}function Z(e,t){return{type:"UPDATE_SETTINGS",module:e,settings:t}}function j(e="info",t,r={}){return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}function K(e){return{type:"API_FETCH_BATCH",batch:e}}const J={AWAIT_PROMISE:({promise:e,delay:t})=>{return t?Promise.all([e,(r=t,new Promise((e=>setTimeout(e,r))))]):e;var r},API_FETCH:({request:e})=>w()(e).catch(H.xJ),API_FETCH_RESULT:({request:e})=>w()({...e,parse:!1}).then(H.x4.fromResponse).catch(H.xJ).catch((e=>e.getResponse?H.x4.fromResponse(e.getResponse()):new H.x4(H.x4.ERROR,new H.PN("unknown_error","Unknown error")))),SELECT({storeKey:e,selectorName:t,args:r}){const s=(0,F.select)(e)[t];return s.hasResolver?(({storeKey:e,selectorName:t,args:r})=>new Promise((s=>{const n=()=>(0,F.select)("core/data").hasFinishedResolution(e,t,r),i=()=>(0,F.select)(e)[t].apply(null,r),u=i();if(n())return s(u);const o=(0,F.subscribe)((()=>{n()&&(o(),s(i()))}))})))({storeKey:e,selectorName:t,args:r}):s(...r)},DISPATCH:({storeKey:e,actionName:t,args:r})=>(0,F.dispatch)(e)[t](...r),PARSE_FETCH_RESPONSE:async function({response:e}){return await e.json()},FETCH:({request:e,init:t})=>window.fetch(e,t),UPDATE_SETTINGS:(0,F.createRegistryControl)((e=>({module:t,settings:r})=>e.dispatch("ithemes-security/modules").updateSettings(t,r))),CREATE_NOTICE({status:e,content:t,options:r}){r.autoDismiss&&(r.id=r.id||(0,O.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,F.dispatch)("core/notices").removeNotice(r.id,r.context)),r.autoDismiss)),(0,F.dispatch)("core/notices").createNotice(e,t,r)},API_FETCH_BATCH:(0,F.createRegistryControl)((e=>async({batch:t})=>{const r=await e.resolveSelect(Bt).getBatchMaxItems(),s=(0,O.chunk)(t,r||25),n=[],i=[];if(!s.length)return[];for(const e of s)try{const t=await J.API_FETCH({request:{path:"/batch/v1",method:"POST",data:{requests:e}}});i.push(...t.responses)}catch(t){n.push(t),i.push(...(0,O.times)(e.length,(0,O.constant)({body:t,status:500,headers:{}})))}if(n.length===s.length)throw n[0];return i}))},X=J;var z=r(73470);const ee="/ithemes-security/v1/bans";function*te(e,t={}){let r,s;yield{type:Se,queryId:e,queryParams:t};try{r=yield V({path:(0,z.addQueryArgs)(ee,t),parse:!1}),s=yield W(r)}catch(r){return yield{type:he,queryId:e,queryParams:t,error:r},r}return yield ne(e,t.context||"view",r,s,"replace"),yield{type:_e,queryId:e,queryParams:t,response:r},r}function*re(e){const t=yield M("ithemes-security/bans","getQueryParams",e);yield*te(e,t)}function*se(e,t="append"){const r=yield M("ithemes-security/bans","getQueryHeaderLink",e,"next");if(!r)return[];let s,n;yield{type:Se,queryId:e};try{s=yield V({url:r.link,parse:!1}),n=yield W(s)}catch(t){return yield{type:he,queryId:e,error:t},t}const i=(0,z.getQueryArg)(r.link,"context")||"view";return yield ne(e,i,s,n,t),yield{type:_e,queryId:e,response:s},s}function ne(e,t,r,s,n){return{type:Ie,queryId:e,context:t,response:r,items:s,mode:n}}function ie(e){return{type:ve,ban:e}}function ue(e){return{type:Te,ban:e}}function oe(e,t){return{type:Ae,ban:e,error:t}}function le(e,t){return{type:qe,ban:e,response:t}}function ce(e,t){return{type:Re,self:e,ban:t}}function ae(e,t){return{type:Pe,self:e,error:t}}function de(e,t){return{type:be,self:e,response:t}}function ye(e){return{type:Ne,self:e}}function ge(e,t){return{type:xe,self:e,error:t}}function fe(e){return{type:Qe,self:e}}function*Ee(e,t){const r={method:"POST",data:t};let s;(0,z.isURL)(e)?r.url=e:r.path=`${ee}/${e}`,yield ue(t);try{s=yield V(r)}catch(e){return yield oe(t,e),e}return yield le(t,s),yield ie(s),s}function*pe(e,t){const r=(0,O.isObject)(e)?(0,H.AW)(e):e;let s;yield ce(r,t);try{s=yield V({url:r,method:"PUT",data:t})}catch(e){return yield ae(r,e),e}return yield de(r,s),yield ie(s),s}function*me(e){const t=(0,O.isObject)(e)?(0,H.AW)(e):e;yield ye(t);try{yield V({url:t,method:"DELETE"})}catch(e){return yield ge(t,e),e}return yield fe(t),null}const Ie="RECEIVE_QUERY",Se="START_QUERY",_e="FINISH_QUERY",he="FAILED_QUERY",Te="START_CREATE_BAN",qe="FINISH_CREATE_BAN",Ae="FAILED_CREATE_BAN",ve="RECEIVE_BAN",Re="START_UPDATE_BAN",be="FINISH_UPDATE_BAN",Pe="FAILED_UPDATE_BAN",Ne="START_DELETE_BAN",Qe="FINISH_DELETE_BAN",xe="FAILED_DELETE_BAN";var Ue=r(28306);const Le=(0,F.createRegistrySelector)((e=>()=>e("ithemes-security/bans").getQueryResults("main"))),Ce=(0,Ue.Z)(((e,t)=>{const r=(0,O.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function De(e,t,r){return(0,O.find)((0,O.get)(e,["queries",t,"links"],[]),{rel:r})}function Fe(e,t,r){return(0,O.filter)((0,O.get)(e,["queries",t,"links"],[]),{rel:r})}function Oe(e,t,r){return(0,O.get)(e,["queries",t,"headers",r])}function ke(e,t){return(0,O.get)(e,["queryParams",t])}function we(e,t){return e.bySelf[t]}function He(e,t){const r=(0,O.isObject)(t)?(0,H.AW)(t):t;return e.updating.includes(r)}function Ve(e,t){const r=(0,O.isObject)(t)?(0,H.AW)(t):t;return e.deleting.includes(r)}function Be(e,t){return e.querying.includes(t)}function*Me(){yield G("ithemes-security/bans","query","main",{per_page:100})}var Ge=r(38085);const Ye={bySelf:{},queries:{},queryParams:{},querying:[],creating:[],updating:[],deleting:[]},We="ithemes-security/bans";function*$e(e){const t=`https://ithemes.com/wp-json/ithemes/v1/inline-help/itsec/${encodeURIComponent(e)}`,r=yield Y(t,{credentials:"omit",referrer:"no-referrer"});if(!r.ok)return;if(r.status>=400)return;const s=yield W(r);yield{type:je,topic:e,help:s}}function*Ze(e=!0){yield Z("global",{enable_remote_help:e})}(0,F.register)((0,F.createReduxStore)(We,{controls:X,actions:s,selectors:n,resolvers:i,reducer:function(e=Ye,t){switch(t.type){case Ie:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,O.map)(t.items,H.AW):[...(0,O.get)(e,["queries",t.queryId,"selves"],[]),...(0,O.map)(t.items,H.AW)],headers:(0,O.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ge.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,O.fromPairs)(t.items.filter((r=>{const s=(0,H.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,H.AW)(e),{context:t.context,item:e}])))}};case Se:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case _e:case he:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case ve:return{...e,bySelf:{...e.bySelf,[(0,H.AW)(t.ban)]:{context:"edit",item:t.ban}}};case Te:return{...e,creating:[...e.creating,t.ban]};case qe:case Ae:return{...e,creating:e.creating.filter((e=>e!==t.ban))};case Re:return{...e,updating:[...e.updating,t.self]};case be:case Pe:return{...e,updating:e.updating.filter((e=>e!==t.self))};case Ne:return{...e,deleting:[...e.deleting,t.self],bySelf:(0,O.omit)(e.bySelf,[t.self])};case Qe:case xe:return{...e,deleting:e.deleting.filter((e=>e!==t.self))};default:return e}}}));const je="RECEIVE_HELP",Ke=[];function Je(e,t){return e.byTopic[t]||Ke}const Xe=(0,F.createRegistrySelector)((e=>()=>e("ithemes-security/modules").getSettings("global")?.enable_remote_help));function*ze(e){yield $e(e)}const et={byTopic:{}},tt="ithemes-security/help",rt=(0,F.createReduxStore)(tt,{controls:X,actions:u,selectors:o,resolvers:l,reducer:function(e=et,t){return t.type===je?{...e,byTopic:{...e.byTopic,[t.topic]:t.help}}:e}});(0,F.register)(rt);var st=r(86076),nt=r(66e3),it=r(95122);const ut="ithemes-security/modules";function*ot(e,t){const r=yield F.controls.select(ut,"getModule",e);r?yield{type:bt,module:e,edit:(0,st.Z)(r,t)}:yield{type:bt,module:e,edit:t}}function*lt(e=!0){if(!0===e?e=yield F.controls.select(ut,"getDirtyModules"):(0,O.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const r of e){const e=yield F.controls.select(ut,"getModuleEdits",r);t.push({method:"PUT",path:`/ithemes-security/v1/modules/${r}`,body:e})}let r;try{yield{type:Nt,modules:e},r=yield K(t)}catch(t){return yield{type:Qt,modules:e},yield j("error",t.message),t}const s=[],n={};for(let i=0;i<t.length;i++){const t=e[i],u=r[i];u.status>=400?n[t]=u.body:(s.push(t),yield qt(u.body))}return(0,O.isEmpty)(n)||(yield{type:Qt,errors:n}),s.length&&(yield{type:xt,modules:s}),r}function*ct(e=!0){!0===e?e=yield F.controls.select(ut,"getDirtyModules"):(0,O.isString)(e)&&(e=[e]),yield{type:Pt,modules:e}}function*at(e){try{const t=yield _t(e,"active");yield qt(t),yield{type:xt,modules:[e]},t.side_effects&&(yield ht())}catch(t){yield{type:Qt,errors:{[e]:t}}}}function*dt(e){try{const t=yield _t(e,"inactive");yield qt(t),yield{type:xt,modules:[e]},t.side_effects&&(yield ht())}catch(t){yield{type:Qt,errors:{[e]:t}}}}function*yt(e){const t={requests:(0,O.map)(e,((e,t)=>({path:`/ithemes-security/v1/modules/${t}`,method:"PUT",body:{status:{selected:e}}})))},r=yield K(t);for(let e=0;e<r.length;e++){const t=r[e];t.status>=400?yield j("error",t.body.message):yield qt(t.body)}}function*gt(e,t){const r=yield F.controls.select(ut,"getSettings",e);if(!r)return void(yield{type:Lt,module:e,edit:t});const s={};let n=!1;for(const e in t)t.hasOwnProperty(e)&&((0,O.isEqual)(t[e],r[e])||(s[e]=t[e],n=!0));n?yield{type:Lt,module:e,edit:s}:yield Et(e)}function*ft(e,t,r){const s=yield F.controls.select(ut,"getSetting",e,t);(0,O.isEqual)(s,r)?yield{type:Dt,module:e,setting:t}:yield{type:Ct,module:e,setting:t,value:r}}function*Et(e=!0){!0===e?e=yield F.controls.select(ut,"getDirtySettings"):(0,O.isString)(e)&&(e=[e]),yield{type:Ft,modules:e}}function*pt(e=!0,t=!1){if(!0===e?e=yield F.controls.select(ut,"getDirtySettings"):(0,O.isString)(e)&&(e=[e]),!e.length)return[];const r=[],s=[],n={};for(const i of e){if(t){const e=yield F.controls.dispatch(ut,"validateSettings",i);if(!0!==e){const t=new H.PN("local_validation_failed");e.errorText.forEach((e=>t.add("local_validation_failed",e))),n[i]=t;continue}}const e=yield F.controls.select(ut,"getSettingEdits",i);s.push(i),r.push({method:"PATCH",path:`/ithemes-security/v1/settings/${i}`,body:e})}let i;try{yield{type:Ot,modules:e},i=yield K(r)}catch(t){return yield{type:kt,modules:e},yield j("error",t.message),t}const u=[];for(let e=0;e<r.length;e++){const t=s[e],r=i[e];r.status>=400?n[t]=r.body:(u.push(t),yield At(t,r.body))}return(0,O.isEmpty)(n)||(yield{type:kt,errors:n}),u.length&&(yield j("success",(0,it.__)("Saved settings.","better-wp-security"),{type:"snackbar"}),yield{type:wt,modules:u}),i}function*mt(e,t){let r;yield{type:Ot,modules:[e]};try{r=yield V({path:`/ithemes-security/v1/settings/${e}`,method:"PATCH",data:t}),yield At(e,r)}catch(t){return yield{type:kt,errors:{[e]:t}},t}return yield{type:wt,modules:[e]},r}const It=e=>async({select:t,resolveSelect:r})=>{const s=await r.getSettingsConditionalSchema(e);if(!s)return!0;const n=t.getEditedSettings(e),i=(0,H.g4)();return!!i.validate(s,n)||{errors:i.errors,errorText:St(i.errors,e,s)}};function St(e,t,r){const s=[];for(const{message:n,schemaPath:i,dataPath:u}of e){let e=nt.IB.create(i),o=e.parent(r);for(;o&&!o.title;)e=nt.IB.create(e.path.slice(0,e.path.length-1)),o=e.parent(r);o?.title?s.push(`${o.title} ${n}.`):s.push(`${t}${u} ${n}.`)}return s}function _t(e,t){return V({method:"PUT",path:`/ithemes-security/v1/modules/${e}`,data:{status:{selected:t}}})}function*ht(){const e=yield V({path:"/ithemes-security/v1/modules?context=edit&_embed=1"});yield Tt(e)}function Tt(e){return{type:vt,modules:e}}function qt(e){return{type:Rt,module:e}}function At(e,t){return{type:Ut,module:e,settings:t}}const vt="RECEIVE_MODULES",Rt="RECEIVE_MODULE",bt="EDIT_MODULE",Pt="RESET_MODULE_EDITS",Nt="START_SAVING_MODULES",Qt="FAILED_SAVING_MODULES",xt="FINISH_SAVING_MODULES",Ut="RECEIVE_SETTINGS",Lt="EDIT_SETTINGS",Ct="EDIT_SETTING",Dt="RESET_SETTING_EDIT",Ft="RESET_SETTING_EDITS",Ot="START_SAVING_SETTINGS",kt="FAILED_SAVING_SETTINGS",wt="FINISH_SAVING_SETTINGS";var Ht=r(59588),Vt=r.n(Ht);const Bt="ithemes-security/core";function Mt(e){return e.modules}const Gt=(0,Ue.Z)((e=>e.modules.map((t=>({...t,...e.moduleEdits[t.id]||{}})))),(e=>[e.modules,e.moduleEdits])),Yt=(0,Ue.Z)(((e,t)=>{const r=$t(e,t);return r?{...r,...e.moduleEdits[t]||{}}:null}),((e,t)=>[e.modules,e.moduleEdits[t]])),Wt=(0,Ue.Z)((e=>e.modules.filter((e=>"active"===e.status.selected)).map((e=>e.id))),(e=>e.modules));function $t(e,t){return e.modules.find((e=>e.id===t))}function Zt(e,t){return"active"===$t(e,t)?.status.selected}function jt(e,t){return e.moduleEdits[t]}function Kt(e,t){return e.savingModules.includes(t)}function Jt(e){return Object.keys(e.moduleEdits)}function Xt(e,t){return!!e.moduleEdits[t]}function zt(e,t){var r;return null!==(r=e.settings[t])&&void 0!==r?r:{}}function er(e,t,r){return e.settings[t]?.[r]}function tr(e,t){return e.settingEdits[t]}const rr=(0,Ue.Z)(((e,t)=>({...e.settings[t]||{},...e.settingEdits[t]||{}})),((e,t)=>[e.settings[t],e.settingEdits[t]]));function sr(e,t,r){return e.settingEdits[t]?.[r]||e.settings[t]?.[r]}function nr(e,t){return Array.isArray(t)?e.savingSettings.some((e=>t.includes(e))):e.savingSettings.includes(t)}function ir(e){return Object.keys(e.settingEdits)}function ur(e,t){return e.settingEdits[t]&&!(0,O.isEmpty)(e.settingEdits[t])}function or(e,t){return e.errors[t]}function lr(e){return e.settings}const cr=(0,Ue.Z)((e=>(0,O.reduce)(e.settings,((t,r,s)=>(t[s]={...r,...e.settingEdits[s]||{}},t)),{})),(e=>[e.settings,e.settingEdits]));function ar(e,t,r){return $t(e,t)?.settings?.schema.properties[r]}const dr=Vt()(((e,t,r,s,n,i,u,o)=>{const l={select:t,serverType:r,installType:s,featureFlags:n,activeModules:i,settings:u,userGroupsBySetting:o},c=t=>((e,t,r)=>{const{serverType:s,installType:n,activeModules:i,settings:u,featureFlags:o,userGroupsBySetting:l}=r;if(e["server-type"]&&!e["server-type"].includes(s))return!1;if(e["install-type"]&&e["install-type"]!==n)return!1;if(e["active-modules"])for(const t of e["active-modules"])if(!i.includes(t))return!1;if(e["user-groups"])for(const r of e["user-groups"])if(!l[t.id]?.[r]?.length)return!1;if(e["feature-flags"])for(const t of e["feature-flags"])if(!o?.includes(t))return!1;return!(e.settings&&!(0,H.g4)().compile(e.settings)(u))})(t,e,l),a=(t,r)=>r.properties?{...r,properties:Object.entries(r.properties).reduce(((r,[s,n])=>{const i=`${t}.${s}`;return e.settings.conditional[i]&&!c(e.settings.conditional[i])||(r[s]=a(i,n)),r}),{})}:r,d=Object.entries(e.settings.schema.properties).reduce(((t,[r,s])=>e.settings.interactive.includes(r)?(e.settings.conditional[r]&&!c(e.settings.conditional[r])||(t[r]=a(r,s)),t):t),{}),{id:y,...g}=e.settings.schema;return{...g,properties:d}})),yr=(0,F.createRegistrySelector)((e=>(t,r)=>{const s=Yt(t,r);return s?.settings?dr(s,e,e(Bt).getServerType(),e(Bt).getInstallType(),e(Bt).getFeatureFlags(),Wt(t),rr(t,r),e("ithemes-security/user-groups-editor").getEditedGroupsBySetting()):null})),gr={modules:[],moduleEdits:{},savingModules:[],settings:{},settingEdits:{},savingSettings:[],errors:{}};function*fr(){yield ht()}const Er={*fulfill(e){const t=yield V({path:`/ithemes-security/v1/settings/${e}`});yield At(e,t)},isFulfilled:(e,t)=>e.settings.hasOwnProperty(t)},pr={*fulfill(){yield F.controls.resolveSelect(ut,"getModules")},isFulfilled:e=>!(0,O.isEmpty)(e.settings)};function*mr(){yield F.controls.resolveSelect(ut,"__unstableGetAllSettings")}function*Ir(){yield F.controls.resolveSelect(ut,"getModules")}const Sr={*fulfill(){yield F.controls.resolveSelect(ut,"getModules")},isFulfilled:(e,t)=>e.modules.includes((e=>e.id===t))};function*_r(){yield F.controls.resolveSelect(ut,"getModules")}function*hr(){yield F.controls.resolveSelect(ut,"getModules")}function*Tr(e){yield F.controls.resolveSelect(ut,"getSettings",e)}function*qr(e){yield F.controls.resolveSelect(ut,"getSettings",e)}function*Ar(e){yield F.controls.resolveSelect(ut,"getSettings",e)}const vr=(0,F.createReduxStore)(ut,{controls:X,actions:c,selectors:a,resolvers:d,reducer:function(e=gr,t){switch(t.type){case vt:return{...e,modules:[...t.modules],settings:{...e.settings,...t.modules.reduce(((e,t)=>{const r=(0,O.get)(t,["_embedded","ithemes-security:settings",0]);return r?{...e,[t.id]:r}:e}),{})}};case Rt:return{...e,modules:e.modules.map((e=>e.id===t.module.id?t.module:e)),settings:{...e.settings,[t.module.id]:(0,O.get)(t.module,["_embedded","ithemes-security:settings",0],e.settings[t.module.id])}};case bt:return{...e,moduleEdits:{...e.moduleEdits,[t.module]:t.edit}};case Pt:return{...e,moduleEdits:(0,O.omit)(e.moduleEdits,t.modules)};case Nt:return{...e,savingModules:[...e.savingModules,...t.modules]};case xt:return{...e,savingModules:e.savingModules.filter((e=>!t.modules.includes(e))),moduleEdits:(0,O.omit)(e.moduleEdits,t.modules),errors:(0,O.omit)(e.errors,t.modules)};case Qt:return{...e,savingModules:(0,O.without)(e.savingModules,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};case Ut:return{...e,settings:{...e.settings,[t.module]:t.settings}};case Lt:return{...e,settingEdits:{...e.settingEdits,[t.module]:t.edit}};case Ct:return{...e,settingEdits:{...e.settingEdits,[t.module]:{...e.settingEdits[t.module]||{},[t.setting]:t.value}}};case Dt:return{...e,settingEdits:{...e.settingEdits,[t.module]:(0,O.omit)(e.settingEdits[t.module]||{},t.setting)}};case Ft:return{...e,settingEdits:(0,O.omit)(e.settingEdits,t.modules)};case Ot:return{...e,savingSettings:[...e.savingSettings,...t.modules]};case wt:return{...e,savingSettings:e.savingSettings.filter((e=>!t.modules.includes(e))),settingEdits:(0,O.omit)(e.settingEdits,t.modules),errors:(0,O.omit)(e.errors,t.modules)};case kt:return{...e,savingSettings:(0,O.without)(e.savingSettings,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};default:return e}},persist:["moduleEdits","settingEdits"]});(0,F.register)(vr);const Rr=vr;function*br(){const e=yield V({path:"/ithemes-security/v1/tools"});yield{type:Qr,tools:e}}function*Pr(e,t={}){let r;yield{type:xr,tool:e,form:t};try{r=yield V({path:`/ithemes-security/v1/tools/${e}`,method:"POST",data:t,parse:!1})}catch(t){const r=yield $(H.x4.fromResponse(t.getResponse()));return yield{type:Ur,tool:e,result:r},r}const s=yield $(H.x4.fromResponse(r));return yield{type:Ur,tool:e,result:s},s}function*Nr(e,t=!0){let r;yield{type:Lr,tool:e,enabled:t};try{r=yield V({path:`/ithemes-security/v1/tools/${e}`,method:"PUT",data:{enabled:t}})}catch(t){return yield{type:Cr,tool:e,error:t},t}return yield{type:Dr,tool:e,data:r},r}const Qr="RECEIVE_TOOLS",xr="START_TOOL",Ur="FINISH_TOOL",Lr="START_TOGGLE_TOOL",Cr="FAILED_TOGGLE_TOOL",Dr="FINISH_TOGGLE_TOOL",Fr="ithemes-security/tools",Or=Vt()(((e,t)=>e.map((e=>t[e.slug]||e))),{maxSize:1}),kr=(0,F.createRegistrySelector)((e=>t=>Or(e(Fr).getToolsConfig(),t.bySlug))),wr=(0,Ue.Z)((e=>e.slugs.map((t=>e.bySlug[t]))),(e=>[e.bySlug,e.slugs])),Hr=Vt()((e=>e.reduce(((e,t)=>{for(const[r,s]of Object.entries(t.tools))e.push({slug:r,module:t.id,toggleable:!1,schedule:"",form:null,...s});return e}),[])),{maxSize:1}),Vr=(0,F.createRegistrySelector)((e=>()=>Hr(e(ut).getModules()))),Br=(0,F.createRegistrySelector)((e=>(t,r)=>t.bySlug[r]||e(Fr).getToolsConfig().find((e=>r===e.slug))));function Mr(e){return e.running}function Gr(e,t){return e.running.includes(t)}function Yr(e,t){return e.lastResult[t]}function Wr(e,t){return e.updating.includes(t)}function $r(e,t){return e.lastError[t]}const Zr={bySlug:{},slugs:[],running:[],lastResult:{},updating:[],lastError:{}};function*jr(){yield br()}function*Kr(){yield F.controls.resolveSelect(Fr,"getTools")}const Jr={*fulfill(){yield F.controls.resolveSelect(Fr,"getTools")},isFulfilled:(e,t)=>!!e.bySlug[t]},Xr=(0,F.createReduxStore)(Fr,{controls:X,actions:y,selectors:g,resolvers:f,reducer:function(e=Zr,t){switch(t.type){case Qr:return{...e,bySlug:(0,O.keyBy)(t.tools,"slug"),slugs:(0,O.map)(t.tools,"slug")};case xr:return{...e,running:[...e.running,t.tool]};case Ur:return{...e,running:(0,O.without)(e.running,t.tool),lastResult:{...e.lastResult,[t.tool]:t.result}};case Lr:return{...e,updating:[...e.updating,t.tool]};case Cr:return{...e,updating:(0,O.without)(e.updating,t.tool),lastError:{...e.lastError,[t.tool]:t.error}};case Dr:return{...e,updating:(0,O.without)(e.updating,t.tool),lastError:(0,O.omit)(e.lastError,t.tool),bySlug:{...e.bySlug,[t.tool]:t.data}};default:return e}}});(0,F.register)(Xr);const zr=Xr,es="ithemes-security/vulnerabilities",ts="/ithemes-security/v1/site-scanner/vulnerabilities";function*rs(e,t={}){let r,s;yield{type:fs,queryId:e,queryParams:t};try{r=yield V({path:(0,z.addQueryArgs)(ts,t),parse:!1}),s=yield W(r)}catch(r){return yield{type:ps,queryId:e,queryParams:t,error:r},r}return yield ds(e,t.context||"view",r,s,"replace"),yield{type:Es,queryId:e,queryParams:t,response:r},s}function*ss(e){const t=yield M(es,"getQueryParams",e);yield*rs(e,t)}function*ns(e,t="append"){return yield*us(e,"prev",t)}function*is(e,t="append"){return yield*us(e,"next",t)}function*us(e,t,r){const s=yield M(es,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:fs,queryId:e};try{n=yield V({url:s.link,parse:!1}),i=yield W(n)}catch(t){return yield{type:ps,queryId:e,error:t},t}const u=(0,z.getQueryArg)(s.link,"context")||"view";return yield ds(e,u,n,i,r),yield{type:Es,queryId:e,response:n},n}function*os(e){return yield*as(e,"ithemes-security:mute-vulnerability")}function*ls(e){return yield*as(e,"ithemes-security:fix-vulnerability")}function*cs(e){return yield*as(e,"ithemes-security:deactivate-vulnerable-software")}function*as(e,t){const r="string"==typeof e?yield F.controls.select(es,"getVulnerability",e):e,s=(0,H.Rg)(r,t);if(!s)return;const n=(0,H.AW)(r);yield{type:ms,rel:t,self:n};try{const e=yield V({url:s,method:"POST"});return yield{type:Is,rel:t,self:n},yield ys(e),e}catch(e){return yield{type:Ss,rel:t,self:n,error:e},e}}function ds(e,t,r,s,n){return{type:gs,queryId:e,context:t,response:r,items:s,mode:n}}function ys(e){return{type:_s,vulnerability:e}}const gs="RECEIVE_QUERY",fs="START_QUERY",Es="FINISH_QUERY",ps="FAILED_QUERY",ms="START_ACTION",Is="FINISH_ACTION",Ss="FAILED_ACTION",_s="RECEIVE_VULNERABILITY",hs=(0,F.createRegistrySelector)((e=>()=>e(es).getQueryResults("main"))),Ts=(0,Ue.Z)(((e,t)=>{const r=(0,O.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function qs(e,t,r){return(0,O.find)((0,O.get)(e,["queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function As(e,t,r){return(0,O.filter)((0,O.get)(e,["queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function vs(e,t){return!!qs(e,t,"prev")}function Rs(e,t){return!!qs(e,t,"next")}function bs(e,t,r){return(0,O.get)(e,["queries",t,"headers",r])}function Ps(e,t){return(0,O.get)(e,["queryParams",t])}function Ns(e,t){return e.bySelf[t]?.item}function Qs(e,t){return Ns(e,e.selfById[t])}function xs(e,t){const r="string"==typeof t?Ns(e,t):t;return r?(0,O.reduce)(r._links,((e,t,r)=>t.reduce(((e,t)=>t.title?(e.push({rel:r,title:t.title,isDestructive:t.isDestructive||!1}),e):e),e)),[]):[]}function Us(e,t){return e.querying.includes(t)}function Ls(e,t){return Fs(e,t,"ithemes-security:mute-vulnerability")}function Cs(e,t){return Fs(e,t,"ithemes-security:fix-vulnerability")}function Ds(e,t){return Fs(e,t,"ithemes-security:deactivate-vulnerable-software")}function Fs(e,t,r){const s="string"==typeof t?t:(0,H.AW)(t);return e.actions.includes(`${r}:${s}`)}function*Os(){yield G(es,"query","main",{per_page:100,resolution:["unresolved","patched","deactivated"]})}function*ks(e){const t=yield V({path:`${ts}/${e}`});return yield ys(t),t}const ws={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],actions:[]},Hs=(0,F.createReduxStore)(es,{actions:E,selectors:p,resolvers:m,controls:X,reducer:function(e=ws,t){switch(t.type){case gs:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,O.map)(t.items,H.AW):[...(0,O.get)(e,["queries",t.queryId,"selves"],[]),...(0,O.map)(t.items,H.AW)],headers:(0,O.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ge.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,O.fromPairs)(t.items.filter((r=>{const s=(0,H.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,H.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,O.fromPairs)(t.items.map((e=>[e.id,(0,H.AW)(e)])))}};case fs:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case Es:case ps:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case _s:return{...e,bySelf:{...e.bySelf,[(0,H.AW)(t.vulnerability)]:{context:"edit",item:t.vulnerability}},selfById:{...e.selfById,[t.vulnerability.id]:(0,H.AW)(t.vulnerability)}};case ms:return{...e,actions:[...e.actions,`${t.rel}:${t.self}`]};case Is:case Ss:return{...e,actions:e.actions.filter((e=>e!==`${t.rel}:${t.self}`))};default:return e}}});(0,F.register)(Hs);const Vs=Hs,Bs="ithemes-security/site-scanner",Ms="/ithemes-security/v1/site-scanner/scans";function*Gs(e,t={}){let r,s;yield{type:zs,queryId:e,queryParams:t};try{r=yield V({path:(0,z.addQueryArgs)(Ms,t),parse:!1}),s=yield W(r)}catch(r){return yield{type:tn,queryId:e,queryParams:t,error:r},r}return yield Js(e,t.context||"view",r,s,"replace"),yield{type:en,queryId:e,queryParams:t,response:r},r}function*Ys(e){const t=yield M(Bs,"getQueryParams",e);yield*Gs(e,t)}function*Ws(e,t="append"){return yield*Zs(e,"prev",t)}function*$s(e,t="append"){return yield*Zs(e,"next",t)}function*Zs(e,t,r){const s=yield M(Bs,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:zs,queryId:e};try{n=yield V({url:s.link,parse:!1}),i=yield W(n)}catch(t){return yield{type:tn,queryId:e,error:t},t}const u=(0,z.getQueryArg)(s.link,"context")||"view";return yield Js(e,u,n,i,r),yield{type:en,queryId:e,response:n},n}function*js(e=0){yield{type:sn,siteId:e};try{const t=yield V({path:Ms,method:"POST",data:{site_id:e}});return yield Ks(t),yield{type:nn,siteId:e},t}catch(e){return yield{type:un,error:e},e}}function Ks(e){return{type:rn,scan:e}}function Js(e,t,r,s,n){return{type:Xs,queryId:e,context:t,response:r,items:s,mode:n}}const Xs="RECEIVE_QUERY",zs="START_QUERY",en="FINISH_QUERY",tn="FAILED_QUERY",rn="RECEIVE_SCAN",sn="START_SCAN",nn="FINISH_SCAN",un="FAILED_SCAN",on=(0,F.createRegistrySelector)((e=>()=>e(Bs).getQueryResults("main"))),ln=(0,Ue.Z)(((e,t)=>{const r=(0,O.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function cn(e,t,r){return(0,O.find)((0,O.get)(e,["queries",t,"links"],[]),{rel:r})}function an(e,t,r){return(0,O.filter)((0,O.get)(e,["queries",t,"links"],[]),{rel:r})}function dn(e,t,r){return(0,O.get)(e,["queries",t,"headers",r])}function yn(e,t){return(0,O.get)(e,["queryParams",t])}function gn(e,t){return e.bySelf[t]?.item}function fn(e,t){return e.querying.includes(t)}function En(e,t=0){return e.scanning===t}function*pn(){yield G(Bs,"query","main",{per_page:100})}const mn={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],scanning:null},In=(0,F.createReduxStore)(Bs,{actions:I,selectors:S,resolvers:_,controls:X,reducer:function(e=mn,t){switch(t.type){case Xs:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,O.map)(t.items,H.AW):[...(0,O.get)(e,["queries",t.queryId,"selves"],[]),...(0,O.map)(t.items,H.AW)],headers:(0,O.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ge.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,O.fromPairs)(t.items.filter((r=>{const s=(0,H.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,H.AW)(e),{context:t.context,item:e}])))}};case zs:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case en:case tn:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case rn:return{...e,bySelf:{...e.bySelf,[(0,H.AW)(t.scan)]:{context:"edit",item:t.scan}}};case sn:return{...e,scanning:t.siteId};case nn:case un:return{...e,scanning:null};default:return e}}});(0,F.register)(In);const Sn=In,_n="ithemes-security/patchstack",hn="https://itsec-site-scanner.ithemes.com";function*Tn(e,t={}){let r,s;yield{type:Pn,queryId:e,queryParams:t},t.per_page=t.per_page||100,t.page=t.page||1;try{if(r=yield Y((0,z.addQueryArgs)(hn+"/db",t),{credentials:"omit"}),!r.ok)throw yield W(r);s=yield W(r)}catch(r){return yield{type:Qn,queryId:e,queryParams:t,error:r},r}return yield bn(e,t.context||"view",r,s,"replace"),yield{type:Nn,queryId:e,queryParams:t,response:r},r}function*qn(e){const t=yield F.controls.select(_n,"getQueryParams",e);yield*Tn(e,t)}function*An(e,t="append"){return yield*Rn(e,"prev",t)}function*vn(e,t="append"){return yield*Rn(e,"next",t)}function*Rn(e,t,r){const s=yield F.controls.select(_n,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:Pn,queryId:e};try{n=yield Y(hn+s.link,{credentials:"omit"}),i=yield W(n)}catch(t){return yield{type:Qn,queryId:e,error:t},t}const u=(0,z.getQueryArg)(s.link,"context")||"view";return yield bn(e,u,n,i,r),yield{type:Nn,queryId:e,response:n},n}function bn(e,t,r,s,n){return{type:xn,queryId:e,context:t,response:r,items:s,mode:n}}const Pn="START_QUERY",Nn="FINISH_QUERY",Qn="FAILED_QUERY",xn="RECEIVE_QUERY",Un=(0,F.createRegistrySelector)((e=>()=>e(_n).getQueryResults("main")));function Ln(e,t){return e.byId[t]}const Cn=(0,Ue.Z)(((e,t)=>{const r=(0,O.get)(e,["queries",t,"ids"],[]),s=e.byId,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.byId]));function Dn(e,t,r){return(0,O.find)((0,O.get)(e,["queries",t,"links"],[]),{rel:[r]})}function Fn(e,t,r){return(0,O.filter)((0,O.get)(e,["queries",t,"links"],[]),{rel:[r]})}function On(e,t,r){return(0,O.get)(e,["queries",t,"headers",r])}function kn(e,t){return(0,O.get)(e,["queryParams",t])}function wn(e,t){return Dn(e,t,"next")}function Hn(e,t){return!!Dn(e,t,"prev")}function Vn(e,t){return(0,O.get)(e,["errors",t])}function Bn(e,t){return e.querying.includes(t)}function*Mn(){yield G(_n,"query","main",{per_page:100})}const Gn={byId:{},queries:{},queryParams:{},querying:[],actions:[]},Yn=(0,F.createReduxStore)(_n,{controls:X,actions:h,selectors:T,resolvers:q,reducer:function(e=Gn,t){switch(t.type){case xn:return{...e,queries:{...e.queries,[t.queryId]:{ids:"replace"===t.mode?(0,O.map)(t.items,"id"):[...(0,O.get)(e,["queries",t.queryId,"ids"],[]),...(0,O.map)(t.items,"id")],headers:(0,O.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ge.parse)(t.response.headers.get("link"),{extended:!0})}},byId:{...e.byId,...(0,O.fromPairs)(t.items.filter((r=>{const s=r.id;return!e.byId[s]||"embed"===e.byId[s].context||e.byId[s].context===t.context})).map((e=>[e.id,{context:t.context,item:e}])))}};case Pn:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]},errors:(0,O.omit)(e.errors,[t.queryId])};case Nn:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Qn:return{...e,querying:e.querying.filter((e=>e!==t.queryId)),errors:{...e.errors,[t.queryId]:t.error}};default:return e}}});(0,F.register)(Yn);const Wn=Yn;var $n=r(25703);const Zn="ithemes-security/users",jn="/wp/v2/users",Kn="/ithemes-security/v1/user-actions";function*Jn(e,t={}){let r,s;yield{type:Ei,queryId:e,queryParams:t};try{r=yield V({path:(0,z.addQueryArgs)(jn,t),parse:!1}),s=yield W(r)}catch(r){return yield{type:mi,queryId:e,queryParams:t,error:r},r}return yield ri(e,t.context||"view",r,s,"replace"),yield{type:pi,queryId:e,queryParams:t,response:r},r}function*Xn(e){const t=yield M(Zn,"getQueryParams",e);yield*Jn(e,t)}function*zn(e,t="append"){return yield*ti(e,"prev",t)}function*ei(e,t="append"){return yield*ti(e,"next",t)}function*ti(e,t,r){const s=yield M(Zn,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:Ei,queryId:e};try{n=yield V({url:s.link,parse:!1}),i=yield W(n)}catch(t){return yield{type:mi,queryId:e,error:t},t}const u=(0,z.getQueryArg)(s.link,"context")||"view";return yield ri(e,u,n,i,r),yield{type:pi,queryId:e,response:n},n}function ri(e,t,r,s,n){return{type:fi,queryId:e,context:t,response:r,items:s,mode:n}}function si(e){return{type:hi,user:e}}function*ni(e,t,r){const s=yield M(Zn,"getQueryParams",e),n=e;yield{type:Ii,id:n};try{const e=yield V({path:Kn,method:"POST",data:{query:s,mode:t,actions:r}});return yield{type:Si,id:n},yield{type:Ri},yield{type:Pi},yield ui(),e}catch(e){return yield{type:_i,id:n,error:e},e}}function*ii(e,t,r){yield{type:Ii,id:r};try{const s=yield V({path:Kn,method:"POST",data:{users:e,actions:t}});return yield{type:Si,id:r},yield{type:Ri},yield{type:Pi},yield ui(),s}catch(e){return yield{type:_i,id:r,error:e},e}}function ui(){return F.controls.dispatch($n.store,"createNotice","info",(0,it.__)("Quick edits are being applied in the background. This may take a few moments.","better-wp-security"),{id:"user_security_quick_edits_success",type:"snackbar",context:"ithemes-security"})}function*oi(e){switch(e){case"all":yield F.controls.dispatch($n.store,"createNotice","info",(0,it.__)("All users from the query are selected","better-wp-security"),{id:"user_security_all_selected",type:"snackbar",context:"ithemes-security"});break;case"window":yield F.controls.dispatch($n.store,"createNotice","info",(0,it.__)("Only the current page of users from the query are selected","better-wp-security"),{id:"user_security_page_selected",type:"snackbar",context:"ithemes-security"});break;case"none":yield F.controls.dispatch($n.store,"createNotice","info",(0,it.__)("None of the users from the query are selected","better-wp-security"),{id:"user_security_none_selected",type:"snackbar",context:"ithemes-security"}),yield{type:Pi}}yield{type:Ti,userSelectionType:e}}function li(){return{type:Ai}}function ci(e){return{type:qi,user:e}}function ai(){return{type:Pi}}function di(){return{type:vi}}function yi(){return{type:Ri}}function gi(){return{type:bi}}const fi="RECEIVE_QUERY",Ei="START_QUERY",pi="FINISH_QUERY",mi="FAILED_QUERY",Ii="START_ACTION",Si="FINISH_ACTION",_i="FAILED_ACTION",hi="RECEIVE_USER",Ti="UPDATE_SELECTION_TYPE",qi="TOGGLE_SELECTED_USER",Ai="TOGGLE_SELECT_ALL",vi="OPEN_QUICK_EDIT",Ri="CLOSE_QUICK_EDIT",bi="CONFIRM_QUICK_EDIT",Pi="REMOVE_SELECTED_USERS",Ni=(0,F.createRegistrySelector)((e=>()=>e(Zn).getQueryResults("main"))),Qi=(0,Ue.Z)(((e,t)=>{const r=(0,O.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function xi(e,t,r){return(0,O.find)((0,O.get)(e,["queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function Ui(e,t,r){return(0,O.filter)((0,O.get)(e,["queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function Li(e,t){return!!xi(e,t,"prev")}function Ci(e,t){return!!xi(e,t,"next")}function Di(e,t,r){return(0,O.get)(e,["queries",t,"headers",r])}function Fi(e,t){return(0,O.get)(e,["queryParams",t])}function Oi(e,t){return e.bySelf[t]?.item}function ki(e,t){return Oi(e,e.selfById[t])}function wi(e){return e.userSelection}function Hi(e,t){return e.actions.includes(t)}function Vi(e,t){return e.actionErrors[t]}function Bi(e){return e.selectedUsers}function Mi(e){const t=Qi(e,"main");return e.selectedUsers.length===t.length?"checked":e.selectedUsers.length>0?"indeterminate":"unchecked"}function Gi(e,t){return e.querying.includes(t)}function Yi(e,t){return e.selectedUsers.includes(t)}function Wi(e){return e.quickEditState}function $i(e){return e.actions}function*Zi(){yield G(Zn,"query","main",{per_page:20,context:"edit",roles:["administrator"]})}function*ji(e){const t=yield V({path:`${jn}/${e}?context=edit`});return yield si(t),t}const Ki={bySelf:{},selfById:{},userSelection:"window",queries:{},queryParams:{},querying:[],actions:[],actionErrors:{},selectedUsers:[],quickEditState:!1},Ji=(0,F.createReduxStore)(Zn,{actions:A,selectors:v,resolvers:R,controls:X,reducer:function(e=Ki,t){switch(t.type){case fi:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,O.map)(t.items,H.AW):[...(0,O.get)(e,["queries",t.queryId,"selves"],[]),...(0,O.map)(t.items,H.AW)],headers:(0,O.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ge.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,O.fromPairs)(t.items.filter((r=>{const s=(0,H.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,H.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,O.fromPairs)(t.items.map((e=>[e.id,(0,H.AW)(e)])))},selectedUsers:"main"===t.queryId?[]:e.selectedUsers};case Ei:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case pi:case mi:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case hi:return{...e,bySelf:{...e.bySelf,[(0,H.AW)(t.user)]:{context:"edit",item:t.user}},selfById:{...e.selfById,[t.user.id]:(0,H.AW)(t.user)}};case Ti:return{...e,userSelection:t.userSelectionType};case Ai:const r=Qi(e,"main");return e.selectedUsers.length===r.length?{...e,selectedUsers:[]}:{...e,selectedUsers:r.map((e=>e.id))};case qi:return e.selectedUsers.includes(t.user.id)?{...e,selectedUsers:e.selectedUsers.filter((e=>e!==t.user.id)),userSelection:"all"}:{...e,selectedUsers:[...e.selectedUsers,t.user.id],userSelection:"window"};case Pi:return{...e,selectedUsers:[],userSelection:"none"};case vi:return{...e,quickEditState:!0};case Ri:return{...e,quickEditState:!1};case bi:return{...e,quickEditState:"confirm"};case Ii:return{...e,actions:[...e.actions,t.id],actionErrors:(0,O.omit)(e.actionErrors,t.id)};case Si:return{...e,actions:e.actions.filter((e=>e!==t.id))};case _i:return{...e,actions:e.actions.filter((e=>e!==t.id)),actionErrors:{...e.actionErrors,[t.id]:t.error}};default:return e}}});(0,F.register)(Ji);const Xi=Ji,zi="ithemes-security/firewall",eu="/ithemes-security/v1/firewall/rules",tu=(e,t={})=>async({dispatch:r})=>{let s,n;r({type:Eu,queryId:e,queryParams:t});try{s=await w()({path:(0,z.addQueryArgs)(eu,t),parse:!1}),n=await s.json()}catch(s){return r({type:mu,queryId:e,queryParams:t,error:s}),s}return r(yu(e,t.context||"view",s,n,"replace")),r({type:pu,queryId:e,queryParams:t,response:s}),n},ru=e=>async({select:t,dispatch:r})=>{const s=t.getQueryParams(e);r.query(e,s)},su=(e,t="append")=>(...r)=>iu(e,"prev",t)(...r),nu=(e,t="append")=>(...r)=>iu(e,"next",t)(...r),iu=(e,t,r)=>async({select:s,dispatch:n})=>{const i=s.getQueryHeaderLink(e,t);if(!i)return[];let u,o;n({type:Eu,queryId:e});try{u=await w()({url:i.link,parse:!1}),o=await u.json()}catch(t){return n({type:mu,queryId:e,error:t}),t}const l=(0,z.getQueryArg)(i.link,"context")||"view";return n(yu(e,l,u,o,r)),n({type:pu,queryId:e,response:u}),u},uu=(e,t)=>async({select:r,dispatch:s})=>{const n=r.getItem(e),i=r.getEditedItem(e);(0,O.isEqual)(n,{...i,...t})?s({type:"RESET_EDITS",self:e}):s({type:"EDIT_ITEM",self:e,edit:t})};function ou(e){return{type:"RESET_EDITS",self:e}}function lu(){return{type:"RESET_ALL_EDITS"}}const cu=e=>async({select:t,dispatch:r})=>{const s=t.getEditedItem(e);if(!s||!t.isDirty(e))return s;const n=await r.saveItem(s);return r(ou(e)),n},au=e=>async({dispatch:t})=>{const r=(0,H.AW)(e);r&&t({type:"START_SAVING",self:r});try{const s=await w()({url:r,path:!r&&eu,method:r?"PUT":"POST",data:e});return t({type:"RECEIVE_ITEM",item:s}),r&&t({type:"FINISH_SAVING",self:r}),s}catch(e){throw r&&t({type:"FAILED_SAVING",self:r,error:e}),e}},du=e=>async({dispatch:t})=>{t({type:"START_DELETING",self:e});try{await w()({url:e,method:"DELETE"}),t({type:"FINISH_DELETING",self:e})}catch(r){t({type:"FAILED_DELETING",self:e,error:r})}};function yu(e,t,r,s,n){return{type:gu,queryId:e,context:t,response:r,items:s,mode:n}}const gu="RECEIVE_QUERY",fu="RECEIVE_ITEM",Eu="START_QUERY",pu="FINISH_QUERY",mu="FAILED_QUERY",Iu=(0,F.createRegistrySelector)((e=>()=>e(zi).getQueryResults("main"))),Su=(0,Ue.Z)(((e,t)=>{const r=(0,O.get)(e,["query","queries",t,"selves"],[]),s=e.query.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.query.queries[t],e.query.bySelf]));function _u(e,t,r){return(0,O.find)((0,O.get)(e,["query","queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function hu(e,t,r){return(0,O.filter)((0,O.get)(e,["query","queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function Tu(e,t){return!!_u(e,t,"prev")}function qu(e,t){return!!_u(e,t,"next")}function Au(e,t,r){return(0,O.get)(e,["query","queries",t,"headers",r])}function vu(e,t){return(0,O.get)(e,["query","queryParams",t])}function Ru(e,t){return e.query.bySelf[t]?.item}function bu(e,t){return Ru(e,e.query.selfById[t])}function Pu(e,t){return e.query.querying.includes(t)}const Nu=(0,Ue.Z)(((e,t)=>e.query.bySelf[t]?.item&&{...e.query.bySelf[t].item,...e.edits.bySelf[t]||{}}),((e,t)=>[e.edits.bySelf[t],e.query.bySelf[t]]));function Qu(e,t){return void 0!==e.edits.bySelf[t]}function xu(e,t){const r="string"==typeof t?t:(0,H.AW)(t);return e.saving.selves.includes(r)}function Uu(e,t){const r="string"==typeof t?t:(0,H.AW)(t);return e.deleting.selves.includes(r)}function Lu(e,t){const r="string"==typeof t?t:(0,H.AW)(t);return e.saving.errors[r]}function Cu(e,t){const r="string"==typeof t?t:(0,H.AW)(t);return e.deleting.errors[r]}const Du=()=>async({dispatch:e})=>{await e.query("main",{per_page:100,paused:"false"})},Fu={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await w()({url:(0,z.addQueryArgs)(e,{context:"edit"})})})},isFulfilled:(e,t)=>"edit"===e.query.bySelf[t]?.context},Ou={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await w()({path:`${eu}/${e}?context=edit`})})},isFulfilled:(e,t)=>!!e.query.selfById[t]},ku={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},wu={bySelf:{}},Hu={selves:[],errors:{}},Vu=(0,F.combineReducers)({query:function(e=ku,t){switch(t.type){case gu:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,O.map)(t.items,H.AW):[...(0,O.get)(e,["queries",t.queryId,"selves"],[]),...(0,O.map)(t.items,H.AW)],headers:(0,O.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ge.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,O.fromPairs)(t.items.filter((r=>{const s=(0,H.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,H.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,O.fromPairs)(t.items.map((e=>[e.id,(0,H.AW)(e)])))}};case Eu:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case pu:case mu:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case fu:return{...e,bySelf:{...e.bySelf,[(0,H.AW)(t.item)]:{context:"edit",item:t.item}},selfById:{...e.selfById,[t.item.id]:(0,H.AW)(t.item)}};case"FINISH_DELETING":return{...e,bySelf:(0,O.omit)(e.bySelf,t.self),selfById:(0,O.omitBy)(e.selfById,(e=>e===t.self))};default:return e}},edits:function(e=wu,t){switch(t.type){case"EDIT_ITEM":return{...e,bySelf:{...e.bySelf,[t.self]:{...e.bySelf[t.self]||{},...t.edit}}};case"RESET_EDITS":case"FINISH_DELETING":return{...e,bySelf:(0,O.omit)(e.bySelf,t.self)};case"RESET_ALL_EDITS":return{...e,bySelf:{}};default:return e}},saving:function(e=Hu,t){switch(t.type){case"START_SAVING":return{...e,selves:[...e.selves,t.self],errors:(0,O.omit)(e.errors,t.self)};case"FINISH_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}},deleting:function(e=Hu,t){switch(t.type){case"START_DELETING":return{...e,selves:[...e.selves,t.self],errors:(0,O.omit)(e.errors,t.self)};case"FINISH_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}}}),Bu=(0,F.createReduxStore)(zi,{actions:b,selectors:P,resolvers:N,reducer:Vu,controls:X});(0,F.register)(Bu);const Mu=Bu,Gu="ithemes-security/logs",Yu="/ithemes-security/v1/logs";function*Wu(e,t={}){let r,s;yield{type:eo,queryId:e,queryParams:t};try{r=yield V({path:(0,z.addQueryArgs)(Yu,t),parse:!1}),s=yield W(r)}catch(r){return yield{type:ro,queryId:e,queryParams:t,error:r},r}return yield Ju(e,t.context||"view",r,s,"replace"),yield{type:to,queryId:e,queryParams:t,response:r},s}function*$u(e){const t=yield M(Gu,"getQueryParams",e);yield*Wu(e,t)}function*Zu(e,t="append"){return yield*Ku(e,"prev",t)}function*ju(e,t="append"){return yield*Ku(e,"next",t)}function*Ku(e,t,r){const s=yield M(Gu,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:eo,queryId:e};try{n=yield V({url:s.link,parse:!1}),i=yield W(n)}catch(t){return yield{type:ro,queryId:e,error:t},t}const u=(0,z.getQueryArg)(s.link,"context")||"view";return yield Ju(e,u,n,i,r),yield{type:to,queryId:e,response:n},n}function Ju(e,t,r,s,n){return{type:zu,queryId:e,context:t,response:r,items:s,mode:n}}function Xu(e){return{type:so,log:e}}const zu="RECEIVE_QUERY",eo="START_QUERY",to="FINISH_QUERY",ro="FAILED_QUERY",so="RECEIVE_LOG",no=(0,F.createRegistrySelector)((e=>()=>e(Gu).getQueryResults("main"))),io=(0,Ue.Z)(((e,t)=>{const r=(0,O.get)(e,["queries",t,"selves"],[]),s=e?.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e?.queries[t],e?.bySelf]));function uo(e,t,r){return(0,O.find)((0,O.get)(e,["queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function oo(e,t,r){return(0,O.filter)((0,O.get)(e,["queries",t,"links"],[]),{rel:(0,O.castArray)(r)})}function lo(e,t){return!!uo(e,t,"prev")}function co(e,t){return!!uo(e,t,"next")}function ao(e,t,r){return(0,O.get)(e,["queries",t,"headers",r])}function yo(e,t){return(0,O.get)(e,["queryParams",t])}function go(e,t){return e.querying.includes(t)}function fo(e,t){return e.bySelf[t]?.item}function Eo(e,t){return fo(e,e.selfById[t])}function*po(){yield G(Gu,"query","main",{per_page:100})}function*mo(e){const t=yield V({path:`${Yu}/${e}`});return yield Xu(e),t}const Io={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},So=(0,F.createReduxStore)(Gu,{actions:Q,selectors:x,resolvers:U,controls:X,reducer:function(e=Io,t){switch(t.type){case zu:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,O.map)(t.items,H.AW):[...(0,O.get)(e,["queries",t.queryId,"selves"],[]),...(0,O.map)(t.items,H.AW)],headers:(0,O.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ge.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,O.fromPairs)(t.items.filter((r=>{const s=(0,H.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,H.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,O.fromPairs)(t.items.map((e=>[e.id,(0,H.AW)(e)])))}};case eo:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case to:case ro:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case so:return{...e,bySelf:{...e.bySelf,[(0,H.AW)(t.log)]:{context:"edit",item:t.log}},selfById:{...e.selfById,[t.log.id]:(0,H.AW)(t.log)}};default:return e}}});(0,F.register)(So);const _o=So,ho=(0,Ue.Z)(((e,t)=>e.users.optimisticEdits[t]?(0,O.merge)((0,O.cloneDeep)(e.users.byId[t]),e.users.optimisticEdits[t]):e.users.byId[t]),((e,t)=>[e.users.byId[t],e.users.optimisticEdits[t]]));function To(e){return ho(e,qo(e))}function qo(e){return e.users.currentId}function Ao(e,t){return e.users.saving.includes(t)}function vo(e){return Ao(e,e.users.currentId)}function Ro(e){return e.index}function bo(e,t){const r=e.index;return r?(0,O.find)(r.routes,(e=>e?.schema?.title===t))?.schema:null}function Po(e){return e.index?.roles||null}function No(e){return e.index?.requirements_info||null}function Qo(e){return e.actors.types}function xo(e,t){return e.actors.byType[t]}function Uo(e){return e.siteInfo}const Lo=(0,F.createRegistrySelector)((e=>t=>e(ut).getSetting("feature-flags","enabled")||t.featureFlags));function Co(e){return e.batchMaxItems}function Do(e){return e.index?.server_type||null}function Fo(e){return e.index?.install_type||null}function Oo(e){return e.index?.has_patchstack||null}function ko(e){return e.index?.is_lw_customer||null}function*wo(e=!1){let t="/ithemes-security/v1?context=help";e&&(t+="&_="+Date.now());const r=yield V({path:t});return yield Ho(r),r}function Ho(e){return{type:Jo,index:e}}function*Vo(e,t=!1){yield*Bo("me",e,t)}function*Bo(e,t,r=!1){const s=yield M("ithemes-security/core","getCurrentUserId");"me"===e&&(e=s);const n=`/wp/v2/users/${e===s?"me":e}`;yield{type:"START_SAVING_USER",id:e,data:t,optimistic:r};try{const r=yield V({method:"PUT",path:n,data:t});yield Go(r),yield{type:"FINISH_SAVING_USER",id:e,user:r}}catch(t){yield{type:"FAILED_SAVING_USER",id:e,error:t}}}function*Mo(e){const t=yield M("ithemes-security/core","getCurrentUserId"),r=yield V({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Go(r)}function Go(e){return{type:Xo,user:e}}function Yo(e){return{type:zo,userId:e}}function Wo(e){return{type:el,types:e}}function $o(e,t){return{type:tl,actorType:e,actors:t}}function Zo(e){return{type:rl,siteInfo:e}}function jo(e){return{type:sl,flags:e}}function Ko(e){return{type:nl,maxItems:e}}const Jo="RECEIVE_INDEX",Xo="RECEIVE_USER",zo="RECEIVE_CURRENT_USER_ID",el="RECEIVE_ACTOR_TYPES",tl="RECEIVE_ACTORS",rl="RECEIVE_SITE_INFO",sl="LOAD_INITIAL_FEATURE_FLAGS",nl="RECEIVE_BATCH_MAX_ITEMS";function*il(){const e=yield V({path:"/ithemes-security/v1?context=help"});yield Ho(e)}const ul=()=>({resolveSelect:e})=>e.getIndex(),ol=()=>({resolveSelect:e})=>e.getIndex(),ll=()=>({resolveSelect:e})=>e.getIndex(),cl=()=>({resolveSelect:e})=>e.getIndex(),al=()=>({resolveSelect:e})=>e.getIndex(),dl=()=>({resolveSelect:e})=>e.getIndex(),yl=()=>({resolveSelect:e})=>e.getIndex(),gl={*fulfill(e){const t=yield F.controls.select("ithemes-security/core","getCurrentUserId"),r=yield V({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Go(r)},isFulfilled:(e,t)=>!!e.users.byId[t]},fl={*fulfill(){const e=yield V({path:"/wp/v2/users/me?context=edit"});yield Go(e),yield Yo(e.id)},isFulfilled:e=>e.users.currentId&&e.users.byId[e.users.currentId]},El={*fulfill(){const e=yield V({path:"/ithemes-security/v1/actors?_embed=1"}),t=[];for(const r of e){const e=(0,O.get)(r,["_embedded","wp:items",0],[]);yield $o(r.slug,e),t.push({slug:r.slug,label:r.label})}yield Wo(t)},isFulfilled:e=>e.actors.types.length>0},pl={*fulfill(){yield F.controls.select("ithemes-security/core","getActorTypes")},isFulfilled:(e,t)=>!!e.actors.byType[t]},ml={*fulfill(){const e=yield V({path:"/?_fields=name,description,url,home,multisite"});yield Zo(e)},isFulfilled:e=>!!e.siteInfo};function*Il(){const e=yield V({path:"/batch/v1",method:"OPTIONS"});yield Ko(e.endpoints[0].args.requests.maxItems)}const Sl={users:{currentId:0,byId:{},saving:[],optimisticEdits:{}},index:null,actors:{types:[],byType:{}},siteInfo:null,featureFlags:[],batchMaxItems:0};r.p=window.itsecWebpackPublicPath;const _l=(0,F.createReduxStore)(Bt,{controls:X,selectors:L,resolvers:D,actions:C,reducer:function(e=Sl,t){switch(t.type){case Jo:return{...e,index:t.index};case"START_SAVING_USER":return{...e,users:{...e.users,saving:[...e.users.saving,t.id],optimisticEdits:t.optimistic?{...e.users.optimisticEdits,[t.id]:t.data}:e.users.optimisticEdits}};case"FINISH_SAVING_USER":case"FAILED_SAVING_USER":return{...e,users:{...e.users,saving:e.users.saving.filter((e=>e!==t.id)),optimisticEdits:(0,O.omit)(e.users.optimisticEdits,t.id)}};case Xo:return{...e,users:{...e.users,byId:{...e.users.byId,[t.user.id]:t.user}}};case zo:return{...e,users:{...e.users,currentId:t.userId}};case el:return{...e,actors:{...e.actors,types:t.types}};case tl:return{...e,actors:{...e.actors,byType:{...e.actors.byType,[t.actorType]:t.actors}}};case rl:return{...e,siteInfo:t.siteInfo};case sl:return{...e,featureFlags:t.flags};case nl:return{...e,batchMaxItems:t.maxItems};default:return e}}});(0,F.register)(_l)},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},48015:e=>{e.exports=function(){return this.wp.data}()},6293:e=>{e.exports=function(){return this.wp.element}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},25703:e=>{e.exports=function(){return this.wp.notices}()},73470:e=>{e.exports=function(){return this.wp.url}()},92819:e=>{"use strict";e.exports=window.lodash}},e=>{e.O(0,[5307,761,1511],(()=>(20183,e(e.s=20183))));var t=e.O();((window.itsec=window.itsec||{}).packages=window.itsec.packages||{}).data=t}]);