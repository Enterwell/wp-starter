(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[7118],{19169:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BANS_STORE_NAME:()=>Ze,CORE_STORE_NAME:()=>Gt,HELP_STORE_NAME:()=>st,MODULES_STORE_NAME:()=>lt,apiFetch:()=>M,apiFetchBatch:()=>X,apiFetchResult:()=>G,awaitPromise:()=>j,controls:()=>ee,coreStore:()=>cc,createNotice:()=>J,dispatch:()=>W,fetch:()=>$,firewallStore:()=>Yu,logsStore:()=>qo,modulesStore:()=>Pr,parseFetchResponse:()=>Z,patchstackStore:()=>Zn,select:()=>Y,siteScannerStore:()=>hn,toolsStore:()=>ts,trustedDevicesStore:()=>cl,updateSettings:()=>K,userSecurityStore:()=>eu,vulnerabilitiesStore:()=>Ms});var s={};r.r(s),r.d(s,{FAILED_CREATE_BAN:()=>Re,FAILED_DELETE_BAN:()=>Ue,FAILED_QUERY:()=>Te,FAILED_UPDATE_BAN:()=>Qe,FINISH_CREATE_BAN:()=>ve,FINISH_DELETE_BAN:()=>Le,FINISH_QUERY:()=>qe,FINISH_UPDATE_BAN:()=>Ne,RECEIVE_BAN:()=>be,RECEIVE_QUERY:()=>_e,START_CREATE_BAN:()=>Ae,START_DELETE_BAN:()=>xe,START_QUERY:()=>he,START_UPDATE_BAN:()=>Pe,createBan:()=>me,deleteBan:()=>Se,failedCreateBan:()=>ce,failedDeleteBan:()=>Ee,failedUpdateBan:()=>de,fetchQueryNextPage:()=>ie,finishCreateBan:()=>ae,finishDeleteBan:()=>pe,finishUpdateBan:()=>fe,path:()=>re,query:()=>se,receiveBan:()=>oe,receiveQuery:()=>ue,refreshQuery:()=>ne,startCreateBan:()=>le,startDeleteBan:()=>ge,startUpdateBan:()=>ye,updateBan:()=>Ie});var n={};r.r(n),r.d(n,{getBan:()=>Ve,getBans:()=>De,getQueryHeader:()=>we,getQueryHeaderLink:()=>Oe,getQueryHeaderLinks:()=>ke,getQueryParams:()=>He,getQueryResults:()=>Fe,isDeleting:()=>Me,isQuerying:()=>Ge,isUpdating:()=>Be});var i={};r.r(i),r.d(i,{getBans:()=>Ye});var u={};r.r(u),r.d(u,{RECEIVE_HELP:()=>Je,enableHelp:()=>Ke,fetchHelp:()=>je});var o={};r.r(o),r.d(o,{getHelp:()=>ze,isEnabled:()=>et});var l={};r.r(l),r.d(l,{getHelp:()=>tt});var c={};r.r(c),r.d(c,{EDIT_MODULE:()=>Nt,EDIT_SETTING:()=>Ft,EDIT_SETTINGS:()=>Dt,FAILED_SAVING_MODULES:()=>Lt,FAILED_SAVING_SETTINGS:()=>Ht,FINISH_SAVING_MODULES:()=>Ut,FINISH_SAVING_SETTINGS:()=>Vt,RECEIVE_MODULE:()=>Pt,RECEIVE_MODULES:()=>bt,RECEIVE_SETTINGS:()=>Ct,RESET_MODULE_EDITS:()=>Qt,RESET_SETTING_EDIT:()=>Ot,RESET_SETTING_EDITS:()=>kt,START_SAVING_MODULES:()=>xt,START_SAVING_SETTINGS:()=>wt,activateModule:()=>dt,deactivateModule:()=>ft,editModule:()=>ct,editSetting:()=>pt,editSettings:()=>Et,fetchModules:()=>Tt,receiveModule:()=>vt,receiveModules:()=>At,receiveSettings:()=>Rt,resetModuleEdits:()=>yt,resetSettingEdits:()=>mt,saveModules:()=>at,saveSettings:()=>It,setModulesStatus:()=>gt,updateSettings:()=>St,validateSettings:()=>_t});var a={};r.r(a),r.d(a,{__unstableGetAllEditedSettings:()=>yr,__unstableGetAllSettings:()=>ar,areSettingsDirty:()=>lr,getActiveModules:()=>Zt,getDirtyModules:()=>zt,getDirtySettings:()=>or,getEditedModule:()=>$t,getEditedModules:()=>Wt,getEditedSetting:()=>ir,getEditedSettings:()=>nr,getError:()=>cr,getModule:()=>jt,getModuleEdits:()=>Jt,getModules:()=>Yt,getSetting:()=>rr,getSettingEdits:()=>sr,getSettingSchema:()=>dr,getSettings:()=>tr,getSettingsConditionalSchema:()=>gr,isActive:()=>Kt,isModuleDirty:()=>er,isSavingModule:()=>Xt,isSavingSettings:()=>ur});var y={};r.r(y),r.d(y,{__unstableGetAllEditedSettings:()=>Sr,__unstableGetAllSettings:()=>Ir,getActiveModules:()=>Tr,getEditedModule:()=>qr,getEditedModules:()=>_r,getEditedSetting:()=>Rr,getEditedSettings:()=>vr,getModule:()=>hr,getModules:()=>pr,getSetting:()=>Ar,getSettings:()=>mr});var d={};r.r(d),r.d(d,{FAILED_TOGGLE_TOOL:()=>Fr,FINISH_TOGGLE_TOOL:()=>Or,FINISH_TOOL:()=>Cr,RECEIVE_TOOLS:()=>Lr,START_TOGGLE_TOOL:()=>Dr,START_TOOL:()=>Ur,fetchTools:()=>Nr,runTool:()=>Qr,toggleTool:()=>xr});var f={};r.r(f),r.d(f,{getLastError:()=>jr,getLastResult:()=>$r,getResolvedTools:()=>Hr,getRunning:()=>Yr,getTool:()=>Gr,getTools:()=>Vr,getToolsConfig:()=>Mr,isRunning:()=>Wr,isUpdating:()=>Zr});var g={};r.r(g),r.d(g,{getResolvedTools:()=>Xr,getTool:()=>zr,getTools:()=>Jr});var E={};r.r(E),r.d(E,{FAILED_ACTION:()=>hs,FAILED_QUERY:()=>Is,FINISH_ACTION:()=>_s,FINISH_QUERY:()=>ms,RECEIVE_QUERY:()=>Es,RECEIVE_VULNERABILITY:()=>qs,START_ACTION:()=>Ss,START_QUERY:()=>ps,applyVulnerabilityAction:()=>ds,deactivateSoftware:()=>ys,fetchQueryNextPage:()=>os,fetchQueryPrevPage:()=>us,fixVulnerability:()=>as,muteVulnerability:()=>cs,query:()=>ns,receiveQuery:()=>fs,receiveVulnerability:()=>gs,refreshQuery:()=>is});var p={};r.r(p),r.d(p,{getQueryHeader:()=>Ns,getQueryHeaderLink:()=>vs,getQueryHeaderLinks:()=>Rs,getQueryParams:()=>Qs,getQueryResults:()=>As,getVulnerabilities:()=>Ts,getVulnerability:()=>xs,getVulnerabilityActions:()=>Us,getVulnerabilityById:()=>Ls,isApplyingAction:()=>ks,isDeactivatingSoftware:()=>Os,isFixing:()=>Fs,isMuting:()=>Ds,isQuerying:()=>Cs,queryHasNextPage:()=>Ps,queryHasPrevPage:()=>bs});var m={};r.r(m),r.d(m,{getVulnerabilities:()=>ws,getVulnerabilityById:()=>Hs});var I={};r.r(I),r.d(I,{FAILED_QUERY:()=>sn,FAILED_SCAN:()=>ln,FINISH_QUERY:()=>rn,FINISH_SCAN:()=>on,RECEIVE_QUERY:()=>en,RECEIVE_SCAN:()=>nn,START_QUERY:()=>tn,START_SCAN:()=>un,fetchQueryNextPage:()=>js,fetchQueryPrevPage:()=>Zs,query:()=>Ws,receiveQuery:()=>zs,receiveScan:()=>Xs,refreshQuery:()=>$s,runScan:()=>Js});var S={};r.r(S),r.d(S,{getQueryHeader:()=>fn,getQueryHeaderLink:()=>yn,getQueryHeaderLinks:()=>dn,getQueryParams:()=>gn,getQueryResults:()=>an,getScan:()=>En,getScans:()=>cn,isQuerying:()=>pn,isScanning:()=>mn});var _={};r.r(_),r.d(_,{getScans:()=>In});var h={};r.r(h),r.d(h,{FAILED_QUERY:()=>Ln,FINISH_QUERY:()=>xn,RECEIVE_QUERY:()=>Un,START_QUERY:()=>Qn,fetchQueryNextPage:()=>bn,fetchQueryPrevPage:()=>Rn,query:()=>An,receiveQuery:()=>Nn,refreshQuery:()=>vn});var q={};r.r(q),r.d(q,{getLastFetchError:()=>Mn,getPatchstackVulnerabilities:()=>Cn,getPatchstackVulnerability:()=>Dn,getQueryHeader:()=>wn,getQueryHeaderLink:()=>On,getQueryHeaderLinks:()=>kn,getQueryParams:()=>Hn,getQueryResults:()=>Fn,isQuerying:()=>Gn,queryHasNextPage:()=>Vn,queryHasPrevPage:()=>Bn});var T={};r.r(T),r.d(T,{getPatchstackVulnerabilities:()=>Yn});var A={};r.r(A),r.d(A,{CLOSE_QUICK_EDIT:()=>Pi,CONFIRM_QUICK_EDIT:()=>Ni,FAILED_ACTION:()=>qi,FAILED_QUERY:()=>Si,FINISH_ACTION:()=>hi,FINISH_QUERY:()=>Ii,OPEN_QUICK_EDIT:()=>bi,RECEIVE_QUERY:()=>pi,RECEIVE_USER:()=>Ti,REMOVE_SELECTED_USERS:()=>Qi,START_ACTION:()=>_i,START_QUERY:()=>mi,TOGGLE_SELECTED_USER:()=>vi,TOGGLE_SELECT_ALL:()=>Ri,UPDATE_SELECTION_TYPE:()=>Ai,applyQueryActionsToUsers:()=>oi,applyQuickActionsToQuery:()=>ui,closeQuickEdit:()=>gi,confirmQuickEdit:()=>Ei,fetchQueryNextPage:()=>ri,fetchQueryPrevPage:()=>ti,openQuickEdit:()=>fi,query:()=>zn,quickEditsSuccessSnackbar:()=>li,receiveQuery:()=>ni,receiveUser:()=>ii,refreshQuery:()=>ei,removeSelectedUsers:()=>di,toggleSelectAll:()=>ai,toggleSelectedUser:()=>yi,updateUserSelectionType:()=>ci});var v={};r.r(v),r.d(v,{getCurrentlySelectedUsers:()=>Gi,getQueryHeader:()=>Oi,getQueryHeaderLink:()=>Ui,getQueryHeaderLinks:()=>Ci,getQueryParams:()=>ki,getQueryResults:()=>Li,getQuickActionsError:()=>Mi,getQuickEditActions:()=>ji,getQuickEditState:()=>Zi,getSelectAllState:()=>Yi,getUser:()=>wi,getUserById:()=>Hi,getUserSelectionType:()=>Vi,getUsers:()=>xi,isApplyingQuickActions:()=>Bi,isQuerying:()=>Wi,isUserSelected:()=>$i,queryHasNextPage:()=>Fi,queryHasPrevPage:()=>Di});var R={};r.r(R),r.d(R,{getUserById:()=>Ji,getUsers:()=>Ki});var b={};r.r(b),r.d(b,{FAILED_QUERY:()=>Su,FINISH_QUERY:()=>Iu,RECEIVE_ITEM:()=>pu,RECEIVE_QUERY:()=>Eu,START_QUERY:()=>mu,deleteItem:()=>fu,editItem:()=>lu,fetchQueryNextPage:()=>uu,fetchQueryPrevPage:()=>iu,query:()=>su,refreshQuery:()=>nu,resetAllEdits:()=>au,resetEdits:()=>cu,saveEditedItem:()=>yu,saveItem:()=>du});var P={};r.r(P),r.d(P,{getEditedItem:()=>xu,getFirewallRules:()=>_u,getItem:()=>Pu,getItemById:()=>Nu,getLastDeleteError:()=>Fu,getLastSaveError:()=>Du,getQueryHeader:()=>Ru,getQueryHeaderLink:()=>qu,getQueryHeaderLinks:()=>Tu,getQueryParams:()=>bu,getQueryResults:()=>hu,isDeleting:()=>Cu,isDirty:()=>Lu,isQuerying:()=>Qu,isSaving:()=>Uu,queryHasNextPage:()=>vu,queryHasPrevPage:()=>Au});var N={};r.r(N),r.d(N,{getEditedItem:()=>ku,getFirewallRules:()=>Ou,getItemById:()=>wu});var Q={};r.r(Q),r.d(Q,{FAILED_QUERY:()=>no,FINISH_QUERY:()=>so,RECEIVE_LOG:()=>io,RECEIVE_QUERY:()=>to,START_QUERY:()=>ro,fetchQueryNextPage:()=>Ju,fetchQueryPrevPage:()=>Ku,query:()=>Zu,receiveLog:()=>eo,receiveQuery:()=>zu,refreshQuery:()=>ju});var x={};r.r(x),r.d(x,{getLog:()=>po,getLogById:()=>mo,getLogs:()=>uo,getQueryHeader:()=>fo,getQueryHeaderLink:()=>lo,getQueryHeaderLinks:()=>co,getQueryParams:()=>go,getQueryResults:()=>oo,isQuerying:()=>Eo,queryHasNextPage:()=>yo,queryHasPrevPage:()=>ao});var L={};r.r(L),r.d(L,{getLogById:()=>So,getLogs:()=>Io});var U={};r.r(U),r.d(U,{FAILED_QUERY:()=>Ho,FINISH_QUERY:()=>wo,RECEIVE_ITEM:()=>Oo,RECEIVE_QUERY:()=>Fo,START_QUERY:()=>ko,editItem:()=>No,fetchQueryNextPage:()=>bo,fetchQueryPrevPage:()=>Ro,query:()=>Ao,refreshQuery:()=>vo,resetAllEdits:()=>xo,resetEdits:()=>Qo,saveEditedItem:()=>Lo,saveEditedItems:()=>Uo,saveItem:()=>Co});var C={};r.r(C),r.d(C,{getDirtyItems:()=>zo,getEditedItem:()=>Xo,getItem:()=>jo,getItemById:()=>Ko,getLastSaveError:()=>sl,getQueryHeader:()=>Wo,getQueryHeaderLink:()=>Bo,getQueryHeaderLinks:()=>Mo,getQueryParams:()=>$o,getQueryResults:()=>Vo,getQueryUser:()=>Zo,isDirty:()=>el,isQuerying:()=>Jo,isSaving:()=>tl,isSavingAnyItems:()=>rl,queryHasNextPage:()=>Yo,queryHasPrevPage:()=>Go});var D={};r.r(D),r.d(D,{getActorTypes:()=>Sl,getActors:()=>_l,getBatchMaxItems:()=>Tl,getCurrentUser:()=>yl,getCurrentUserId:()=>dl,getFeatureFlags:()=>ql,getIndex:()=>El,getInstallType:()=>vl,getRequirementsInfo:()=>Il,getRoles:()=>ml,getSchema:()=>pl,getServerType:()=>Al,getSiteInfo:()=>hl,getUser:()=>al,hasPatchstack:()=>Rl,isLiquidWebCustomer:()=>bl,isSavingCurrentUser:()=>gl,isSavingUser:()=>fl});var F={};r.r(F),r.d(F,{LOAD_INITIAL_FEATURE_FLAGS:()=>Wl,RECEIVE_ACTORS:()=>Gl,RECEIVE_ACTOR_TYPES:()=>Ml,RECEIVE_BATCH_MAX_ITEMS:()=>$l,RECEIVE_CURRENT_USER_ID:()=>Bl,RECEIVE_INDEX:()=>Hl,RECEIVE_SITE_INFO:()=>Yl,RECEIVE_USER:()=>Vl,__unstableLoadInitialFeatureFlags:()=>kl,fetchIndex:()=>Pl,fetchUser:()=>Ll,receiveActorTypes:()=>Dl,receiveActors:()=>Fl,receiveBatchMaxItems:()=>wl,receiveCurrentUserId:()=>Cl,receiveIndex:()=>Nl,receiveSiteInfo:()=>Ol,receiveUser:()=>Ul,saveCurrentUser:()=>Ql,saveUser:()=>xl});var O={};r.r(O),r.d(O,{getActorTypes:()=>nc,getActors:()=>ic,getBatchMaxItems:()=>oc,getCurrentUser:()=>sc,getIndex:()=>Zl,getInstallType:()=>zl,getRequirementsInfo:()=>Jl,getRoles:()=>Kl,getSchema:()=>jl,getServerType:()=>Xl,getSiteInfo:()=>uc,getUser:()=>rc,hasPatchstack:()=>ec,isLiquidWebCustomer:()=>tc});var k=r(48015),w=r(92819),H=r(87514),V=r.n(H),B=r(31511);function M(e){return{type:"API_FETCH",request:e}}function G(e){return{type:"API_FETCH_RESULT",request:e}}function Y(e,t,...r){return{type:"SELECT",storeKey:e,selectorName:t,args:r}}function W(e,t,...r){return{type:"DISPATCH",storeKey:e,actionName:t,args:r}}function $(e,t){return{type:"FETCH",request:e,init:t}}function Z(e){return{type:"PARSE_FETCH_RESPONSE",response:e}}function j(e,t){return{type:"AWAIT_PROMISE",promise:e,delay:t}}function K(e,t){return{type:"UPDATE_SETTINGS",module:e,settings:t}}function J(e="info",t,r={}){return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}function X(e){return{type:"API_FETCH_BATCH",batch:e}}const z={AWAIT_PROMISE:({promise:e,delay:t})=>{return t?Promise.all([e,(r=t,new Promise((e=>setTimeout(e,r))))]):e;var r},API_FETCH:({request:e})=>V()(e).catch(B.xJ),API_FETCH_RESULT:({request:e})=>V()({...e,parse:!1}).then(B.x4.fromResponse).catch(B.xJ).catch((e=>e.getResponse?B.x4.fromResponse(e.getResponse()):new B.x4(B.x4.ERROR,new B.PN("unknown_error","Unknown error")))),SELECT({storeKey:e,selectorName:t,args:r}){const s=(0,k.select)(e)[t];return s.hasResolver?(({storeKey:e,selectorName:t,args:r})=>new Promise((s=>{const n=()=>(0,k.select)("core/data").hasFinishedResolution(e,t,r),i=()=>(0,k.select)(e)[t].apply(null,r),u=i();if(n())return s(u);const o=(0,k.subscribe)((()=>{n()&&(o(),s(i()))}))})))({storeKey:e,selectorName:t,args:r}):s(...r)},DISPATCH:({storeKey:e,actionName:t,args:r})=>(0,k.dispatch)(e)[t](...r),PARSE_FETCH_RESPONSE:async function({response:e}){return await e.json()},FETCH:({request:e,init:t})=>window.fetch(e,t),UPDATE_SETTINGS:(0,k.createRegistryControl)((e=>({module:t,settings:r})=>e.dispatch("ithemes-security/modules").updateSettings(t,r))),CREATE_NOTICE({status:e,content:t,options:r}){r.autoDismiss&&(r.id=r.id||(0,w.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,k.dispatch)("core/notices").removeNotice(r.id,r.context)),r.autoDismiss)),(0,k.dispatch)("core/notices").createNotice(e,t,r)},API_FETCH_BATCH:(0,k.createRegistryControl)((e=>async({batch:t})=>{const r=await e.resolveSelect(Gt).getBatchMaxItems(),s=(0,w.chunk)(t,r||25),n=[],i=[];if(!s.length)return[];for(const e of s)try{const t=await z.API_FETCH({request:{path:"/batch/v1",method:"POST",data:{requests:e}}});i.push(...t.responses)}catch(t){n.push(t),i.push(...(0,w.times)(e.length,(0,w.constant)({body:t,status:500,headers:{}})))}if(n.length===s.length)throw n[0];return i}))},ee=z;var te=r(73470);const re="/ithemes-security/v1/bans";function*se(e,t={}){let r,s;yield{type:he,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(re,t),parse:!1}),s=yield Z(r)}catch(r){return yield{type:Te,queryId:e,queryParams:t,error:r},r}return yield ue(e,t.context||"view",r,s,"replace"),yield{type:qe,queryId:e,queryParams:t,response:r},r}function*ne(e){const t=yield Y("ithemes-security/bans","getQueryParams",e);yield*se(e,t)}function*ie(e,t="append"){const r=yield Y("ithemes-security/bans","getQueryHeaderLink",e,"next");if(!r)return[];let s,n;yield{type:he,queryId:e};try{s=yield M({url:r.link,parse:!1}),n=yield Z(s)}catch(t){return yield{type:Te,queryId:e,error:t},t}const i=(0,te.getQueryArg)(r.link,"context")||"view";return yield ue(e,i,s,n,t),yield{type:qe,queryId:e,response:s},s}function ue(e,t,r,s,n){return{type:_e,queryId:e,context:t,response:r,items:s,mode:n}}function oe(e){return{type:be,ban:e}}function le(e){return{type:Ae,ban:e}}function ce(e,t){return{type:Re,ban:e,error:t}}function ae(e,t){return{type:ve,ban:e,response:t}}function ye(e,t){return{type:Pe,self:e,ban:t}}function de(e,t){return{type:Qe,self:e,error:t}}function fe(e,t){return{type:Ne,self:e,response:t}}function ge(e){return{type:xe,self:e}}function Ee(e,t){return{type:Ue,self:e,error:t}}function pe(e){return{type:Le,self:e}}function*me(e,t){const r={method:"POST",data:t};let s;(0,te.isURL)(e)?r.url=e:r.path=`${re}/${e}`,yield le(t);try{s=yield M(r)}catch(e){return yield ce(t,e),e}return yield ae(t,s),yield oe(s),s}function*Ie(e,t){const r=(0,w.isObject)(e)?(0,B.AW)(e):e;let s;yield ye(r,t);try{s=yield M({url:r,method:"PUT",data:t})}catch(e){return yield de(r,e),e}return yield fe(r,s),yield oe(s),s}function*Se(e){const t=(0,w.isObject)(e)?(0,B.AW)(e):e;yield ge(t);try{yield M({url:t,method:"DELETE"})}catch(e){return yield Ee(t,e),e}return yield pe(t),null}const _e="RECEIVE_QUERY",he="START_QUERY",qe="FINISH_QUERY",Te="FAILED_QUERY",Ae="START_CREATE_BAN",ve="FINISH_CREATE_BAN",Re="FAILED_CREATE_BAN",be="RECEIVE_BAN",Pe="START_UPDATE_BAN",Ne="FINISH_UPDATE_BAN",Qe="FAILED_UPDATE_BAN",xe="START_DELETE_BAN",Le="FINISH_DELETE_BAN",Ue="FAILED_DELETE_BAN";var Ce=r(28306);const De=(0,k.createRegistrySelector)((e=>()=>e("ithemes-security/bans").getQueryResults("main"))),Fe=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function Oe(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function ke(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function we(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function He(e,t){return(0,w.get)(e,["queryParams",t])}function Ve(e,t){return e.bySelf[t]}function Be(e,t){const r=(0,w.isObject)(t)?(0,B.AW)(t):t;return e.updating.includes(r)}function Me(e,t){const r=(0,w.isObject)(t)?(0,B.AW)(t):t;return e.deleting.includes(r)}function Ge(e,t){return e.querying.includes(t)}function*Ye(){yield W("ithemes-security/bans","query","main",{per_page:100})}var We=r(38085);const $e={bySelf:{},queries:{},queryParams:{},querying:[],creating:[],updating:[],deleting:[]},Ze="ithemes-security/bans";function*je(e){const t=`https://ithemes.com/wp-json/ithemes/v1/inline-help/itsec/${encodeURIComponent(e)}`,r=yield $(t,{credentials:"omit",referrer:"no-referrer"});if(!r.ok)return;if(r.status>=400)return;const s=yield Z(r);yield{type:Je,topic:e,help:s}}function*Ke(e=!0){yield K("global",{enable_remote_help:e})}(0,k.register)((0,k.createReduxStore)(Ze,{controls:ee,actions:s,selectors:n,resolvers:i,reducer:function(e=$e,t){switch(t.type){case _e:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.AW):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.AW)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.AW)(e),{context:t.context,item:e}])))}};case he:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case qe:case Te:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case be:return{...e,bySelf:{...e.bySelf,[(0,B.AW)(t.ban)]:{context:"edit",item:t.ban}}};case Ae:return{...e,creating:[...e.creating,t.ban]};case ve:case Re:return{...e,creating:e.creating.filter((e=>e!==t.ban))};case Pe:return{...e,updating:[...e.updating,t.self]};case Ne:case Qe:return{...e,updating:e.updating.filter((e=>e!==t.self))};case xe:return{...e,deleting:[...e.deleting,t.self],bySelf:(0,w.omit)(e.bySelf,[t.self])};case Le:case Ue:return{...e,deleting:e.deleting.filter((e=>e!==t.self))};default:return e}}}));const Je="RECEIVE_HELP",Xe=[];function ze(e,t){return e.byTopic[t]||Xe}const et=(0,k.createRegistrySelector)((e=>()=>e("ithemes-security/modules").getSettings("global")?.enable_remote_help));function*tt(e){yield je(e)}const rt={byTopic:{}},st="ithemes-security/help",nt=(0,k.createReduxStore)(st,{controls:ee,actions:u,selectors:o,resolvers:l,reducer:function(e=rt,t){return t.type===Je?{...e,byTopic:{...e.byTopic,[t.topic]:t.help}}:e}});(0,k.register)(nt);var it=r(86076),ut=r(66e3),ot=r(95122);const lt="ithemes-security/modules";function*ct(e,t){const r=yield k.controls.select(lt,"getModule",e);r?yield{type:Nt,module:e,edit:(0,it.Z)(r,t)}:yield{type:Nt,module:e,edit:t}}function*at(e=!0){if(!0===e?e=yield k.controls.select(lt,"getDirtyModules"):(0,w.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const r of e){const e=yield k.controls.select(lt,"getModuleEdits",r);t.push({method:"PUT",path:`/ithemes-security/v1/modules/${r}`,body:e})}let r;try{yield{type:xt,modules:e},r=yield X(t)}catch(t){return yield{type:Lt,modules:e},yield J("error",t.message),t}const s=[],n={};for(let i=0;i<t.length;i++){const t=e[i],u=r[i];u.status>=400?n[t]=u.body:(s.push(t),yield vt(u.body))}return(0,w.isEmpty)(n)||(yield{type:Lt,errors:n}),s.length&&(yield{type:Ut,modules:s}),r}function*yt(e=!0){!0===e?e=yield k.controls.select(lt,"getDirtyModules"):(0,w.isString)(e)&&(e=[e]),yield{type:Qt,modules:e}}function*dt(e){try{const t=yield qt(e,"active");yield vt(t),yield{type:Ut,modules:[e]},t.side_effects&&(yield Tt()),yield J("success",(0,ot.__)("Activated feature","better-wp-security"),{type:"snackbar"})}catch(t){yield{type:Lt,errors:{[e]:t}}}}function*ft(e){try{const t=yield qt(e,"inactive");yield vt(t),yield{type:Ut,modules:[e]},t.side_effects&&(yield Tt()),yield J("success",(0,ot.__)("Deactivated feature","better-wp-security"),{type:"snackbar"})}catch(t){yield{type:Lt,errors:{[e]:t}}}}function*gt(e){const t={requests:(0,w.map)(e,((e,t)=>({path:`/ithemes-security/v1/modules/${t}`,method:"PUT",body:{status:{selected:e}}})))},r=yield X(t);for(let e=0;e<r.length;e++){const t=r[e];t.status>=400?yield J("error",t.body.message):yield vt(t.body)}}function*Et(e,t){const r=yield k.controls.select(lt,"getSettings",e);if(!r)return void(yield{type:Dt,module:e,edit:t});const s={};let n=!1;for(const e in t)t.hasOwnProperty(e)&&((0,w.isEqual)(t[e],r[e])||(s[e]=t[e],n=!0));n?yield{type:Dt,module:e,edit:s}:yield mt(e)}function*pt(e,t,r){const s=yield k.controls.select(lt,"getSetting",e,t);(0,w.isEqual)(s,r)?yield{type:Ot,module:e,setting:t}:yield{type:Ft,module:e,setting:t,value:r}}function*mt(e=!0){!0===e?e=yield k.controls.select(lt,"getDirtySettings"):(0,w.isString)(e)&&(e=[e]),yield{type:kt,modules:e}}function*It(e=!0,t=!1){if(!0===e?e=yield k.controls.select(lt,"getDirtySettings"):(0,w.isString)(e)&&(e=[e]),!e.length)return[];const r=[],s=[],n={};for(const i of e){if(t){const e=yield k.controls.dispatch(lt,"validateSettings",i);if(!0!==e){const t=new B.PN("local_validation_failed");e.errorText.forEach((e=>t.add("local_validation_failed",e))),n[i]=t;continue}}const e=yield k.controls.select(lt,"getSettingEdits",i);s.push(i),r.push({method:"PATCH",path:`/ithemes-security/v1/settings/${i}`,body:e})}let i;try{yield{type:wt,modules:e},i=yield X(r)}catch(t){return yield{type:Ht,modules:e},yield J("error",t.message),t}const u=[];for(let e=0;e<r.length;e++){const t=s[e],r=i[e];r.status>=400?n[t]=r.body:(u.push(t),yield Rt(t,r.body))}return(0,w.isEmpty)(n)||(yield{type:Ht,errors:n}),u.length&&(yield J("success",(0,ot.__)("Saved settings.","better-wp-security"),{type:"snackbar"}),yield{type:Vt,modules:u}),i}function*St(e,t){let r;yield{type:wt,modules:[e]};try{r=yield M({path:`/ithemes-security/v1/settings/${e}`,method:"PATCH",data:t}),yield Rt(e,r)}catch(t){return yield{type:Ht,errors:{[e]:t}},t}return yield{type:Vt,modules:[e]},r}const _t=e=>async({select:t,resolveSelect:r})=>{const s=await r.getSettingsConditionalSchema(e);if(!s)return!0;const n=t.getEditedSettings(e),i=(0,B.g4)();return!!i.validate(s,n)||{errors:i.errors,errorText:ht(i.errors,e,s)}};function ht(e,t,r){const s=[];for(const{message:n,schemaPath:i,dataPath:u}of e){let e=ut.IB.create(i),o=e.parent(r);for(;o&&!o.title;)e=ut.IB.create(e.path.slice(0,e.path.length-1)),o=e.parent(r);o?.title?s.push(`${o.title} ${n}.`):s.push(`${t}${u} ${n}.`)}return s}function qt(e,t){return M({method:"PUT",path:`/ithemes-security/v1/modules/${e}`,data:{status:{selected:t}}})}function*Tt(){const e=yield M({path:"/ithemes-security/v1/modules?context=edit&_embed=1"});yield At(e)}function At(e){return{type:bt,modules:e}}function vt(e){return{type:Pt,module:e}}function Rt(e,t){return{type:Ct,module:e,settings:t}}const bt="RECEIVE_MODULES",Pt="RECEIVE_MODULE",Nt="EDIT_MODULE",Qt="RESET_MODULE_EDITS",xt="START_SAVING_MODULES",Lt="FAILED_SAVING_MODULES",Ut="FINISH_SAVING_MODULES",Ct="RECEIVE_SETTINGS",Dt="EDIT_SETTINGS",Ft="EDIT_SETTING",Ot="RESET_SETTING_EDIT",kt="RESET_SETTING_EDITS",wt="START_SAVING_SETTINGS",Ht="FAILED_SAVING_SETTINGS",Vt="FINISH_SAVING_SETTINGS";var Bt=r(59588),Mt=r.n(Bt);const Gt="ithemes-security/core";function Yt(e){return e.modules}const Wt=(0,Ce.Z)((e=>e.modules.map((t=>({...t,...e.moduleEdits[t.id]||{}})))),(e=>[e.modules,e.moduleEdits])),$t=(0,Ce.Z)(((e,t)=>{const r=jt(e,t);return r?{...r,...e.moduleEdits[t]||{}}:null}),((e,t)=>[e.modules,e.moduleEdits[t]])),Zt=(0,Ce.Z)((e=>e.modules.filter((e=>"active"===e.status.selected)).map((e=>e.id))),(e=>e.modules));function jt(e,t){return e.modules.find((e=>e.id===t))}function Kt(e,t){return"active"===jt(e,t)?.status.selected}function Jt(e,t){return e.moduleEdits[t]}function Xt(e,t){return e.savingModules.includes(t)}function zt(e){return Object.keys(e.moduleEdits)}function er(e,t){return!!e.moduleEdits[t]}function tr(e,t){var r;return null!==(r=e.settings[t])&&void 0!==r?r:{}}function rr(e,t,r){return e.settings[t]?.[r]}function sr(e,t){return e.settingEdits[t]}const nr=(0,Ce.Z)(((e,t)=>({...e.settings[t]||{},...e.settingEdits[t]||{}})),((e,t)=>[e.settings[t],e.settingEdits[t]]));function ir(e,t,r){return e.settingEdits[t]?.[r]||e.settings[t]?.[r]}function ur(e,t){return Array.isArray(t)?e.savingSettings.some((e=>t.includes(e))):e.savingSettings.includes(t)}function or(e){return Object.keys(e.settingEdits)}function lr(e,t){return e.settingEdits[t]&&!(0,w.isEmpty)(e.settingEdits[t])}function cr(e,t){return e.errors[t]}function ar(e){return e.settings}const yr=(0,Ce.Z)((e=>(0,w.reduce)(e.settings,((t,r,s)=>(t[s]={...r,...e.settingEdits[s]||{}},t)),{})),(e=>[e.settings,e.settingEdits]));function dr(e,t,r){return jt(e,t)?.settings?.schema.properties[r]}const fr=Mt()(((e,t,r,s,n,i,u,o)=>{const l={select:t,serverType:r,installType:s,featureFlags:n,activeModules:i,settings:u,userGroupsBySetting:o},c=t=>((e,t,r)=>{const{serverType:s,installType:n,activeModules:i,settings:u,featureFlags:o,userGroupsBySetting:l}=r;if(e["server-type"]&&!e["server-type"].includes(s))return!1;if(e["install-type"]&&e["install-type"]!==n)return!1;if(e["active-modules"])for(const t of e["active-modules"])if(!i.includes(t))return!1;if(e["user-groups"])for(const r of e["user-groups"])if(!l[t.id]?.[r]?.length)return!1;if(e["feature-flags"])for(const t of e["feature-flags"])if(!o?.includes(t))return!1;return!(e.settings&&!(0,B.g4)().compile(e.settings)(u))})(t,e,l),a=(t,r)=>r.properties?{...r,properties:Object.entries(r.properties).reduce(((r,[s,n])=>{const i=`${t}.${s}`;return e.settings.conditional[i]&&!c(e.settings.conditional[i])||(r[s]=a(i,n)),r}),{})}:r,y=Object.entries(e.settings.schema.properties).reduce(((t,[r,s])=>e.settings.interactive.includes(r)?(e.settings.conditional[r]&&!c(e.settings.conditional[r])||(t[r]=a(r,s)),t):t),{}),{id:d,...f}=e.settings.schema;return{...f,properties:y}})),gr=(0,k.createRegistrySelector)((e=>(t,r)=>{const s=$t(t,r);return s?.settings?fr(s,e,e(Gt).getServerType(),e(Gt).getInstallType(),e(Gt).getFeatureFlags(),Zt(t),nr(t,r),e("ithemes-security/user-groups-editor").getEditedGroupsBySetting()):null})),Er={modules:[],moduleEdits:{},savingModules:[],settings:{},settingEdits:{},savingSettings:[],errors:{}};function*pr(){yield Tt()}const mr={*fulfill(e){const t=yield M({path:`/ithemes-security/v1/settings/${e}`});yield Rt(e,t)},isFulfilled:(e,t)=>e.settings.hasOwnProperty(t)},Ir={*fulfill(){yield k.controls.resolveSelect(lt,"getModules")},isFulfilled:e=>!(0,w.isEmpty)(e.settings)};function*Sr(){yield k.controls.resolveSelect(lt,"__unstableGetAllSettings")}function*_r(){yield k.controls.resolveSelect(lt,"getModules")}const hr={*fulfill(){yield k.controls.resolveSelect(lt,"getModules")},isFulfilled:(e,t)=>e.modules.includes((e=>e.id===t))};function*qr(){yield k.controls.resolveSelect(lt,"getModules")}function*Tr(){yield k.controls.resolveSelect(lt,"getModules")}function*Ar(e){yield k.controls.resolveSelect(lt,"getSettings",e)}function*vr(e){yield k.controls.resolveSelect(lt,"getSettings",e)}function*Rr(e){yield k.controls.resolveSelect(lt,"getSettings",e)}const br=(0,k.createReduxStore)(lt,{controls:ee,actions:c,selectors:a,resolvers:y,reducer:function(e=Er,t){switch(t.type){case bt:return{...e,modules:[...t.modules],settings:{...e.settings,...t.modules.reduce(((e,t)=>{const r=(0,w.get)(t,["_embedded","ithemes-security:settings",0]);return r?{...e,[t.id]:r}:e}),{})}};case Pt:return{...e,modules:e.modules.map((e=>e.id===t.module.id?t.module:e)),settings:{...e.settings,[t.module.id]:(0,w.get)(t.module,["_embedded","ithemes-security:settings",0],e.settings[t.module.id])}};case Nt:return{...e,moduleEdits:{...e.moduleEdits,[t.module]:t.edit}};case Qt:return{...e,moduleEdits:(0,w.omit)(e.moduleEdits,t.modules)};case xt:return{...e,savingModules:[...e.savingModules,...t.modules]};case Ut:return{...e,savingModules:e.savingModules.filter((e=>!t.modules.includes(e))),moduleEdits:(0,w.omit)(e.moduleEdits,t.modules),errors:(0,w.omit)(e.errors,t.modules)};case Lt:return{...e,savingModules:(0,w.without)(e.savingModules,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};case Ct:return{...e,settings:{...e.settings,[t.module]:t.settings}};case Dt:return{...e,settingEdits:{...e.settingEdits,[t.module]:t.edit}};case Ft:return{...e,settingEdits:{...e.settingEdits,[t.module]:{...e.settingEdits[t.module]||{},[t.setting]:t.value}}};case Ot:return{...e,settingEdits:{...e.settingEdits,[t.module]:(0,w.omit)(e.settingEdits[t.module]||{},t.setting)}};case kt:return{...e,settingEdits:(0,w.omit)(e.settingEdits,t.modules)};case wt:return{...e,savingSettings:[...e.savingSettings,...t.modules]};case Vt:return{...e,savingSettings:e.savingSettings.filter((e=>!t.modules.includes(e))),settingEdits:(0,w.omit)(e.settingEdits,t.modules),errors:(0,w.omit)(e.errors,t.modules)};case Ht:return{...e,savingSettings:(0,w.without)(e.savingSettings,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};default:return e}},persist:["moduleEdits","settingEdits"]});(0,k.register)(br);const Pr=br;function*Nr(){const e=yield M({path:"/ithemes-security/v1/tools"});yield{type:Lr,tools:e}}function*Qr(e,t={}){let r;yield{type:Ur,tool:e,form:t};try{r=yield M({path:`/ithemes-security/v1/tools/${e}`,method:"POST",data:t,parse:!1})}catch(t){const r=yield j(B.x4.fromResponse(t.getResponse()));return yield{type:Cr,tool:e,result:r},r}const s=yield j(B.x4.fromResponse(r));return yield{type:Cr,tool:e,result:s},s}function*xr(e,t=!0){let r;yield{type:Dr,tool:e,enabled:t};try{r=yield M({path:`/ithemes-security/v1/tools/${e}`,method:"PUT",data:{enabled:t}})}catch(t){return yield{type:Fr,tool:e,error:t},t}return yield{type:Or,tool:e,data:r},r}const Lr="RECEIVE_TOOLS",Ur="START_TOOL",Cr="FINISH_TOOL",Dr="START_TOGGLE_TOOL",Fr="FAILED_TOGGLE_TOOL",Or="FINISH_TOGGLE_TOOL",kr="ithemes-security/tools",wr=Mt()(((e,t)=>e.map((e=>t[e.slug]||e))),{maxSize:1}),Hr=(0,k.createRegistrySelector)((e=>t=>wr(e(kr).getToolsConfig(),t.bySlug))),Vr=(0,Ce.Z)((e=>e.slugs.map((t=>e.bySlug[t]))),(e=>[e.bySlug,e.slugs])),Br=Mt()((e=>e.reduce(((e,t)=>{for(const[r,s]of Object.entries(t.tools))e.push({slug:r,module:t.id,toggleable:!1,schedule:"",form:null,...s});return e}),[])),{maxSize:1}),Mr=(0,k.createRegistrySelector)((e=>()=>Br(e(lt).getModules()))),Gr=(0,k.createRegistrySelector)((e=>(t,r)=>t.bySlug[r]||e(kr).getToolsConfig().find((e=>r===e.slug))));function Yr(e){return e.running}function Wr(e,t){return e.running.includes(t)}function $r(e,t){return e.lastResult[t]}function Zr(e,t){return e.updating.includes(t)}function jr(e,t){return e.lastError[t]}const Kr={bySlug:{},slugs:[],running:[],lastResult:{},updating:[],lastError:{}};function*Jr(){yield Nr()}function*Xr(){yield k.controls.resolveSelect(kr,"getTools")}const zr={*fulfill(){yield k.controls.resolveSelect(kr,"getTools")},isFulfilled:(e,t)=>!!e.bySlug[t]},es=(0,k.createReduxStore)(kr,{controls:ee,actions:d,selectors:f,resolvers:g,reducer:function(e=Kr,t){switch(t.type){case Lr:return{...e,bySlug:(0,w.keyBy)(t.tools,"slug"),slugs:(0,w.map)(t.tools,"slug")};case Ur:return{...e,running:[...e.running,t.tool]};case Cr:return{...e,running:(0,w.without)(e.running,t.tool),lastResult:{...e.lastResult,[t.tool]:t.result}};case Dr:return{...e,updating:[...e.updating,t.tool]};case Fr:return{...e,updating:(0,w.without)(e.updating,t.tool),lastError:{...e.lastError,[t.tool]:t.error}};case Or:return{...e,updating:(0,w.without)(e.updating,t.tool),lastError:(0,w.omit)(e.lastError,t.tool),bySlug:{...e.bySlug,[t.tool]:t.data}};default:return e}}});(0,k.register)(es);const ts=es,rs="ithemes-security/vulnerabilities",ss="/ithemes-security/v1/site-scanner/vulnerabilities";function*ns(e,t={}){let r,s;yield{type:ps,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(ss,t),parse:!1}),s=yield Z(r)}catch(r){return yield{type:Is,queryId:e,queryParams:t,error:r},r}return yield fs(e,t.context||"view",r,s,"replace"),yield{type:ms,queryId:e,queryParams:t,response:r},s}function*is(e){const t=yield Y(rs,"getQueryParams",e);yield*ns(e,t)}function*us(e,t="append"){return yield*ls(e,"prev",t)}function*os(e,t="append"){return yield*ls(e,"next",t)}function*ls(e,t,r){const s=yield Y(rs,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:ps,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield Z(n)}catch(t){return yield{type:Is,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield fs(e,u,n,i,r),yield{type:ms,queryId:e,response:n},n}function*cs(e){return yield*ds(e,"ithemes-security:mute-vulnerability")}function*as(e){return yield*ds(e,"ithemes-security:fix-vulnerability")}function*ys(e){return yield*ds(e,"ithemes-security:deactivate-vulnerable-software")}function*ds(e,t){const r="string"==typeof e?yield k.controls.select(rs,"getVulnerability",e):e,s=(0,B.Rg)(r,t);if(!s)return;const n=(0,B.AW)(r);yield{type:Ss,rel:t,self:n};try{const e=yield M({url:s,method:"POST"});return yield{type:_s,rel:t,self:n},yield gs(e),e}catch(e){return yield{type:hs,rel:t,self:n,error:e},e}}function fs(e,t,r,s,n){return{type:Es,queryId:e,context:t,response:r,items:s,mode:n}}function gs(e){return{type:qs,vulnerability:e}}const Es="RECEIVE_QUERY",ps="START_QUERY",ms="FINISH_QUERY",Is="FAILED_QUERY",Ss="START_ACTION",_s="FINISH_ACTION",hs="FAILED_ACTION",qs="RECEIVE_VULNERABILITY",Ts=(0,k.createRegistrySelector)((e=>()=>e(rs).getQueryResults("main"))),As=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function vs(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Rs(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function bs(e,t){return!!vs(e,t,"prev")}function Ps(e,t){return!!vs(e,t,"next")}function Ns(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function Qs(e,t){return(0,w.get)(e,["queryParams",t])}function xs(e,t){return e.bySelf[t]?.item}function Ls(e,t){return xs(e,e.selfById[t])}function Us(e,t){const r="string"==typeof t?xs(e,t):t;return r?(0,w.reduce)(r._links,((e,t,r)=>t.reduce(((e,t)=>t.title?(e.push({rel:r,title:t.title,isDestructive:t.isDestructive||!1}),e):e),e)),[]):[]}function Cs(e,t){return e.querying.includes(t)}function Ds(e,t){return ks(e,t,"ithemes-security:mute-vulnerability")}function Fs(e,t){return ks(e,t,"ithemes-security:fix-vulnerability")}function Os(e,t){return ks(e,t,"ithemes-security:deactivate-vulnerable-software")}function ks(e,t,r){const s="string"==typeof t?t:(0,B.AW)(t);return e.actions.includes(`${r}:${s}`)}function*ws(){yield W(rs,"query","main",{per_page:100,resolution:["unresolved","patched","deactivated"]})}function*Hs(e){const t=yield M({path:`${ss}/${e}`});return yield gs(t),t}const Vs={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],actions:[]},Bs=(0,k.createReduxStore)(rs,{actions:E,selectors:p,resolvers:m,controls:ee,reducer:function(e=Vs,t){switch(t.type){case Es:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.AW):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.AW)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.AW)(e)])))}};case ps:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case ms:case Is:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case qs:return{...e,bySelf:{...e.bySelf,[(0,B.AW)(t.vulnerability)]:{context:"edit",item:t.vulnerability}},selfById:{...e.selfById,[t.vulnerability.id]:(0,B.AW)(t.vulnerability)}};case Ss:return{...e,actions:[...e.actions,`${t.rel}:${t.self}`]};case _s:case hs:return{...e,actions:e.actions.filter((e=>e!==`${t.rel}:${t.self}`))};default:return e}}});(0,k.register)(Bs);const Ms=Bs,Gs="ithemes-security/site-scanner",Ys="/ithemes-security/v1/site-scanner/scans";function*Ws(e,t={}){let r,s;yield{type:tn,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(Ys,t),parse:!1}),s=yield Z(r)}catch(r){return yield{type:sn,queryId:e,queryParams:t,error:r},r}return yield zs(e,t.context||"view",r,s,"replace"),yield{type:rn,queryId:e,queryParams:t,response:r},r}function*$s(e){const t=yield Y(Gs,"getQueryParams",e);yield*Ws(e,t)}function*Zs(e,t="append"){return yield*Ks(e,"prev",t)}function*js(e,t="append"){return yield*Ks(e,"next",t)}function*Ks(e,t,r){const s=yield Y(Gs,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:tn,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield Z(n)}catch(t){return yield{type:sn,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield zs(e,u,n,i,r),yield{type:rn,queryId:e,response:n},n}function*Js(e=0){yield{type:un,siteId:e};try{const t=yield M({path:Ys,method:"POST",data:{site_id:e}});return yield Xs(t),yield{type:on,siteId:e},t}catch(e){return yield{type:ln,error:e},e}}function Xs(e){return{type:nn,scan:e}}function zs(e,t,r,s,n){return{type:en,queryId:e,context:t,response:r,items:s,mode:n}}const en="RECEIVE_QUERY",tn="START_QUERY",rn="FINISH_QUERY",sn="FAILED_QUERY",nn="RECEIVE_SCAN",un="START_SCAN",on="FINISH_SCAN",ln="FAILED_SCAN",cn=(0,k.createRegistrySelector)((e=>()=>e(Gs).getQueryResults("main"))),an=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function yn(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function dn(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function fn(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function gn(e,t){return(0,w.get)(e,["queryParams",t])}function En(e,t){return e.bySelf[t]?.item}function pn(e,t){return e.querying.includes(t)}function mn(e,t=0){return e.scanning===t}function*In(){yield W(Gs,"query","main",{per_page:100})}const Sn={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],scanning:null},_n=(0,k.createReduxStore)(Gs,{actions:I,selectors:S,resolvers:_,controls:ee,reducer:function(e=Sn,t){switch(t.type){case en:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.AW):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.AW)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.AW)(e),{context:t.context,item:e}])))}};case tn:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case rn:case sn:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case nn:return{...e,bySelf:{...e.bySelf,[(0,B.AW)(t.scan)]:{context:"edit",item:t.scan}}};case un:return{...e,scanning:t.siteId};case on:case ln:return{...e,scanning:null};default:return e}}});(0,k.register)(_n);const hn=_n,qn="ithemes-security/patchstack",Tn="https://itsec-site-scanner.ithemes.com";function*An(e,t={}){let r,s;yield{type:Qn,queryId:e,queryParams:t},t.per_page=t.per_page||100,t.page=t.page||1;try{if(r=yield $((0,te.addQueryArgs)(Tn+"/db",t),{credentials:"omit"}),!r.ok)throw yield Z(r);s=yield Z(r)}catch(r){return yield{type:Ln,queryId:e,queryParams:t,error:r},r}return yield Nn(e,t.context||"view",r,s,"replace"),yield{type:xn,queryId:e,queryParams:t,response:r},r}function*vn(e){const t=yield k.controls.select(qn,"getQueryParams",e);yield*An(e,t)}function*Rn(e,t="append"){return yield*Pn(e,"prev",t)}function*bn(e,t="append"){return yield*Pn(e,"next",t)}function*Pn(e,t,r){const s=yield k.controls.select(qn,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:Qn,queryId:e};try{n=yield $(Tn+s.link,{credentials:"omit"}),i=yield Z(n)}catch(t){return yield{type:Ln,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield Nn(e,u,n,i,r),yield{type:xn,queryId:e,response:n},n}function Nn(e,t,r,s,n){return{type:Un,queryId:e,context:t,response:r,items:s,mode:n}}const Qn="START_QUERY",xn="FINISH_QUERY",Ln="FAILED_QUERY",Un="RECEIVE_QUERY",Cn=(0,k.createRegistrySelector)((e=>()=>e(qn).getQueryResults("main")));function Dn(e,t){return e.byId[t]}const Fn=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"ids"],[]),s=e.byId,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.byId]));function On(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:[r]})}function kn(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:[r]})}function wn(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function Hn(e,t){return(0,w.get)(e,["queryParams",t])}function Vn(e,t){return On(e,t,"next")}function Bn(e,t){return!!On(e,t,"prev")}function Mn(e,t){return(0,w.get)(e,["errors",t])}function Gn(e,t){return e.querying.includes(t)}function*Yn(){yield W(qn,"query","main",{per_page:100})}const Wn={byId:{},queries:{},queryParams:{},querying:[],actions:[]},$n=(0,k.createReduxStore)(qn,{controls:ee,actions:h,selectors:q,resolvers:T,reducer:function(e=Wn,t){switch(t.type){case Un:return{...e,queries:{...e.queries,[t.queryId]:{ids:"replace"===t.mode?(0,w.map)(t.items,"id"):[...(0,w.get)(e,["queries",t.queryId,"ids"],[]),...(0,w.map)(t.items,"id")],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0})}},byId:{...e.byId,...(0,w.fromPairs)(t.items.filter((r=>{const s=r.id;return!e.byId[s]||"embed"===e.byId[s].context||e.byId[s].context===t.context})).map((e=>[e.id,{context:t.context,item:e}])))}};case Qn:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]},errors:(0,w.omit)(e.errors,[t.queryId])};case xn:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Ln:return{...e,querying:e.querying.filter((e=>e!==t.queryId)),errors:{...e.errors,[t.queryId]:t.error}};default:return e}}});(0,k.register)($n);const Zn=$n;var jn=r(25703);const Kn="ithemes-security/users",Jn="/wp/v2/users",Xn="/ithemes-security/v1/user-actions";function*zn(e,t={}){let r,s;yield{type:mi,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)(Jn,t),parse:!1}),s=yield Z(r)}catch(r){return yield{type:Si,queryId:e,queryParams:t,error:r},r}return yield ni(e,t.context||"view",r,s,"replace"),yield{type:Ii,queryId:e,queryParams:t,response:r},r}function*ei(e){const t=yield Y(Kn,"getQueryParams",e);yield*zn(e,t)}function*ti(e,t="append"){return yield*si(e,"prev",t)}function*ri(e,t="append"){return yield*si(e,"next",t)}function*si(e,t,r){const s=yield Y(Kn,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:mi,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield Z(n)}catch(t){return yield{type:Si,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield ni(e,u,n,i,r),yield{type:Ii,queryId:e,response:n},n}function ni(e,t,r,s,n){return{type:pi,queryId:e,context:t,response:r,items:s,mode:n}}function ii(e){return{type:Ti,user:e}}function*ui(e,t,r){const s=yield Y(Kn,"getQueryParams",e),n=e;yield{type:_i,id:n};try{const e=yield M({path:Xn,method:"POST",data:{query:s,mode:t,actions:r}});return yield{type:hi,id:n},yield{type:Pi},yield{type:Qi},yield li(),e}catch(e){return yield{type:qi,id:n,error:e},e}}function*oi(e,t,r){yield{type:_i,id:r};try{const s=yield M({path:Xn,method:"POST",data:{users:e,actions:t}});return yield{type:hi,id:r},yield{type:Pi},yield{type:Qi},yield li(),s}catch(e){return yield{type:qi,id:r,error:e},e}}function li(){return k.controls.dispatch(jn.store,"createNotice","info",(0,ot.__)("Quick edits are being applied in the background. This may take a few moments.","better-wp-security"),{id:"user_security_quick_edits_success",type:"snackbar",context:"ithemes-security"})}function*ci(e){switch(e){case"all":yield k.controls.dispatch(jn.store,"createNotice","info",(0,ot.__)("All users from the query are selected","better-wp-security"),{id:"user_security_all_selected",type:"snackbar",context:"ithemes-security"});break;case"window":yield k.controls.dispatch(jn.store,"createNotice","info",(0,ot.__)("Only the current page of users from the query are selected","better-wp-security"),{id:"user_security_page_selected",type:"snackbar",context:"ithemes-security"});break;case"none":yield k.controls.dispatch(jn.store,"createNotice","info",(0,ot.__)("None of the users from the query are selected","better-wp-security"),{id:"user_security_none_selected",type:"snackbar",context:"ithemes-security"}),yield{type:Qi}}yield{type:Ai,userSelectionType:e}}function ai(){return{type:Ri}}function yi(e){return{type:vi,user:e}}function di(){return{type:Qi}}function fi(){return{type:bi}}function gi(){return{type:Pi}}function Ei(){return{type:Ni}}const pi="RECEIVE_QUERY",mi="START_QUERY",Ii="FINISH_QUERY",Si="FAILED_QUERY",_i="START_ACTION",hi="FINISH_ACTION",qi="FAILED_ACTION",Ti="RECEIVE_USER",Ai="UPDATE_SELECTION_TYPE",vi="TOGGLE_SELECTED_USER",Ri="TOGGLE_SELECT_ALL",bi="OPEN_QUICK_EDIT",Pi="CLOSE_QUICK_EDIT",Ni="CONFIRM_QUICK_EDIT",Qi="REMOVE_SELECTED_USERS",xi=(0,k.createRegistrySelector)((e=>()=>e(Kn).getQueryResults("main"))),Li=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function Ui(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Ci(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Di(e,t){return!!Ui(e,t,"prev")}function Fi(e,t){return!!Ui(e,t,"next")}function Oi(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function ki(e,t){return(0,w.get)(e,["queryParams",t])}function wi(e,t){return e.bySelf[t]?.item}function Hi(e,t){return wi(e,e.selfById[t])}function Vi(e){return e.userSelection}function Bi(e,t){return e.actions.includes(t)}function Mi(e,t){return e.actionErrors[t]}function Gi(e){return e.selectedUsers}function Yi(e){const t=Li(e,"main");return e.selectedUsers.length===t.length?"checked":e.selectedUsers.length>0?"indeterminate":"unchecked"}function Wi(e,t){return e.querying.includes(t)}function $i(e,t){return e.selectedUsers.includes(t)}function Zi(e){return e.quickEditState}function ji(e){return e.actions}function*Ki(){yield W(Kn,"query","main",{per_page:20,context:"edit",roles:["administrator"]})}function*Ji(e){const t=yield M({path:`${Jn}/${e}?context=edit`});return yield ii(t),t}const Xi={bySelf:{},selfById:{},userSelection:"window",queries:{},queryParams:{},querying:[],actions:[],actionErrors:{},selectedUsers:[],quickEditState:!1},zi=(0,k.createReduxStore)(Kn,{actions:A,selectors:v,resolvers:R,controls:ee,reducer:function(e=Xi,t){switch(t.type){case pi:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.AW):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.AW)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.AW)(e)])))},selectedUsers:"main"===t.queryId?[]:e.selectedUsers};case mi:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case Ii:case Si:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Ti:return{...e,bySelf:{...e.bySelf,[(0,B.AW)(t.user)]:{context:"edit",item:t.user}},selfById:{...e.selfById,[t.user.id]:(0,B.AW)(t.user)}};case Ai:return{...e,userSelection:t.userSelectionType};case Ri:const r=Li(e,"main");return e.selectedUsers.length===r.length?{...e,selectedUsers:[]}:{...e,selectedUsers:r.map((e=>e.id))};case vi:return e.selectedUsers.includes(t.user.id)?{...e,selectedUsers:e.selectedUsers.filter((e=>e!==t.user.id)),userSelection:"all"}:{...e,selectedUsers:[...e.selectedUsers,t.user.id],userSelection:"window"};case Qi:return{...e,selectedUsers:[],userSelection:"none"};case bi:return{...e,quickEditState:!0};case Pi:return{...e,quickEditState:!1};case Ni:return{...e,quickEditState:"confirm"};case _i:return{...e,actions:[...e.actions,t.id],actionErrors:(0,w.omit)(e.actionErrors,t.id)};case hi:return{...e,actions:e.actions.filter((e=>e!==t.id))};case qi:return{...e,actions:e.actions.filter((e=>e!==t.id)),actionErrors:{...e.actionErrors,[t.id]:t.error}};default:return e}}});(0,k.register)(zi);const eu=zi,tu="ithemes-security/firewall",ru="/ithemes-security/v1/firewall/rules",su=(e,t={})=>async({dispatch:r})=>{let s,n;r({type:mu,queryId:e,queryParams:t});try{s=await V()({path:(0,te.addQueryArgs)(ru,t),parse:!1}),n=await s.json()}catch(s){return r({type:Su,queryId:e,queryParams:t,error:s}),s}return r(gu(e,t.context||"view",s,n,"replace")),r({type:Iu,queryId:e,queryParams:t,response:s}),n},nu=e=>async({select:t,dispatch:r})=>{const s=t.getQueryParams(e);r.query(e,s)},iu=(e,t="append")=>(...r)=>ou(e,"prev",t)(...r),uu=(e,t="append")=>(...r)=>ou(e,"next",t)(...r),ou=(e,t,r)=>async({select:s,dispatch:n})=>{const i=s.getQueryHeaderLink(e,t);if(!i)return[];let u,o;n({type:mu,queryId:e});try{u=await V()({url:i.link,parse:!1}),o=await u.json()}catch(t){return n({type:Su,queryId:e,error:t}),t}const l=(0,te.getQueryArg)(i.link,"context")||"view";return n(gu(e,l,u,o,r)),n({type:Iu,queryId:e,response:u}),u},lu=(e,t)=>async({select:r,dispatch:s})=>{const n=r.getItem(e),i=r.getEditedItem(e);(0,w.isEqual)(n,{...i,...t})?s({type:"RESET_EDITS",self:e}):s({type:"EDIT_ITEM",self:e,edit:t})};function cu(e){return{type:"RESET_EDITS",self:e}}function au(){return{type:"RESET_ALL_EDITS"}}const yu=e=>async({select:t,dispatch:r})=>{const s=t.getEditedItem(e);if(!s||!t.isDirty(e))return s;const n=await r.saveItem(s);return r(cu(e)),n},du=e=>async({dispatch:t})=>{const r=(0,B.AW)(e);r&&t({type:"START_SAVING",self:r});try{const s=await V()({url:r,path:!r&&ru,method:r?"PUT":"POST",data:e});return t({type:"RECEIVE_ITEM",item:s}),r&&t({type:"FINISH_SAVING",self:r}),s}catch(e){throw r&&t({type:"FAILED_SAVING",self:r,error:e}),e}},fu=e=>async({dispatch:t})=>{t({type:"START_DELETING",self:e});try{await V()({url:e,method:"DELETE"}),t({type:"FINISH_DELETING",self:e})}catch(r){t({type:"FAILED_DELETING",self:e,error:r})}};function gu(e,t,r,s,n){return{type:Eu,queryId:e,context:t,response:r,items:s,mode:n}}const Eu="RECEIVE_QUERY",pu="RECEIVE_ITEM",mu="START_QUERY",Iu="FINISH_QUERY",Su="FAILED_QUERY",_u=(0,k.createRegistrySelector)((e=>()=>e(tu).getQueryResults("main"))),hu=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["query","queries",t,"selves"],[]),s=e.query.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.query.queries[t],e.query.bySelf]));function qu(e,t,r){return(0,w.find)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Tu(e,t,r){return(0,w.filter)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Au(e,t){return!!qu(e,t,"prev")}function vu(e,t){return!!qu(e,t,"next")}function Ru(e,t,r){return(0,w.get)(e,["query","queries",t,"headers",r])}function bu(e,t){return(0,w.get)(e,["query","queryParams",t])}function Pu(e,t){return e.query.bySelf[t]?.item}function Nu(e,t){return Pu(e,e.query.selfById[t])}function Qu(e,t){return e.query.querying.includes(t)}const xu=(0,Ce.Z)(((e,t)=>e.query.bySelf[t]?.item&&{...e.query.bySelf[t].item,...e.edits.bySelf[t]||{}}),((e,t)=>[e.edits.bySelf[t],e.query.bySelf[t]]));function Lu(e,t){return void 0!==e.edits.bySelf[t]}function Uu(e,t){const r="string"==typeof t?t:(0,B.AW)(t);return e.saving.selves.includes(r)}function Cu(e,t){const r="string"==typeof t?t:(0,B.AW)(t);return e.deleting.selves.includes(r)}function Du(e,t){const r="string"==typeof t?t:(0,B.AW)(t);return e.saving.errors[r]}function Fu(e,t){const r="string"==typeof t?t:(0,B.AW)(t);return e.deleting.errors[r]}const Ou=()=>async({dispatch:e})=>{await e.query("main",{per_page:100,paused:"false"})},ku={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await V()({url:(0,te.addQueryArgs)(e,{context:"edit"})})})},isFulfilled:(e,t)=>"edit"===e.query.bySelf[t]?.context},wu={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await V()({path:`${ru}/${e}?context=edit`})})},isFulfilled:(e,t)=>!!e.query.selfById[t]},Hu={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},Vu={bySelf:{}},Bu={selves:[],errors:{}},Mu=(0,k.combineReducers)({query:function(e=Hu,t){switch(t.type){case Eu:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.AW):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.AW)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.AW)(e)])))}};case mu:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case Iu:case Su:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case pu:return{...e,bySelf:{...e.bySelf,[(0,B.AW)(t.item)]:{context:"edit",item:t.item}},selfById:{...e.selfById,[t.item.id]:(0,B.AW)(t.item)}};case"FINISH_DELETING":return{...e,bySelf:(0,w.omit)(e.bySelf,t.self),selfById:(0,w.omitBy)(e.selfById,(e=>e===t.self))};default:return e}},edits:function(e=Vu,t){switch(t.type){case"EDIT_ITEM":return{...e,bySelf:{...e.bySelf,[t.self]:{...e.bySelf[t.self]||{},...t.edit}}};case"RESET_EDITS":case"FINISH_DELETING":return{...e,bySelf:(0,w.omit)(e.bySelf,t.self)};case"RESET_ALL_EDITS":return{...e,bySelf:{}};default:return e}},saving:function(e=Bu,t){switch(t.type){case"START_SAVING":return{...e,selves:[...e.selves,t.self],errors:(0,w.omit)(e.errors,t.self)};case"FINISH_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}},deleting:function(e=Bu,t){switch(t.type){case"START_DELETING":return{...e,selves:[...e.selves,t.self],errors:(0,w.omit)(e.errors,t.self)};case"FINISH_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}}}),Gu=(0,k.createReduxStore)(tu,{actions:b,selectors:P,resolvers:N,reducer:Mu,controls:ee});(0,k.register)(Gu);const Yu=Gu,Wu="ithemes-security/logs",$u="/ithemes-security/v1/logs";function*Zu(e,t={}){let r,s;yield{type:ro,queryId:e,queryParams:t};try{r=yield M({path:(0,te.addQueryArgs)($u,t),parse:!1}),s=yield Z(r)}catch(r){return yield{type:no,queryId:e,queryParams:t,error:r},r}return yield zu(e,t.context||"view",r,s,"replace"),yield{type:so,queryId:e,queryParams:t,response:r},s}function*ju(e){const t=yield Y(Wu,"getQueryParams",e);yield*Zu(e,t)}function*Ku(e,t="append"){return yield*Xu(e,"prev",t)}function*Ju(e,t="append"){return yield*Xu(e,"next",t)}function*Xu(e,t,r){const s=yield Y(Wu,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:ro,queryId:e};try{n=yield M({url:s.link,parse:!1}),i=yield Z(n)}catch(t){return yield{type:no,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield zu(e,u,n,i,r),yield{type:so,queryId:e,response:n},n}function zu(e,t,r,s,n){return{type:to,queryId:e,context:t,response:r,items:s,mode:n}}function eo(e){return{type:io,log:e}}const to="RECEIVE_QUERY",ro="START_QUERY",so="FINISH_QUERY",no="FAILED_QUERY",io="RECEIVE_LOG",uo=(0,k.createRegistrySelector)((e=>()=>e(Wu).getQueryResults("main"))),oo=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e?.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e?.queries[t],e?.bySelf]));function lo(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function co(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function ao(e,t){return!!lo(e,t,"prev")}function yo(e,t){return!!lo(e,t,"next")}function fo(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function go(e,t){return(0,w.get)(e,["queryParams",t])}function Eo(e,t){return e.querying.includes(t)}function po(e,t){return e.bySelf[t]?.item}function mo(e,t){return po(e,e.selfById[t])}function*Io(){yield W(Wu,"query","main",{per_page:100})}function*So(e){const t=yield M({path:`${$u}/${e}`});return yield eo(e),t}const _o={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},ho=(0,k.createReduxStore)(Wu,{actions:Q,selectors:x,resolvers:L,controls:ee,reducer:function(e=_o,t){switch(t.type){case to:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.AW):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.AW)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.AW)(e)])))}};case ro:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case so:case no:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case io:return{...e,bySelf:{...e.bySelf,[(0,B.AW)(t.log)]:{context:"edit",item:t.log}},selfById:{...e.selfById,[t.log.id]:(0,B.AW)(t.log)}};default:return e}}});(0,k.register)(ho);const qo=ho,To="/ithemes-security/v1/trusted-devices",Ao=(e,t,r={})=>async({dispatch:s})=>{let n,i;s({type:ko,queryId:e,userId:t,queryParams:r});try{n=await V()({path:(0,te.addQueryArgs)(To+"/"+t,r),parse:!1}),i=await n.json()}catch(t){return s({type:Ho,queryId:e,queryParams:r,error:t}),t}return s(Do(e,r.context||"view",n,i,"replace")),s({type:wo,queryId:e,queryParams:r,response:n}),i},vo=e=>async({select:t,dispatch:r})=>{const s=t.getQueryUser(e),n=t.getQueryParams(e);r.query(e,s,n)},Ro=(e,t="append")=>(...r)=>Po(e,"prev",t)(...r),bo=(e,t="append")=>(...r)=>Po(e,"next",t)(...r),Po=(e,t,r)=>async({select:s,dispatch:n})=>{const i=s.getQueryHeaderLink(e,t);if(!i)return[];let u,o;n({type:ko,queryId:e});try{u=await V()({url:i.link,parse:!1}),o=await u.json()}catch(t){return n({type:Ho,queryId:e,error:t}),t}const l=(0,te.getQueryArg)(i.link,"context")||"view";return n(Do(e,l,u,o,r)),n({type:wo,queryId:e,response:u}),u},No=(e,t)=>async({select:r,dispatch:s})=>{const n=r.getItem(e),i=r.getEditedItem(e);(0,w.isEqual)(n,{...i,...t})?s({type:"RESET_EDITS",self:e}):s({type:"EDIT_ITEM",self:e,edit:t})};function Qo(e){return{type:"RESET_EDITS",self:e}}function xo(){return{type:"RESET_ALL_EDITS"}}const Lo=e=>async({select:t,dispatch:r})=>{const s=t.getEditedItem(e);if(!s||!t.isDirty(e))return s;const n=await r.saveItem(s);return r(Qo(e)),n},Uo=(e=!0)=>async({dispatch:t,registry:r,select:s})=>{!0===e&&(e=s.getDirtyItems());const n=e.map((e=>({method:"PUT",path:(0,B.YS)(e),body:s.getEditedItem(e)})));e.forEach((e=>t({type:"START_SAVING",self:e})));const i=await async function(e,t){const r=await e.resolveSelect(Gt).getBatchMaxItems(),s=(0,w.chunk)(t,r||25),n=[];if(!s.length)return[];for(const e of s)try{const t=await V()({path:"/batch/v1",method:"POST",data:{requests:e}});n.push(...t.responses)}catch(t){n.push(...(0,w.times)(e.length,(0,w.constant)({body:t,status:500,headers:{}})))}return n}(r,n);for(let r=0;r<n.length;r++){const s=e[r],n=i[r];n.status>=400?t({type:"FAILED_SAVING",self:s,error:n.body}):(t({type:"FINISH_SAVING",self:s}),t({type:Oo,item:n.body}))}return i},Co=e=>async({dispatch:t})=>{const r=(0,B.AW)(e);r&&t({type:"START_SAVING",self:r});try{const s=await V()({url:r,path:!r&&To,method:r?"PUT":"POST",data:e});return t({type:"RECEIVE_ITEM",item:s}),r&&t({type:"FINISH_SAVING",self:r}),s}catch(e){throw r&&t({type:"FAILED_SAVING",self:r,error:e}),e}};function Do(e,t,r,s,n){return{type:Fo,queryId:e,context:t,response:r,items:s,mode:n}}const Fo="RECEIVE_QUERY",Oo="RECEIVE_ITEM",ko="START_QUERY",wo="FINISH_QUERY",Ho="FAILED_QUERY",Vo=(0,Ce.Z)(((e,t)=>{const r=(0,w.get)(e,["query","queries",t,"selves"],[]),s=e.query.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.query.queries[t],e.query.bySelf]));function Bo(e,t,r){return(0,w.find)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Mo(e,t,r){return(0,w.filter)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Go(e,t){return!!Bo(e,t,"prev")}function Yo(e,t){return!!Bo(e,t,"next")}function Wo(e,t,r){return(0,w.get)(e,["query","queries",t,"headers",r])}function $o(e,t){return(0,w.get)(e,["query","queryParams",t])}function Zo(e,t){return(0,w.get)(e,["query","users",t])}function jo(e,t){return e.query.bySelf[t]?.item}function Ko(e,t){return jo(e,e.query.selfById[t])}function Jo(e,t){return e.query.querying.includes(t)}const Xo=(0,Ce.Z)(((e,t)=>e.query.bySelf[t]?.item&&{...e.query.bySelf[t].item,...e.edits.bySelf[t]||{}}),((e,t)=>[e.edits.bySelf[t],e.query.bySelf[t]])),zo=(0,Ce.Z)((e=>(0,w.reduce)(e.edits.bySelf,((e,t,r)=>((0,w.isEmpty)(t)||e.push(r),e)),[])),(e=>[e.edits]));function el(e,t){return void 0!==e.edits.bySelf[t]}function tl(e,t){const r="string"==typeof t?t:(0,B.AW)(t);return e.saving.selves.includes(r)}function rl(e){return e.saving.selves.length>0}function sl(e,t){const r="string"==typeof t?t:(0,B.AW)(t);return e.saving.errors[r]}const nl={bySelf:{},selfById:{},queries:{},queryParams:{},users:{},querying:[]},il={bySelf:{}},ul={selves:[],errors:{}},ol=(0,k.combineReducers)({query:function(e=nl,t){switch(t.type){case Fo:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.AW):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.AW)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,We.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.AW)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.AW)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.AW)(e)])))}};case ko:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]},users:{...e.users,[t.queryId]:t.userId}};case wo:case Ho:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Oo:return{...e,bySelf:{...e.bySelf,[(0,B.AW)(t.item)]:{context:"edit",item:t.item}},selfById:{...e.selfById,[t.item.id]:(0,B.AW)(t.item)}};default:return e}},edits:function(e=il,t){switch(t.type){case"EDIT_ITEM":return{...e,bySelf:{...e.bySelf,[t.self]:{...e.bySelf[t.self]||{},...t.edit}}};case"RESET_EDITS":return{...e,bySelf:(0,w.omit)(e.bySelf,t.self)};case"RESET_ALL_EDITS":return{...e,bySelf:{}};default:return e}},saving:function(e=ul,t){switch(t.type){case"START_SAVING":return{...e,selves:[...e.selves,t.self],errors:(0,w.omit)(e.errors,t.self)};case"FINISH_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}}}),ll=(0,k.createReduxStore)("ithemes-security/trusted-devices",{actions:U,selectors:C,reducer:ol,controls:ee});(0,k.register)(ll);const cl=ll,al=(0,Ce.Z)(((e,t)=>e.users.optimisticEdits[t]?(0,w.merge)((0,w.cloneDeep)(e.users.byId[t]),e.users.optimisticEdits[t]):e.users.byId[t]),((e,t)=>[e.users.byId[t],e.users.optimisticEdits[t]]));function yl(e){return al(e,dl(e))}function dl(e){return e.users.currentId}function fl(e,t){return e.users.saving.includes(t)}function gl(e){return fl(e,e.users.currentId)}function El(e){return e.index}function pl(e,t){const r=e.index;return r?(0,w.find)(r.routes,(e=>e?.schema?.title===t))?.schema:null}function ml(e){return e.index?.roles||null}function Il(e){return e.index?.requirements_info||null}function Sl(e){return e.actors.types}function _l(e,t){return e.actors.byType[t]}function hl(e){return e.siteInfo}const ql=(0,k.createRegistrySelector)((e=>t=>e(lt).getSetting("feature-flags","enabled")||t.featureFlags));function Tl(e){return e.batchMaxItems}function Al(e){return e.index?.server_type||null}function vl(e){return e.index?.install_type||null}function Rl(e){return e.index?.has_patchstack||null}function bl(e){return e.index?.is_lw_customer||null}function*Pl(e=!1){let t="/ithemes-security/v1?context=help";e&&(t+="&_="+Date.now());const r=yield M({path:t});return yield Nl(r),r}function Nl(e){return{type:Hl,index:e}}function*Ql(e,t=!1){yield*xl("me",e,t)}function*xl(e,t,r=!1){const s=yield Y("ithemes-security/core","getCurrentUserId");"me"===e&&(e=s);const n=`/wp/v2/users/${e===s?"me":e}`;yield{type:"START_SAVING_USER",id:e,data:t,optimistic:r};try{const r=yield M({method:"PUT",path:n,data:t});yield Ul(r),yield{type:"FINISH_SAVING_USER",id:e,user:r}}catch(t){yield{type:"FAILED_SAVING_USER",id:e,error:t}}}function*Ll(e){const t=yield Y("ithemes-security/core","getCurrentUserId"),r=yield M({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Ul(r)}function Ul(e){return{type:Vl,user:e}}function Cl(e){return{type:Bl,userId:e}}function Dl(e){return{type:Ml,types:e}}function Fl(e,t){return{type:Gl,actorType:e,actors:t}}function Ol(e){return{type:Yl,siteInfo:e}}function kl(e){return{type:Wl,flags:e}}function wl(e){return{type:$l,maxItems:e}}const Hl="RECEIVE_INDEX",Vl="RECEIVE_USER",Bl="RECEIVE_CURRENT_USER_ID",Ml="RECEIVE_ACTOR_TYPES",Gl="RECEIVE_ACTORS",Yl="RECEIVE_SITE_INFO",Wl="LOAD_INITIAL_FEATURE_FLAGS",$l="RECEIVE_BATCH_MAX_ITEMS";function*Zl(){const e=yield M({path:"/ithemes-security/v1?context=help"});yield Nl(e)}const jl=()=>({resolveSelect:e})=>e.getIndex(),Kl=()=>({resolveSelect:e})=>e.getIndex(),Jl=()=>({resolveSelect:e})=>e.getIndex(),Xl=()=>({resolveSelect:e})=>e.getIndex(),zl=()=>({resolveSelect:e})=>e.getIndex(),ec=()=>({resolveSelect:e})=>e.getIndex(),tc=()=>({resolveSelect:e})=>e.getIndex(),rc={*fulfill(e){const t=yield k.controls.select("ithemes-security/core","getCurrentUserId"),r=yield M({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Ul(r)},isFulfilled:(e,t)=>!!e.users.byId[t]},sc={*fulfill(){const e=yield M({path:"/wp/v2/users/me?context=edit"});yield Ul(e),yield Cl(e.id)},isFulfilled:e=>e.users.currentId&&e.users.byId[e.users.currentId]},nc={*fulfill(){const e=yield M({path:"/ithemes-security/v1/actors?_embed=1"}),t=[];for(const r of e){const e=(0,w.get)(r,["_embedded","wp:items",0],[]);yield Fl(r.slug,e),t.push({slug:r.slug,label:r.label})}yield Dl(t)},isFulfilled:e=>e.actors.types.length>0},ic={*fulfill(){yield k.controls.select("ithemes-security/core","getActorTypes")},isFulfilled:(e,t)=>!!e.actors.byType[t]},uc={*fulfill(){const e=yield M({path:"/?_fields=name,description,url,home,multisite"});yield Ol(e)},isFulfilled:e=>!!e.siteInfo};function*oc(){const e=yield M({path:"/batch/v1",method:"OPTIONS"});yield wl(e.endpoints[0].args.requests.maxItems)}const lc={users:{currentId:0,byId:{},saving:[],optimisticEdits:{}},index:null,actors:{types:[],byType:{}},siteInfo:null,featureFlags:[],batchMaxItems:0};r.p=window.itsecWebpackPublicPath;const cc=(0,k.createReduxStore)(Gt,{controls:ee,selectors:D,resolvers:O,actions:F,reducer:function(e=lc,t){switch(t.type){case Hl:return{...e,index:t.index};case"START_SAVING_USER":return{...e,users:{...e.users,saving:[...e.users.saving,t.id],optimisticEdits:t.optimistic?{...e.users.optimisticEdits,[t.id]:t.data}:e.users.optimisticEdits}};case"FINISH_SAVING_USER":case"FAILED_SAVING_USER":return{...e,users:{...e.users,saving:e.users.saving.filter((e=>e!==t.id)),optimisticEdits:(0,w.omit)(e.users.optimisticEdits,t.id)}};case Vl:return{...e,users:{...e.users,byId:{...e.users.byId,[t.user.id]:t.user}}};case Bl:return{...e,users:{...e.users,currentId:t.userId}};case Ml:return{...e,actors:{...e.actors,types:t.types}};case Gl:return{...e,actors:{...e.actors,byType:{...e.actors.byType,[t.actorType]:t.actors}}};case Yl:return{...e,siteInfo:t.siteInfo};case Wl:return{...e,featureFlags:t.flags};case $l:return{...e,batchMaxItems:t.maxItems};default:return e}}});(0,k.register)(cc)},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},48015:e=>{e.exports=function(){return this.wp.data}()},6293:e=>{e.exports=function(){return this.wp.element}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},25703:e=>{e.exports=function(){return this.wp.notices}()},73470:e=>{e.exports=function(){return this.wp.url}()},92819:e=>{"use strict";e.exports=window.lodash}},e=>{e.O(0,[5307,761,1511],(()=>(19169,e(e.s=19169))));var t=e.O();((window.itsec=window.itsec||{}).packages=window.itsec.packages||{}).data=t}]);