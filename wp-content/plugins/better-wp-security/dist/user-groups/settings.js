(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[8913],{63668:(e,t,r)=>{"use strict";r.r(t);var n=r(6293),a=r(95122),s=r(3571),o=(r(25703),r(31600)),i=r(87375),l=r(7980),c=r(64893);function u({groupId:e,disabled:t}){return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(p,{groupId:e,disabled:t}),(0,n.createElement)(le,{groupId:e,disabled:t}),(0,n.createElement)(he,{groupId:e,disabled:t}))}var d=r(48015),m=r(62470);function p({groupId:e,disabled:t=!1}){const{label:r}=(0,d.useSelect)((t=>({label:t(m.store).getEditedGroupAttribute(e,"label")||""})),[e]),{editGroup:s}=(0,d.useDispatch)(m.store);return(0,n.createElement)(c.TextControl,{label:(0,a.__)("Group Name","better-wp-security"),value:r,maxLength:50,disabled:t,onChange:t=>s(e,{label:t}),__nextHasNoMarginBottom:!0})}var g=r(52117),h=r(73727),f=r(16550),b=r(95117),E=r(71930),v=r(65813);const y=(0,g.Z)(E.Rx,{target:"e1arn7d30"})({name:"syl0ps",styles:"padding:.5rem 1.5rem 1rem;align-items:center;flex-wrap:wrap"});function _(){const{navIds:e}=(0,d.useSelect)((e=>({navIds:e(m.store).getMatchableNavIds()})),[]),{createLocalGroup:t}=(0,d.useDispatch)(m.store),r=(0,l.useNavigateTo)(),{root:s}=(0,f.UO)();return e?(0,n.createElement)(y,{orientation:"horizontal"},e.map((e=>(0,n.createElement)(x,{key:e,groupId:e,root:s}))),(0,n.createElement)(E.zx,{variant:"tertiary",icon:b.Z,label:(0,a.__)("Create User Group","better-wp-security"),onClick:async()=>{const{id:e}=await t();r(`/${s}/user-groups/${e}`)}})):null}function x({groupId:e,root:t}){const{label:r}=(0,d.useSelect)((t=>({label:t(m.store).getEditedMatchableLabel(e)})),[e]);return(0,n.createElement)(h.OL,{to:`/${t}/user-groups/${e}`,component:(0,v.Sj)(E.Ig)},r||(0,a.__)("Untitled","better-wp-security"))}var I=r(1986);const L=(0,g.Z)("div",{target:"eepkdnm0"})({name:"s9thde",styles:"max-width:830px;width:100%;flex-grow:1"});function C({module:e,children:t}){return(0,n.createElement)(L,null,(0,n.createElement)(we,null,(0,n.createElement)(E.mr,{title:(0,a.__)("Imported User Groups","better-wp-security"),description:(0,a.__)("Click any user group to edit its features or its members before importing.","better-wp-security")})),(0,n.createElement)(l.OnboardHeader,{title:e.title,description:(0,n.createElement)(I.Lu,{content:e.help,noWrap:!0}),showNext:!0,showIndicator:!0}),t)}var w=r(42236);const N=(0,g.Z)(E.Tg,{target:"e1dr2qeg0"})("border:1px solid ",(({theme:e})=>e.colors.border.normal),";");function S(){const{url:e,path:t,params:{root:r}}=(0,f.$B)(),{hash:a,search:s}=(0,f.TH)(),{navIds:i,module:l}=(0,d.useSelect)((e=>({navIds:e(m.store).getMatchableNavIds(),module:e(o.MODULES_STORE_NAME).getModule("user-groups")})),[]);return null!==i&&l?(0,n.createElement)(f.rs,null,(0,n.createElement)(f.AW,{path:`${t}/multi`},(0,n.createElement)(k,{module:l})),(0,n.createElement)(f.AW,{path:`${t}/:groupId`},(0,n.createElement)(O,{module:l,root:r})),(0,n.createElement)(f.AW,{path:t},"onboard"===r&&(0,n.createElement)(ee,null),"onboard"!==r&&i.length>0&&(0,n.createElement)(f.l_,{to:`${e}/${i[0]}/${s}${a}`}))):null}function O({module:e,root:t}){const{groupId:r}=(0,f.UO)();return(0,n.createElement)(D,{root:t,module:e,groupId:r},(0,n.createElement)(N,null,(0,n.createElement)(Ce,null),(0,n.createElement)(_,null),(0,n.createElement)(M,{groupId:r})),(0,n.createElement)(be,{groupId:r}))}function k({module:e}){const[t]=(0,w.Wd)("back",w.Zp),[r,s]=(0,w.Wd)("id",(0,w.Wc)(w.V3,[]));return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(N,null,(0,n.createElement)(E.mr,{title:(0,a.__)("User Groups","better-wp-security"),description:(0,n.createElement)(I.Lu,{content:e.help,noWrap:!0})},(0,n.createElement)(h.rU,{to:t?`/settings/user-groups/${t}`:"/settings/user-groups",component:(0,v.Sj)(E.xv),as:"a",decoration:"none",variant:E.rK.MUTED,text:(0,a.__)("Cancel Group Edit","better-wp-security")})),(0,n.createElement)(U,{selected:r,setSelected:s}),(0,n.createElement)(T,{groupIds:r})),(0,n.createElement)(ve,{groupIds:r}))}function D({root:e,module:t,groupId:r,children:s}){const o=(0,n.useMemo)((()=>({groupId:r})),[r]);return"onboard"===e?(0,n.createElement)(re,{module:t},s):"import"===e?(0,n.createElement)(C,{module:t},s):(0,n.createElement)(React.Fragment,null,(0,n.createElement)(we,null,(0,n.createElement)(E.mr,{title:(0,a.__)("User Groups","better-wp-security"),description:(0,n.createElement)(I.Lu,{content:t.help,noWrap:!0})},(0,n.createElement)(Ie,{fillProps:o}))),s)}var A=r(92819);const F=(0,g.Z)(E.x4,{target:"ecsk30z1"})({name:"1nzdh6",styles:".components-tab-panel__tabs{padding:0 1.5rem;}.components-tab-panel__tab-content{padding:1rem 1.5rem;}"}),Z=(0,g.Z)(I.KM,{target:"ecsk30z0"})({name:"8dk3vg",styles:"margin-bottom:1rem"});function M({groupId:e}){const{root:t}=(0,f.UO)(),{hash:r}=(0,f.TH)(),{type:s,isSaving:o,notFound:l,error:u}=(0,d.useSelect)((t=>({type:t(m.store).getMatchableType(e),error:t(m.store).getError(e),isSaving:t(m.store).isSavingGroupOrSettings(e),notFound:t(i.store).isGroupNotFound(e)})),[e]),p=(0,n.useMemo)((()=>[{name:"settings",title:(0,a.__)("Features","better-wp-security"),Component:_e},"user-group"===s&&{name:"edit",title:(0,a.__)("Edit Group","better-wp-security"),Component:ye}].filter(A.isPlainObject)),[s]);return l?(0,n.createElement)(f.l_,{to:`/${t}/user-groups`}):(0,n.createElement)(c.Disabled,{isDisabled:o},(0,n.createElement)(F,{tabs:p},(({Component:t})=>(0,n.createElement)(t,{groupId:e,highlight:r.substring(1)},(0,n.createElement)(Z,{apiError:u})))))}function T({groupIds:e}){const{errors:t}=(0,d.useSelect)((e=>({errors:e(m.store).getBulkErrorsList()})),[]),r=(0,n.useMemo)((()=>[{name:"settings",title:(0,a.__)("Features","better-wp-security"),Component:xe}]),[]);return(0,n.createElement)(F,{tabs:r,isStyled:!0},(({Component:r})=>(0,n.createElement)(r,{groupIds:e},(0,n.createElement)(Z,{errors:t}))))}var R=r(27231);const P=(0,g.Z)("fieldset",{target:"e1xp77ue3"})({name:"1i6y9la",styles:"display:flex;flex-wrap:wrap;align-items:center;padding:.5rem 1.5rem 1rem;gap:0.75rem"}),j=(0,g.Z)(E.Tg,{target:"e1xp77ue2"})({name:"adif5y",styles:"position:relative;display:inline;border-radius:1.5rem"}),G=(0,g.Z)("input",{target:"e1xp77ue1"})({name:"1ouiv6l",styles:"opacity:0;position:absolute;width:100%;height:100%"}),$=(0,g.Z)(E.xv,{target:"e1xp77ue0"})({name:"1nx3mrv",styles:"padding:0.75rem 1.25rem 0.75rem 0.75rem"});function U({selected:e,setSelected:t}){const{matchables:r}=(0,d.useSelect)((e=>({matchables:e(i.store).getMatchables()||[]})),[]);return(0,n.createElement)("div",{className:"itsec-user-groups-multi-group-selector"},(0,n.createElement)(P,null,(0,n.createElement)(c.VisuallyHidden,{as:"legend"},(0,a.__)("User Groups","better-wp-security")),r.map((r=>(0,n.createElement)(B,{key:r.id,id:r.id,selected:e,setSelected:t})))))}function B({id:e,selected:t,setSelected:r}){const{label:a}=(0,d.useSelect)((t=>({label:t(m.store).getEditedMatchableLabel(e)})),[e]),s=t.includes(e);return(0,n.createElement)(j,{variant:s?E.h1.SECONDARY:E.h1.PRIMARY},(0,n.createElement)(G,{type:"checkbox",checked:s,onChange:n=>(n=>{r(n?[...t,e]:(0,A.without)(t,e),"replaceIn")})(n.target.checked),id:`itsec-multi-group-selector-group-${e}`}),(0,n.createElement)($,{text:a,variant:E.rK.DARK,weight:E.fs.HEAVY,as:"label",htmlFor:`itsec-multi-group-selector-group-${e}`,icon:s?R.Z:b.Z,iconColor:!s&&"#6817C5"}))}const W=(0,g.Z)("div",{target:"e177r2jx0"})({name:"olj6q7",styles:"max-width:530px;display:flex;flex-direction:column;gap:1.75rem"}),z=(0,n.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M9 4C7.35156 4 6 5.35156 6 7V26H6.42188C6.85938 27.1094 7.74219 28 9 28H26V26H9C8.4375 26 8 25.5625 8 25C8 24.4375 8.4375 24 9 24H26V4H9ZM9 6H24V22H9C8.64844 22 8.3125 22.0781 8 22.1875V7C8 6.4375 8.4375 6 9 6ZM10 10V12H22V10H10Z",fill:"#9675F7"})),H=(0,n.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{d:"M22 2C17.5938 2 14 5.59375 14 10C14 10.7109 14.1875 11.3516 14.3594 11.9844L13.875 12.4688L10 8.58594V5.44531L9.53125 5.15625L4.85938 2.23438L2.23438 4.8125L5.4375 10H8.58594L12.4687 13.875L5.17188 21.1719C3.61719 22.7266 3.61719 25.2734 5.17188 26.8281C6.72656 28.3828 9.27344 28.3828 10.8281 26.8281L16 21.6562L21.1719 26.8281C22.7266 28.3828 25.2734 28.3828 26.8281 26.8281C28.3828 25.2734 28.3828 22.7266 26.8281 21.1719L23.5 17.8438C27.1953 17.1406 30 13.8906 30 10C30 8.66406 29.6406 7.42188 29.0781 6.33594L28.4453 5.125L27.4844 6.09375L23.1875 10.3828L21.6172 8.8125L26.875 3.54688L25.6641 2.92188C24.5781 2.35938 23.3359 2 22 2ZM22 4C22.4531 4 22.8438 4.21875 23.2734 4.32813L18.7891 8.8125L23.1875 13.2109L27.6797 8.72656C27.7812 9.15625 28 9.54688 28 10C28 13.3281 25.3281 16 22 16C21.3125 16 20.6562 15.8594 20 15.625L19.4062 15.4219L9.41406 25.4141C8.625 26.2031 7.375 26.2031 6.58594 25.4141C5.79688 24.625 5.79688 23.375 6.58594 22.5859L16.5781 12.5938L16.375 12C16.1406 11.3438 16 10.6875 16 10C16 6.67188 18.6719 4 22 4ZM5.14062 4.76563L8 6.55469V7.83594L7.83594 8H6.5625L4.77344 5.11719L5.14062 4.76563ZM20.0156 17.6406C20.2187 17.6953 20.4219 17.7422 20.625 17.7969L25.4141 22.5859C26.2031 23.375 26.2031 24.625 25.4141 25.4141C24.625 26.2031 23.375 26.2031 22.5859 25.4141L17.4141 20.2422L20.0156 17.6406Z",fill:"#9675F7"}));var V=r(65096),q=r.n(V),K=r(91247),Y=r(50460);function Q(){return Q.instance||(Q.instance=new(q())({schemaId:"id"}),Q.instance.addMetaSchema(r(27171))),Q.instance}function X(){const{registerCompletionStep:e}=(0,d.useDispatch)(l.ONBOARD_STORE_NAME),{saveGroups:t,saveGroupSettingsAsBatch:r}=(0,d.useDispatch)(m.store);(0,v.eH)(X,(()=>{e({id:"savingUserGroups",label:(0,a.__)("Create User Groups","better-wp-security"),priority:15,callback:()=>t()}),e({id:"savingUserGroupsSetting",label:(0,a.__)("Setup User Group Settings","better-wp-security"),priority:20,callback:()=>r()})}))}function J(){const{registerProvider:e}=(0,d.useDispatch)(Y.G);(0,v.eH)(J,(()=>{e("user-group-settings",(0,a.__)("User Group Settings","better-wp-security"),25,(({registry:e,evaluate:t,results:r})=>e.select(i.store).getSettingDefinitions(Q()).reduce(((e,n)=>(0,A.reduce)(n.settings,((e,a,s)=>{var o,i,l;return t.stringMatch(a.title)||t.stringMatch(a.description)||t.keywordMatch(a.keywords)?(null!==(l=(o=r.groups)[i=n.id])&&void 0!==l||(o[i]={title:n.title,items:[]}),r.groups[n.id].items.push({title:a.title,description:a.description,route:`/settings/user-groups?module=${n.id}#${n.id}/${s}`}),e++):e}),e)),0))),e("user-groups",(0,a.__)("User Groups","better-wp-security"),50,(({registry:e,evaluate:t,results:r})=>(e.select(m.store).getAvailableGroups()||[]).reduce(((e,n)=>t.stringMatch(n.label)?(r.items.push({title:n.label,description:n.description,route:`/settings/user-groups/${n.id}`}),e++):e),0)))}))}function ee(){const e=(0,l.useNavigateTo)(),t=function(){const{select:e,resolveSelect:t}=(0,d.useRegistry)(),{createLocalGroup:r,editGroup:n,editGroupSetting:s,createdDefaultGroups:c}=(0,d.useDispatch)(m.store);return async()=>{if(e(m.store).hasCreatedDefaultGroups())return e(m.store).getMatchableNavIds();const u={administrator:(0,a.__)("Administrators","better-wp-security"),editor:(0,a.__)("Editors","better-wp-security"),author:(0,a.__)("Authors","better-wp-security"),contributor:(0,a.__)("Contributors","better-wp-security"),subscriber:(0,a.__)("Subscribers","better-wp-security")},d=await t(o.MODULES_STORE_NAME).getEditedModules(),p=await t(i.store).getMatchables(),g=e(m.store).getLocalGroupIds(),h=e(l.ONBOARD_STORE_NAME).getAnswers(),f={administrator:[],editor:[],author:[],contributor:[],subscriber:[]};for(const t of(0,A.map)((0,A.filter)(p,{type:"user-group"}),"id").concat(g)){const r=e(m.store).getEditedGroupAttribute(t,"canonical");for(const e of r)f[e].push(t)}const b={};for(const e of h)(0,A.isPlainObject)(e.canonical_group_substitutions)&&Object.assign(b,e.canonical_group_substitutions);for(const e in u){if(!u.hasOwnProperty(e))continue;const t=f[e];if(b.hasOwnProperty(e)){if(null===b[e]&&!t.length)continue;t.push(b[e])}if(0===t.length){const a=(0,K.Z)();r(a),n(a,{label:u[e],canonical:[e]}),t.push(a)}"subscriber"===e&&t.push("everybody-else");for(const r of d)if("active"===r.status.selected)for(const n in r.user_groups){if(!r.user_groups.hasOwnProperty(n))continue;if(!r.user_groups[n].default)continue;let a=r.user_groups[n].default;if(Array.isArray(a)||(a=[a]),(0,A.intersection)(["all",e],a).length>0)for(const e of t)s(e,r.id,n,!0)}for(const r of h)if(r.user_groups_settings[e])for(const n in r.user_groups_settings[e])if(r.user_groups_settings[e].hasOwnProperty(n))for(const a of r.user_groups_settings[e][n])for(const e of t)s(e,n,a,!0)}return c(),e(m.store).getMatchableNavIds()}}(),r=function(){const{resolveSelect:e}=(0,d.useRegistry)(),{editGroupSetting:t}=(0,d.useDispatch)(m.store);return async()=>{const r=await e(o.MODULES_STORE_NAME).getEditedModules(),n=await e(m.store).getMatchableNavIds();for(const e of n)for(const n of r)if("active"===n.status.selected)for(const r in n.user_groups)n.user_groups.hasOwnProperty(r)&&"all"===n.user_groups[r].default&&t(e,n.id,r,!0)}}();return(0,n.createElement)(W,null,(0,n.createElement)(c.Flex,{as:"header",gap:2,direction:"column",expanded:!1},(0,n.createElement)(E.X6,{level:2,size:E.yH.EXTRA_LARGE,variant:E.rK.DARK,text:(0,a.__)("User Groups","better-wp-security")}),(0,n.createElement)(E.xv,{size:E.yH.SUBTITLE_SMALL,variant:E.rK.DARK,weight:E.fs.HEAVY,text:(0,a.__)("Enable or disable security features for specific groups of users.","better-wp-security")}),(0,n.createElement)(E.xv,{variant:E.rK.MUTED,text:(0,a.__)("Default user groups are the roles that already exist in WordPress, like Authors, Editors, and Administrators. Custom user groups can include any existing user or role. User groups allow you to define unique security options and requirements for each group. Create and enforce group security policies with default and custom user groups.","better-wp-security")})),(0,n.createElement)(c.Flex,{gap:12},(0,n.createElement)(l.SelectableCard,{title:(0,a.__)("Default User Groups","better-wp-security"),icon:z,direction:"vertical",onClick:async()=>{const n=await t();await r(),e(`/onboard/user-groups/${n[0]}`)}}),(0,n.createElement)(l.SelectableCard,{title:(0,a.__)("Custom User Groups","better-wp-security"),icon:H,direction:"vertical",onClick:()=>{e("/onboard/user-groups/everybody-else")}})))}const te=(0,g.Z)("div",{target:"e9m78aa0"})({name:"s9thde",styles:"max-width:830px;width:100%;flex-grow:1"});function re({module:e,children:t}){const{createdDefaultGroups:r}=(0,d.useSelect)((e=>({createdDefaultGroups:e(m.store).hasCreatedDefaultGroups()})),[]);return(0,n.createElement)(te,null,(0,n.createElement)(we,null,(0,n.createElement)(E.mr,{title:r?(0,a.__)("Default User Groups","better-wp-security"):(0,a.__)("Custom User Groups","better-wp-security"),description:r?(0,a.__)("Click any default user group to edit its features or its members.","better-wp-security"):(0,a.__)("Create custom user groups for each set of users you want to have a different security policy.","better-wp-security")})),(0,n.createElement)(l.OnboardHeader,{title:e.title,description:(0,n.createElement)(I.Lu,{content:e.help,noWrap:!0}),showNext:!0,showIndicator:!0}),t)}var ne=r(59588),ae=r.n(ne),se=r(36179),oe=r(31511);const ie=ae()(((e,t)=>{const r=[{value:"$administrator$",label:(0,a.__)("Administrator Capabilities","better-wp-security")},{value:"$editor$",label:(0,a.__)("Editor Capabilities","better-wp-security")},{value:"$author$",label:(0,a.__)("Author Capabilities","better-wp-security")},{value:"$contributor$",label:(0,a.__)("Contributor Capabilities","better-wp-security")},{value:"$subscriber$",label:(0,a.__)("Subscriber Capabilities","better-wp-security")}];t&&r.unshift({value:"$super-admin$",label:(0,a.__)("Super Admin","better-wp-security")}),(0,A.some)(e,(e=>""===e.canonical))&&r.push({value:"$other$",label:(0,a.__)("Other","better-wp-security"),selectable:!1});for(const t in e){if(!e.hasOwnProperty(t))continue;const{canonical:n,label:a}=e[t];r.push({value:t,parent:n.length>0?`$${n}$`:"$other$",label:a})}return Object.values(r)}));function le({groupId:e,disabled:t=!1}){const{roles:r,canonical:s,available:o,schema:i}=(0,d.useSelect)((t=>({roles:t(m.store).getEditedGroupAttribute(e,"roles")||[],canonical:t(m.store).getEditedGroupAttribute(e,"canonical")||[],available:t("ithemes-security/core").getRoles(),schema:t("ithemes-security/core").getSchema("ithemes-security-user-group")})),[e]),{editGroup:l}=(0,d.useDispatch)(m.store),c=(0,A.get)(i,["properties","canonical","items","enum"],[]).includes("super-admin"),u=[...r,...s.map((e=>`$${e}$`))];return(0,n.createElement)(se.gN,{label:(0,a.__)("Select Roles","better-wp-security"),help:(0,a.__)("Add users with the selected roles to this group.","better-wp-security"),value:u,disabled:t,options:ie(o,c),onChange:t=>{const[r,n]=(0,oe.pL)(t,(e=>e.startsWith("$")&&e.endsWith("$")));l(e,{roles:n,canonical:(0,A.without)(r.map((e=>e.slice(1,-1))),"other")})}})}var ce=r(87514),ue=r.n(ce),de=r(73470),me=r(9576);function pe(e){return{value:e.id,label:e.name,user:e}}const ge=e=>t=>new Promise(((r,n)=>{ue()({path:(0,de.addQueryArgs)("/wp/v2/users",{search:t,per_page:100,context:"embed",itsec_global:!0})}).then((t=>(t.forEach(e),t))).then((e=>r(e.map(pe)))).catch(n)}));function he({groupId:e,disabled:t=!1}){const r=(0,me.useInstanceId)(he),{editGroup:s}=(0,d.useDispatch)(m.store),{receiveUser:o}=(0,d.useDispatch)("ithemes-security/core"),{users:i,loading:l}=(0,d.useSelect)((t=>{const r=t(m.store).getEditedGroupAttribute(e,"users")||[],n=[];let a=!1;return r.forEach((e=>{const r=t("ithemes-security/core").getUser(e);r?n.push(r):t("core/data").isResolving("ithemes-security/core","getUser",[e])&&(a=!0)})),{users:n,loading:a}}),[e]),[u,p]=(0,n.useState)(""),g=`itsec-user-group-panel-users__select-${r}`,h=l?[]:i.map(pe),f=(0,n.useMemo)((()=>ge(o)),[o]);return(0,n.createElement)(c.BaseControl,{className:"itsec-user-group-panel-users__select-control",label:(0,a.__)("Select Users","better-wp-security"),help:(0,a.__)("Select specific users to add to this group.","better-wp-security"),id:g},(0,n.createElement)(I.qb,{classNamePrefix:"components-itsec-async-select-control",inputId:g,isDisabled:t||l,isLoading:l,isMulti:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:f,value:h,onChange:t=>s(e,{users:(0,A.map)(t,"value")}),inputValue:u,onInputChange:e=>p(e)}))}const fe=(0,g.Z)(c.Flex,{target:"e147t7dq0"})({name:"hltamm",styles:"margin-top:2rem"});function be({groupId:e}){const{isDirty:t,isSaving:r}=(0,d.useSelect)((t=>({isDirty:t(m.store).isDirty(e),isSaving:t(m.store).isSavingGroupOrSettings(e)})),[e]),{saveGroupAndSettings:s,resetEdits:o}=(0,d.useDispatch)(m.store),{root:i}=(0,f.UO)(),{goNext:u}=(0,l.useNavigation)();return(0,n.createElement)(fe,{justify:"end"},(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(E.zx,{variant:"secondary",onClick:()=>o(e),disabled:!t},(0,a.__)("Undo Changes","better-wp-security"))),"settings"===i&&(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(E.zx,{variant:"primary",onClick:()=>s(e),isBusy:r,disabled:r||!t},(0,a.__)("Save","better-wp-security"))),"settings"!==i&&(0,n.createElement)(E.zx,{text:(0,a.__)("Next","better-wp-security"),variant:"primary",onClick:u}))}const Ee=(0,g.Z)(c.Flex,{target:"e6kkusn0"})({name:"hltamm",styles:"margin-top:2rem"});function ve({groupIds:e}){const{isDirty:t,isSaving:r}=(0,d.useSelect)((t=>({isDirty:t(m.store).hasBulkSettingEdits(),isSaving:t(m.store).isSavingBulkEdits(e)})),[e]),{saveBulkEdits:s,resetBulkGroupSettingEdits:o}=(0,d.useDispatch)(m.store);return(0,n.createElement)(Ee,{justify:"end"},(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(E.zx,{variant:"secondary",onClick:()=>o(e),disabled:!t},(0,a.__)("Undo Changes","better-wp-security"))),(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(E.zx,{variant:"primary",onClick:()=>s(e),isBusy:r,disabled:r||!t},(0,a.__)("Save","better-wp-security"))))}function ye({groupId:e,children:t}){const{label:r,isLoading:s}=(0,d.useSelect)((t=>({label:t(m.store).getEditedGroupAttribute(e,"label"),isLoading:t("core/data").isResolving(i.store,"getGroup",[e])||t("core/data").isResolving(o.coreStore,"getIndex")})),[e]),{deleteGroup:l}=(0,d.useDispatch)(m.store),[p,g]=(0,E.HW)({onContinue:()=>l(e),title:(0,a.__)("Confirm your action","better-wp-security"),body:(0,a.sprintf)((0,a.__)("Are you sure you want to delete the “%s” user group?","better-wp-security"),null!=r?r:(0,a.__)("Untitled","better-wp-security")),continueText:(0,a.__)("Delete User Group","better-wp-security")});return(0,n.createElement)(React.Fragment,null,g,(0,n.createElement)(Le,null,(0,n.createElement)(E.zx,{text:(0,a.__)("Delete User Group","better-wp-security"),variant:"tertiary",isDestructive:!0,onClick:p})),(0,n.createElement)(c.Disabled,{isDisabled:s},t,(0,n.createElement)(u,{groupId:e,disabled:s})))}function _e({groupId:e,highlight:t,moduleFilter:r,children:s}){const{root:o}=(0,f.UO)(),l=(0,m.useSettingsDefinitions)({module:r}),{isLoading:u}=(0,d.useSelect)((t=>{let r=!1;if(!t(m.store).isLocalGroup(e)){const n=t(i.store).getGroupSettings(e),a=t(i.store).isResolving("getGroupSettings",[e]);r=!n&&a}return{isLoading:r}}),[e]);return(0,n.createElement)(React.Fragment,null,"settings"===o&&(0,n.createElement)(Le,null,(0,n.createElement)(h.rU,{to:`/settings/user-groups/multi?id=${e}&back=${e}`,component:(0,v.Sj)(E.xv),as:"a",variant:E.rK.ACCENT,text:(0,a.__)("Edit Multiple Groups","better-wp-security")})),(0,n.createElement)(c.Disabled,{isDisabled:u},s,(0,n.createElement)(m.SettingsForm,{definitions:l,settingComponent:m.SingleSettingField,groupId:e,disabled:u,highlight:t})))}function xe({groupIds:e,children:t}){const r=(0,m.useSettingsDefinitions)();return(0,n.createElement)(c.Disabled,{isDisabled:!e.length},t,(0,n.createElement)(m.SettingsForm,{definitions:r,settingComponent:m.BulkSettingField,groupIds:e}))}const{Slot:Ie,Fill:Le}=(0,c.createSlotFill)("UserGroupsPageHeaderAction"),{Slot:Ce,Fill:we}=(0,c.createSlotFill)("UserGroupsPageHeader");var Ne=r(27738),Se=r(54761);function Oe(){return X(),J(),(0,n.createElement)(l.Page,{id:"user-groups",title:(0,a.__)("User Groups","better-wp-security"),icon:"groups",priority:10,roots:["onboard","settings","import"]},(()=>(0,n.createElement)(S,null)))}(0,Se.addAction)("ithemes-security.onboard.applyAnswerResponse","ithemes-security/user-groups/onboard.applyAnswerResponse",(function(e,t){for(const r of t.user_groups)e.dispatch(m.store).createLocalGroup(r.id)&&e.dispatch(m.store).editGroup(r.id,(0,A.pick)(r,["label","users","roles","canonical"]));for(const r in t.user_groups_settings){if(!t.user_groups_settings.hasOwnProperty(r)||!(0,Ne.Z)(r))continue;const n=t.user_groups_settings[r];if(n)for(const t in n)if(n.hasOwnProperty(t))for(const a of n[t])e.dispatch(m.store).editGroupSetting(r,t,a,!0)}})),(0,Se.addAction)("ithemes-security.onboard.reset","ithemes-security/user-groups/onboard.reset",(function(e){e.dispatch(m.store).deleteLocalGroups(),e.dispatch(m.store).resetAllEdits()})),r.p=window.itsecWebpackPublicPath,(0,a.setLocaleData)({"":{}},"ithemes-security-pro"),(0,s.registerPlugin)("itsec-user-groups",{render:()=>(0,n.createElement)(Oe,null)})},33590:(e,t,r)=>{"use strict";r.d(t,{bB:()=>W,ZP:()=>X});var n={};r.r(n),r.d(n,{BaseInput:()=>u,CheckboxWidget:()=>p,CheckboxesWidget:()=>g,IncludeExcludeWidget:()=>D,RadioWidget:()=>N,SelectWidget:()=>y,TextareaWidget:()=>x,ToggleWidget:()=>m});var a={};r.r(a),r.d(a,{EntitySelectField:()=>R,FileTreeField:()=>B,TextareaListField:()=>j,TitleField:()=>Z});var s=r(92819),o=r(87462),i=r(6293),l=r(64893),c=r(36179);const u=function(e){const{id:t,label:r,value:n,readonly:a,disabled:u,onBlur:d,onFocus:m,options:p,onChange:g,schema:h,uiSchema:f={},...b}=e;p.inputType?b.type=p.inputType:b.type||("number"===h.type?(b.type="number",b.step="any"):"integer"===h.type?(b.type="number",b.step="1"):b.type="text"),p.autocomplete&&(b.autoComplete=p.autocomplete),h.multipleOf&&(b.step=h.multipleOf),void 0!==h.minimum&&(b.min=h.minimum),void 0!==h.maximum&&(b.max=h.maximum);const E=f["ui:description"]||h.description;return(0,i.createElement)(l.TextControl,(0,o.Z)({label:r,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:E}),readOnly:a,disabled:u,value:n||""},(0,s.omit)(b,["autofocus","formContext","registry","rawErrors"]),{onChange:e=>g(""===e?p.emptyValue:e),onBlur:d&&(e=>d(b.id,e.target.value)),onFocus:m&&(e=>m(b.id,e.target.value))}))};var d=r(54639);function m({schema:e,uiSchema:t={},id:r,value:n,disabled:a,readonly:s,label:o,onBlur:u,onFocus:m,onChange:p}){const g=d.P6.schemaRequiresTrueValue(e),h=t["ui:description"]||e.description;return(0,i.createElement)(l.ToggleControl,{checked:n||!1,onChange:p,required:g,disabled:a,readOnly:s,label:o,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:h}),onBlur:u&&(e=>u(r,e.target.checked)),onFocus:m&&(e=>m(r,e.target.checked))})}function p({schema:e,uiSchema:t={},id:r,value:n,disabled:a,readonly:s,label:o,onBlur:u,onFocus:m,onChange:p}){const g=d.P6.schemaRequiresTrueValue(e),h=t["ui:description"]||e.description;return(0,i.createElement)(l.CheckboxControl,{checked:n||!1,onChange:p,required:g,disabled:a,readOnly:s,label:o,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:h}),onBlur:u&&(e=>u(r,e.target.checked)),onFocus:m&&(e=>m(r,e.target.checked))})}function g(e){const{disabled:t,options:r,value:n,readonly:a,onChange:s,label:o,schema:l,uiSchema:u={}}=e,{enumOptions:d,enumDisabled:m=[],enumDescriptions:p=[],style:g}=r,h=u["ui:description"]||l.description,f=d.map(((e,t)=>({...e,disabled:m.includes(e.value),help:p[t]&&(0,i.createElement)(c.Lu,{noWrap:!0,content:p[t]})})));return(0,i.createElement)(c.w2,{value:n||[],onChange:s,options:f,label:o||u["ui:title"]||l.title,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:h}),readOnly:a,disabled:t,style:g})}const{asNumber:h,guessType:f}=d.P6,b=new Set(["number","integer"]);function E(e,t){const{type:r,items:n}=e;if(""!==t){if("array"===r&&n&&b.has(n.type))return t.map(h);if("boolean"===r)return"true"===t;if("number"===r)return h(t);if(e.enum){if(e.enum.every((e=>"number"===f(e))))return h(t);if(e.enum.every((e=>"boolean"===f(e))))return"true"===t}return t}}function v(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const y=function(e){const{schema:t,uiSchema:r={},id:n,options:a,value:s,label:o,required:u,disabled:d,readonly:m,multiple:p,onChange:g,onBlur:h,onFocus:f,placeholder:b}=e,{enumOptions:y,enumDisabled:_}=a,x=p?[]:"",I=[];p||void 0!==t.default||I.push({value:"",label:b});for(const e of y)I.push({...e,disabled:_&&_.includes(e.value)});const L=r["ui:description"]||t.description;return(0,i.createElement)(l.SelectControl,{multiple:p,options:I,value:void 0===s?x:s,label:o,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:L}),required:u,disabled:d,readOnly:m,onChange:e=>g(E(t,e)),onBlur:h&&(e=>h(n,E(t,v(e,p)))),onFocus:f&&(e=>f(n,E(t,v(e,p))))})},{getUiOptions:_}=d.P6;function x({schema:e,uiSchema:t={},id:r,value:n,disabled:a,readonly:u,label:d,onBlur:m,onFocus:p,onChange:g,...h}){const f=_(t),{rows:b,placeholder:E,description:v=e.description}=f;return(0,i.createElement)(l.TextareaControl,(0,o.Z)({value:void 0===n?"":n,onChange:g,disabled:a,readOnly:u,label:d,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:v}),onBlur:m&&(e=>m(r,e.target.value)),onFocus:p&&(e=>p(r,e.target.value)),rows:b,placeholder:E},(0,s.without)(h,["autofocus","formContext","registry","rawErrors"])))}const{asNumber:I,guessType:L}=d.P6,C=new Set(["number","integer"]);function w(e,t){const{type:r,items:n}=e;if(""!==t){if("array"===r&&n&&C.has(n.type))return t.map(I);if("boolean"===r)return"true"===t;if("number"===r)return I(t);if(e.enum){if(e.enum.every((e=>"number"===L(e))))return I(t);if(e.enum.every((e=>"boolean"===L(e))))return"true"===t}return t}}function N({schema:e,uiSchema:t={},id:r,options:n,value:a,label:s,required:o,disabled:u,readonly:d,onChange:m,onBlur:p,onFocus:g}){const{enumOptions:h}=n,f=t["ui:description"]||e.description;return(0,i.createElement)(l.RadioControl,{selected:a,options:h,label:s,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:f}),required:o,disabled:u,readOnly:d,onChange:t=>m(w(e,t)),onBlur:p&&(t=>p(r,w(e,t.target.value))),onFocus:g&&(t=>g(r,w(e,t.target.value)))})}var S=r(95122),O=r(82839),k=r(81019);function D({id:e,disabled:t,options:r,value:n,onChange:a,schema:o,autofocus:c,readonly:u}){const{enumOptions:d,enumDisabled:m=[],excludeList:{title:p=(0,S.__)("Excluded","better-wp-security"),description:g=(0,S.__)("The list of items to exclude from the selection.","better-wp-security"),button:h=(0,S.__)("Include","better-wp-security")}={},includeList:{title:f=(0,S.__)("Included","better-wp-security"),description:b=(0,S.__)("The list of items to include in the selection.","better-wp-security"),button:E=(0,S.__)("Exclude","better-wp-security")}={},title:v=o.title,description:y=o.description}=r;(0,i.useEffect)((()=>{const e=d.map((e=>e.value)),t=n.filter((t=>e.includes(t)));t.length!==n.length&&a(t)}),[n,d,a]);const[_,x]=(0,s.partition)(d,(e=>!n.includes(e.value)));return(0,i.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},v&&(0,i.createElement)(l.BaseControl.VisualLabel,null,v),y&&(0,i.createElement)("p",null,y),(0,i.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:e},(0,i.createElement)(A,{id:e+"__exclude",options:_,label:p,description:g,button:h,disabled:t||u,disabledOptions:m,autofocus:c,onToggle:e=>{(0,O.speak)((0,S.sprintf)((0,S.__)("Moved %1$s to %2$s.","better-wp-security"),(0,s.find)(_,{value:e}).label,f)),a([...n,e])}}),(0,i.createElement)(A,{id:e+"__include",options:x,label:f,description:b,button:E,disabled:t||u,disabledOptions:m,onToggle:e=>{(0,O.speak)((0,S.sprintf)((0,S.__)("Moved %1$s to %2$s.","better-wp-security"),(0,s.find)(x,{value:e}).label,p)),a(n.filter((t=>t!==e)))}})))}function A({id:e,label:t,description:r,options:n,button:a,onToggle:o,disabled:u,disabledOptions:d=[],autofocus:m}){const p=e+"__option__",[g,h]=(0,i.useState)("");return g&&!(0,s.find)(n,{value:g})&&h(""),(0,i.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,i.createElement)(l.BaseControl,{id:e,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:r}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,i.createElement)("span",{className:"components-base-control__label",id:e+"__label"},t),(0,i.createElement)(c.T2,{role:"listbox",id:e,active:g&&p+g,"aria-labelledby":e+"__label","aria-describedby":r&&e+"__help",onNavigate:e=>h(e.substr(p.length)),onKeyDown:({keyCode:e})=>{if(!g||e!==k.DELETE&&e!==k.BACKSPACE)return;const t=(0,s.findIndex)(n,{value:g}),r=t+1<n.length?t+1:t-1;o(g),h(n[r]?.value||"")},autoFocus:m},n.map((e=>(0,i.createElement)("div",{id:p+e.value,key:e.value,role:u||d.includes(e.value)?"presentation":"option","aria-selected":e.value===g||void 0,onClick:u||d.includes(e.value)?void 0:()=>h(e.value)},e.label))))),(0,i.createElement)(l.Button,{variant:"secondary",disabled:!g,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>o(g),"aria-keyshortcuts":"Delete Backspace"},a))}const F="*";function Z(e){const{id:t,title:r,required:n}=e;return(0,i.createElement)("span",{className:"itsec-rjsf-title-field",id:t},r,n&&(0,i.createElement)("span",{className:"required"},F))}var M=r(1986);const{getUiOptions:T}=d.P6;function R({uiSchema:e,schema:t,idSchema:r,name:n,formData:a,disabled:s,readonly:o,onChange:l}){const c=T(e);return(0,i.createElement)(M.fv,{id:r.$id,value:a,disabled:s,readonly:o,onChange:l,isMultiple:"array"===t.type,label:e["ui:title"]||t.title||n,description:e["ui:description"]||t.description,path:c.path,query:c.query,labelAttr:c.labelAttr,idAttr:c.idAttr,searchArg:c.searchArg})}const{getUiOptions:P}=d.P6;function j({uiSchema:e,schema:t,name:r,formData:n,disabled:a,readonly:s,onChange:o}){const l=e["ui:title"]||t.title||r,u=e["ui:description"]||t.description,d=P(e),{rows:m,placeholder:p}=d;return(0,i.createElement)(c.yA,{label:l,help:(0,i.createElement)(c.Lu,{noWrap:!0,content:u}),disabled:a,readonly:s,rows:m,value:n,onChange:o,placeholder:p})}var G=r(87514),$=r.n(G),U=r(73470);function B({idSchema:e,formData:t,onChange:r,uiSchema:n,schema:a,name:o,disabled:u,readonly:d,autofocus:m}){const p=e.$id,g=n["ui:title"]||a.title||o,h=n["ui:description"]||a.description,[f,b]=(0,i.useState)([]),[E,v]=(0,i.useState)("");(0,i.useEffect)((()=>{$()({path:(0,U.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(b)}),[]);const y=e=>{r(t.includes(e)?t.filter((t=>t!==e)):[...t,e])};return(0,i.createElement)("div",{className:"itsec-rjsf-file-tree"},h&&(0,i.createElement)(c.Lu,{content:h,tagName:"p"}),(0,i.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,i.createElement)("div",null,(0,i.createElement)(c.mp,{tree:f,id:p,label:(0,S.__)("File Selector","better-wp-security"),active:E,setActive:v,onActivate:y,onLoad:async e=>{const t=await $()({path:(0,U.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),r=(0,s.cloneDeep)(f);(0,c.in)(r,(r=>{if(r.id===e)return r.children=t,c.in.halt})),b(r)}}),(0,i.createElement)(l.Button,{variant:"secondary",disabled:!E,className:"itsec-rjsf-file-tree__select",onClick:()=>y(E),"aria-keyshortcuts":"Enter Space"},(0,S.__)("Select","better-wp-security"))),(0,i.createElement)(c.yA,{value:t,onChange:r,className:"itsec-rjsf-file-tree__list",label:g,disabled:u,readonly:d,autoFocus:m})))}function W({name:e,...t}){return(0,i.createElement)(l.Fill,(0,o.Z)({name:`RjsfField${e}`},t))}function z({name:e,...t}){return(0,i.createElement)(l.Slot,(0,o.Z)({name:`RjsfField${e}`},t))}const{ADDITIONAL_PROPERTY_FLAG:H,getUiOptions:V}=d.P6;function q(e){const{id:t,classNames:r,disabled:n,label:a,onKeyChange:s,onDropPropertyClick:o,readonly:c,required:u,schema:d,uiSchema:m}=e,p=`${a} Key`,g=d.hasOwnProperty(H),{removable:h}=V(m);return g&&!1!==h?(0,i.createElement)("div",{className:r},(0,i.createElement)("div",{className:"row"},(0,i.createElement)("div",{className:"col-xs-5 form-additional"},(0,i.createElement)(l.TextControl,{label:p,required:u,id:`${t}-key`,onBlur:e=>s(e.target.value)})),(0,i.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,i.createElement)("div",{className:"col-xs-2"},(0,i.createElement)(l.Button,{icon:"no-alt",isDestructive:!0,disabled:n||c,onClick:o(a)})))):(0,i.createElement)("div",{className:r},e.children)}const{canExpand:K}=d.P6;function Y({className:e,onClick:t,disabled:r}){return(0,i.createElement)("div",{className:"row"},(0,i.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`},(0,i.createElement)(l.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,S.__)("Add","better-wp-security"),tabIndex:"0",onClick:t,disabled:r})))}const Q={FieldTemplate:function(e){const{children:t,errors:r,hidden:n,schema:a,uiSchema:s,formContext:o,onChange:c}=e;if(n)return null;const{resettable:u}=V(s);return(0,i.createElement)(q,e,t,(0,i.createElement)(z,{name:e.id,fillProps:e}),u&&(0,i.createElement)(l.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>c(a.default)},(0,S.__)("Restore Default","better-wp-security")),!0!==o?.disableInlineErrors&&r)},ObjectFieldTemplate:function(e){const{TitleField:t,DescriptionField:r,schema:n,uiSchema:a,properties:s}=e;if(!s.length)return null;const o=(a["ui:sections"]||[]).reduce(((e,t)=>({...e,[t.fields.find((e=>!!n.properties[e]))]:t})),{});return(0,i.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:e.idSchema.$id},(a["ui:title"]||e.title)&&(0,i.createElement)(t,{id:`${e.idSchema.$id}__title`,title:e.title||a["ui:title"],required:e.required,formContext:e.formContext}),e.description&&(0,i.createElement)(r,{id:`${e.idSchema.$id}__description`,description:(0,i.createElement)(c.Lu,{noWrap:!0,content:e.description}),formContext:e.formContext}),s.map((({name:e,content:t})=>o[e]?(0,i.createElement)(i.Fragment,{key:e},(0,i.createElement)("h3",{className:"itsec-rjsf-section-title"},o[e].title),o[e].description&&(0,i.createElement)("p",{className:"itsec-rjsf-section-description"},(0,i.createElement)(c.Lu,{noWrap:!0,content:o[e].description})),t):t)),K(n,a,e.formData)&&(0,i.createElement)(Y,{className:"object-property-expand",onClick:e.onAddClick(n),disabled:e.disabled||e.readonly}))},ErrorList:function({errors:e}){return(0,i.createElement)(c.KM,{errors:e.map((({stack:e}={})=>e)).filter((e=>!!e))})},widgets:n,fields:a},X=Q},50460:(e,t,r)=>{"use strict";r.d(t,{G:()=>P,o:()=>O});var n={};r.r(n),r.d(n,{REGISTER_PROVIDER:()=>M,registerProvider:()=>Z});var a={};r.r(a),r.d(a,{getProviders:()=>T});var s=r(87462),o=r(6293),i=r(73727),l=r(16550),c=r(90071),u=r(92819),d=r(64893),m=r(95122),p=r(48015),g=r(9576),h=r(81019),f=r(82839),b=r(71930),E=r(65813),v=r(36179),y=r(86033),_=r(13092);function x(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var I=new WeakMap,L=new WeakMap,C=new WeakMap,w=new WeakMap,N=new WeakMap;class S{constructor(e,t){x(this,I,{writable:!0,value:void 0}),x(this,L,{writable:!0,value:void 0}),x(this,C,{writable:!0,value:void 0}),x(this,w,{writable:!0,value:void 0}),x(this,N,{writable:!0,value:void 0}),(0,_.Z)(this,I,e),(0,_.Z)(this,L,t),(0,_.Z)(this,C,t.select(P).getProviders()),this._prepare()}_prepare(){(0,_.Z)(this,N,(0,y.Z)(this,I).split(/\s+/g).map((e=>e.trim().toLowerCase())).filter((e=>!!e)));const e=(0,y.Z)(this,I).endsWith(" ");(0,_.Z)(this,w,new RegExp((0,y.Z)(this,N).map(((t,r)=>r+1!==(0,y.Z)(this,N).length||e?`(?=.*\\b${(0,u.escapeRegExp)(t)}\\b)`:`(?=.*\\b${(0,u.escapeRegExp)(t)})`)).join("")+".+","gi"))}_stringMatch(e){return e&&(0,y.Z)(this,w).test(e)}_keywordMatch(e){return!(!e||!e.length)&&e.some((e=>(0,y.Z)(this,N).some(((t,r)=>e.includes(" ")?this._stringMatch(e):r===(0,y.Z)(this,N).length-1?e.startsWith(t):t===e))))}getResults(){if((0,y.Z)(this,I).length<3)return[{},0];let e=0;const t=[],r={stringMatch:e=>this._stringMatch(e),keywordMatch:e=>this._keywordMatch(e)};for(const n of(0,y.Z)(this,C)){const a={title:n.title,items:[],groups:{}};e+=n.callback({evaluate:r,results:a,registry:(0,y.Z)(this,L)}),!a.items.length&&(0,u.isEmpty)(a.groups)||t.push(a)}return[t,e]}}const O=(0,o.forwardRef)((function({onPick:e=u.noop,showResults:t},r){const[n,a]=(0,o.useState)(""),[i,l]=(0,o.useState)(!1),c=(0,o.useRef)(),d=(0,o.useRef)(),[v,y]=(0,o.useState)([]),_=(0,p.useRegistry)(),x=(0,o.useCallback)((e=>{const t=new S(e,_).getResults();y(t[0]),(0,f.speak)((0,m.sprintf)((0,m._n)("%d result found.","%d results found.",t[1],"better-wp-security"),t[1]))}),[_]),I=(0,g.useDebounce)(x,50),L=(0,o.useCallback)((e=>{c.current&&(e.preventDefault(),c.current.focus())}),[c]);return(0,g.useKeyboardShortcut)("/",L),(0,o.createElement)("div",(0,s.Z)({className:"itsec-search"},(0,E.Zk)((()=>l(!1)))),(0,o.createElement)("div",null,(0,o.createElement)(b.lD,{value:n,onChange:e=>{a(e),I(e)},onFocus:()=>l(!0),onKeyDown:e=>{e.keyCode===h.DOWN&&(e.preventDefault(),d.current.focus())},ref:(0,E.qq)([r,c]),placeholder:(0,m.__)("Search for features, settings, and more","better-wp-security"),omitSeparators:!0,size:"large"}),(i||t)&&n.length>=3&&(0,o.createElement)(k,{results:v,exitSearch:t=>{e(t),l(!1)},ref:d,onPick:e})))})),k=(0,o.forwardRef)((function({results:e,exitSearch:t,onPick:r},n){const a=(0,o.useRef)();(0,o.useImperativeHandle)(n,(()=>({focus(){a.current.focus()}})));const i=(0,g.useInstanceId)(k,"itsec-search"),p=i+"__result__",f=function(){const e=(0,l.k6)();return(t,r="push")=>e[r]((0,c.ob)(t))}(),[b,E]=(0,o.useState)("");return(0,u.isEmpty)(e)?null:(0,o.createElement)(React.Fragment,null,(0,o.createElement)(d.VisuallyHidden,{id:i+"__label"},(0,m.__)("Search Results","better-wp-security")),(0,o.createElement)(v.T2,{className:"itsec-search__results",id:i,active:b&&p+b,onNavigate:e=>E(e.substring(p.length)),onKeyDown:({keyCode:e})=>{!b||e!==h.ENTER&&e!==h.SPACE||(r(b),f(b),t())},onFocus:()=>{if(!b&&!(0,u.isEmpty)(e)){const[,t]=Object.entries(e)[0];if(t.items?.length)E(t.items[0].route);else if(!(0,u.isEmpty)(t.groups)){const[,e]=Object.entries(t.groups)[0];E(e.items[0].route)}}},role:"listbox",descendantRoles:"option",ref:a,"aria-labelledby":i+"__label"},(0,u.map)(e,((e,r)=>(0,o.createElement)(D,(0,s.Z)({key:r},e,{active:b,idPrefix:p,exitSearch:t}))))))}));function D({title:e,items:t,groups:r,...n}){const a=(0,g.useInstanceId)(k,"itsec-search__kind");return(0,o.createElement)("ul",{className:"itsec-search__kind",role:"group","aria-labelledby":a},(0,o.createElement)("li",{role:"presentation",id:a},e),(t||[]).map((e=>(0,o.createElement)(F,(0,s.Z)({key:e.route},e,n)))),(0,u.map)(r,((e,t)=>(0,o.createElement)(A,(0,s.Z)({key:t},e,n)))))}function A({title:e,items:t,...r}){const n=(0,g.useInstanceId)(k,"itsec-search__group");return(0,o.createElement)("ul",{className:"itsec-search__group",role:"group","aria-labelledby":n},(0,o.createElement)("li",{role:"presentation",id:n},(0,o.createElement)("span",null,e)),(t||[]).map((e=>(0,o.createElement)(F,(0,s.Z)({key:e.route},e,r)))))}function F({title:e,description:t,route:r,active:n,idPrefix:a,exitSearch:s}){return(0,o.createElement)("li",{className:"itsec-search__result",role:"option","aria-selected":n===r||void 0,id:a+r,"aria-label":e},(0,o.createElement)(i.rU,{to:r,tabIndex:-1,onClick:()=>s(r)},(0,o.createElement)("span",null,e),(0,o.createElement)(v.Lu,{content:t,noHtml:!0,tagName:"p"})))}function Z(e,t,r,n){return{type:M,slug:e,title:t,priority:r,callback:n}}const M="REGISTER_PROVIDER",T=(0,r(28306).Z)((e=>(0,u.sortBy)(e.providers,"priority")),(e=>e.providers)),R={providers:{}},P="ithemes-security/search";(0,p.registerStore)(P,{actions:n,selectors:a,reducer:function(e=R,t){return t.type===M?{...e,providers:{...e.providers,[t.slug]:(0,u.omit)(t,["type"])}}:e}})},1986:(e,t,r)=>{"use strict";r.d(t,{U9:()=>Oe,qb:()=>W,a7:()=>z,kS:()=>Ie,fv:()=>m,KM:()=>h,nU:()=>le,TR:()=>pe,Lu:()=>x,uC:()=>oe,T:()=>O,b:()=>k,Ph:()=>B,_g:()=>se,ge:()=>J,Qf:()=>ee,oB:()=>ke});var n=r(6293),a=r(62845),s=r(92819),o=r(87514),i=r.n(o),l=r(73470),c=r(64893),u=r(9576);const{useGlobalState:d}=(0,a.r8)({cache:{}});function m({id:e,value:t,disabled:r,readonly:a,onChange:o,label:p,description:g,isMultiple:h=!1,path:f,query:b={},labelAttr:E,idAttr:v="id",searchArg:y="search"}){const[_,I]=d("cache"),L=(0,u.useInstanceId)(m,"itsec-entity-select-control");e=e||L;const[C,w]=(0,n.useState)(""),N=function(e,t,r,a,o,c,u){return(0,n.useCallback)((n=>i()({path:(0,l.addQueryArgs)(e,{...t,[o]:n})}).then((e=>e.map((e=>({value:e[a],label:e[r]}))))).then((t=>(u({...c,[e]:{...c[e]||{},...(0,s.mapValues)((0,s.keyBy)(t,"value"),"label")}}),t)))),[e,t,r,a,o,c,u])}(f,b,E,v,y,_,I);let S;return h?S=(t||[]).filter((e=>void 0!==e)).map((e=>({value:e,label:_[f]?.[e]||e}))):t&&(S={value:t,label:_[f]?.[t]||t}),(0,n.createElement)(c.BaseControl,{className:"itsec-entity-select-control",label:p,help:g&&(0,n.createElement)(x,{noWrap:!0,content:g}),id:e,__nextHasNoMarginBottom:!0},(0,n.createElement)(W,{"aria-label":p,"aria-describedby":g?e+"__help":void 0,classNamePrefix:"itsec-entity-select-control-as",inputId:e,isDisabled:r||a,isMulti:h,isClearable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:N,value:S,onChange:e=>o(h?(e||[]).map((e=>e.value)):e?.value),inputValue:C,onInputChange:w}))}var p=r(71930),g=r(31511);function h({errors:e,apiError:t,schemaError:r,title:a,className:s,hasBorder:o}){const i=[...e||[],...(0,g.Y3)(t),...(r||[]).map((e=>e.stack))];return i.length?(0,n.createElement)(p.rN,{messages:i,heading:a,className:s,hasBorder:o,type:"danger"}):null}var f=r(52117);const b=(0,f.Z)("div",{target:"e103ploj0"})({name:"1ff36h2",styles:"flex-grow:1"});function E(){return(0,n.createElement)(b,{"aria-hidden":!0})}var v=r(87462),y=r(63108),_=r(73727);function x({transform:e,...t}){return(0,n.createElement)(y.Lu,(0,v.Z)({},t,{transform:(r,a)=>{if(e){const t=e(r,a);if(void 0!==t)return t}if("a"===r.tagName.toLowerCase()&&r.dataset.itsecPath&&!t.noHtml)return(0,n.createElement)(_.rU,{to:r.dataset.itsecPath},a)}}))}var I=r(95122),L=r(65813),C=r(54639),w=r(33590);const N=(0,C.Zz)(w.ZP),S=(0,f.Z)(N,{target:"e1yg558d0"})(".itsec-rjsf-object-fieldset{display:grid;grid-template-columns:[label fields] minmax(0, 1fr);grid-template-rows:auto;grid-gap:.5rem 0;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){grid-template-columns:[label] 10rem [fields] minmax(0, 1fr);}}.itsec-rjsf-section-description{margin-top:0;grid-column:fields;}>.field-object>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field,&>.itsec-rjsf-section-title{grid-column:label;font-size:1rem;padding-right:1rem;margin-bottom:0;&:not(:first-child){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){&+*{border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;}}}}&>.form-group:not(.field-object){grid-column:label/fields-end;}&>.itsec-rjsf-section-title~.form-group{grid-column:fields;}&>.field-object{grid-column:label/fields-end;}&>.field-description{margin-top:0;}}.itsec-rjsf-object-fieldset>*>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field{grid-column:label;font-size:1rem;padding-right:1rem;}&>.form-group{grid-column:fields;}&>.field-description{grid-column:fields;margin-top:0;}}.components-base-control__label,.components-input-control__label,label,caption,legend{color:",(({theme:e})=>e.colors.text.dark),";}.itsec-highlighted-search-result{.components-base-control__label,.components-input-control__label,label,caption{border-bottom:3px solid ",(({theme:e})=>e.colors.border.info),";padding-bottom:3px;margin-bottom:6px;}.components-base-control__field{margin-bottom:12px;}}.field-object:not(:first-child):not(:empty){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:1rem;padding-top:1rem;}.field-object:empty{display:none;}.itsec-rjsf-title-field+.field-object:not(:first-child),.itsec-rjsf-section-description+.field-object:not(:first-child){border-top:none;margin-top:0;padding-top:0;}");function O({saveLabel:e,isSaving:t,saveDisabled:r,cancelLabel:a,onCancel:s,cancelRoute:o,undoLabel:i,undoDisabled:l,onUndo:d,children:m,errors:p,apiError:g,schemaError:f,withCard:b,alignActions:E,...y}){let _=(0,u.useInstanceId)(O,"itsec-schema-form");_=y.id||_;const x=(0,n.createElement)(React.Fragment,null,(0,n.createElement)(h,{errors:p,apiError:g,schemaError:f}),(0,n.createElement)(k,(0,v.Z)({},y,{id:_})));return(0,n.createElement)(c.Flex,{direction:"column",gap:7,justify:"start",expanded:!1},(0,n.createElement)(c.FlexItem,null,b&&(0,n.createElement)(c.Card,null,(0,n.createElement)(c.CardBody,null,x)),!b&&x),(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(D,{id:_,saveLabel:e,cancelLabel:a,isSaving:t,saveDisabled:r,onCancel:s,cancelRoute:o,undoLabel:i,undoDisabled:l,onUndo:d,align:E},m)))}function k({className:e,...t}){return(0,n.createElement)(S,(0,v.Z)({},t,{className:e,additionalMetaSchemas:[r(27171)]}),(0,n.createElement)(React.Fragment,null))}function D({id:e,saveLabel:t=(0,I.__)("Save","better-wp-security"),isSaving:r,saveDisabled:a,cancelLabel:s=(0,I.__)("Cancel","better-wp-security"),onCancel:o,cancelRoute:i,undoLabel:l=(0,I.__)("Undo Changes","better-wp-security"),undoDisabled:u,onUndo:d,align:m,children:g}){return(0,n.createElement)(c.Flex,{align:m},o&&(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(p.zx,{variant:"tertiary",type:"button",onClick:o},s)),i&&(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(_.rU,{component:(0,L.Sj)(p.zx),variant:"tertiary",type:"button",to:i},s)),!m&&(0,n.createElement)(E,null),g,d&&(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(p.zx,{variant:"secondary",disabled:u,onClick:d},l)),(0,n.createElement)(c.FlexItem,null,(0,n.createElement)(p.zx,{variant:"primary",isBusy:r,disabled:r||a,form:e,type:"submit"},t)))}var A=r(99196),F=r(35800),Z=r(12614),M=r(29508);const T=(0,A.lazy)((()=>Promise.all([r.e(4699),r.e(3157)]).then(r.bind(r,23157)))),R=(0,A.lazy)((()=>Promise.all([r.e(4699),r.e(4136)]).then(r.bind(r,64136)))),P=(0,A.lazy)((()=>Promise.all([r.e(4699),r.e(1323)]).then(r.bind(r,31323))));function j(){return(0,n.createElement)("span",null,(0,I.__)("Error when loading. Please refresh.","better-wp-security"))}const G=(0,M.iv)({name:"1nml846",styles:"input{min-height:0;}input:focus{box-shadow:none;}"});function $(){const e=(0,Z.u)();return(0,n.useCallback)((t=>({...t,colors:{...t.colors,primary:e.colors.primary.base,primary75:e.colors.secondary.base,primary50:e.colors.tertiary.base,primary25:e.colors.surface.secondary}})),[e])}function U(){return(0,n.useMemo)((()=>({control:(e,t)=>({...e,minHeight:36,borderColor:t.isFocused?e.borderColor:"rgb(148, 148, 148)",borderRadius:2}),dropdownIndicator:e=>({...e,padding:6}),clearIndicator:e=>({...e,padding:6}),loadingIndicator:e=>({...e,padding:6}),valueContainer:e=>({...e,paddingTop:0,paddingBottom:0}),input:e=>({...e,paddingTop:0,paddingBottom:0})})),[])}function B({addErrorBoundary:e=!0,className:t,...r}){const a=$(),s=U(),o=(0,n.createElement)(A.Suspense,{fallback:(0,n.createElement)(c.Spinner,null)},(0,n.createElement)(T,(0,v.Z)({},r,{className:(0,M.cx)(t,G),theme:a,styles:s})));return e?(0,n.createElement)(F.ErrorBoundary,{FallbackComponent:j},o):o}function W({addErrorBoundary:e=!0,className:t,...r}){const a=$(),s=U(),o=(0,n.createElement)(A.Suspense,{fallback:(0,n.createElement)(c.Spinner,null)},(0,n.createElement)(R,(0,v.Z)({},r,{className:(0,M.cx)(t,G),theme:a,styles:s})));return e?(0,n.createElement)(F.ErrorBoundary,{FallbackComponent:j},o):o}function z({addErrorBoundary:e=!0,className:t,...r}){const a=$(),s=U(),o=(0,n.createElement)(A.Suspense,{fallback:(0,n.createElement)(c.Spinner,null)},(0,n.createElement)(P,(0,v.Z)({},r,{className:(0,M.cx)(t,G),theme:a,styles:s})));return e?(0,n.createElement)(F.ErrorBoundary,{FallbackComponent:j},o):o}var H=r(32010),V=r(60976);const q=(0,f.Z)(p.Tg,{target:"ecpy66c3"})({name:"1x94tvs",styles:"display:flex;align-items:center;flex-shrink:0;padding:.5rem 1.5rem;min-height:calc(30px + 1rem);& .components-button:focus{box-shadow:none;}"}),K=(0,f.Z)(c.Toolbar,{target:"ecpy66c2"})({name:"gxzf6f",styles:"border:none;max-width:100%;margin-left:auto"}),Y=(0,f.Z)("div",{target:"ecpy66c1"})({name:"hlx1h5",styles:"display:flex;gap:0.5rem;margin:0 2rem 0 1rem;flex-grow:1"}),Q=(0,f.Z)(V.Ae,{target:"ecpy66c0"})({name:"1jxlbx4",styles:"height:2rem;width:2rem"});function X({area:e,...t}){return(0,n.createElement)(c.Slot,(0,v.Z)({name:`Toolbar${e}`},t))}function J({area:e="actions",...t}){return(0,n.createElement)(c.Fill,(0,v.Z)({name:`Toolbar${e}`},t))}function ee(){const e=(0,g.bv)("dashboard"),t=(0,u.useViewportMatch)("medium","<");return(0,n.createElement)(q,{role:"region","aria-label":(0,I.__)("Toolbar","better-wp-security")},t?(0,n.createElement)(Q,null):(0,n.createElement)(pe,null),(0,n.createElement)(X,{area:"main"},(e=>(0,n.createElement)(Y,null,e))),(0,n.createElement)(K,{label:(0,I.__)("Toolbar Actions","better-wp-security")},(0,n.createElement)(c.ToolbarButton,{icon:H.Z,href:e,text:(0,I.__)("Dashboard","better-wp-security")}),(0,n.createElement)(X,{area:"actions"})))}const te=(0,f.Z)("nav",{target:"e28bhoc2"})("display:flex;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";"),re=(0,f.Z)(_.OL,{target:"e28bhoc1"})("display:flex;text-decoration:none;align-items:center;&.active{box-shadow:inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),";}&:focus{color:",(({theme:e})=>e.colors.text.dark),";box-shadow:inset 0 0 0 2px ",(({theme:e})=>e.colors.border.info),",inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),"!important;border-radius:3px!important;}"),ne=(0,f.Z)(p.xv,{target:"e28bhoc0"})({name:"1i2l0vb",styles:"padding:.75rem 1.25rem"}),ae=(0,n.createContext)({size:p.yH.LARGE});function se({className:e,size:t=p.yH.LARGE,children:r}){const a=(0,n.useMemo)((()=>({size:t})),[t]);return(0,n.createElement)(te,{className:e},(0,n.createElement)(ae.Provider,{value:a},r))}function oe({title:e,...t}){const{size:r}=(0,n.useContext)(ae);return(0,n.createElement)(re,t,(0,n.createElement)(ne,{size:r,weight:p.fs.HEAVY,text:e,align:"center"}))}const ie=(0,f.Z)(V.Ae,{shouldForwardProp:e=>"isSmall"!==e,target:"ewrt4zq0"})("height:",(({isSmall:e})=>e?"56px":"120px"),";width:",(({isSmall:e})=>e?"56px":"120px"),";");function le({icon:e,isSmall:t=!1}){return(0,u.useMediaQuery)("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)")?e:(0,n.createElement)(ie,{isSmall:t})}var ce=r(48015),ue=r(31600);const de=(0,f.Z)(V.sX,{target:"e1bzve6y1"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;"),me=(0,f.Z)(V.Pb,{target:"e1bzve6y0"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;");function pe({size:e=25,className:t}){const{installType:r}=(0,ce.useSelect)((e=>({installType:e(ue.coreStore).getInstallType()})),[]);return"free"===r?(0,n.createElement)(de,{size:e,className:t}):(0,n.createElement)(me,{size:e,className:t})}var ge=r(59588),he=r.n(ge),fe=r(76292),be=r.n(fe),Ee=r(82506),ve=r(82521);const ye=(0,f.Z)("div",{target:"e1hwued11"})({name:"aj6rbz",styles:"display:flex;gap:0.5rem"}),_e=(0,f.Z)(p.zx,{target:"e1hwued10"})({name:"1o3nkn",styles:"margin-left:auto"}),xe=he()((()=>[{value:"24-hours",label:(0,I.__)("24 Hours","better-wp-security")},{value:"week",label:(0,I.__)("7 Days","better-wp-security")},{value:"30-days",label:(0,I.__)("30 Days","better-wp-security")},{value:"custom",label:(0,I.__)("Custom","better-wp-security")}]));function Ie({value:e,onChange:t}){const[r,a]=(0,n.useState)(!1),[o,i]=(0,n.useState)(void 0),[l,u]=(0,n.useState)(void 0);let[d,m]=(0,n.useState)(void 0);const g=e,h=function(e){if(!e)return"";const t=new window.Date;let r,n;switch(e){case"24-hours":return(0,I.__)("24 Hours","better-wp-security");case"30-days":r=(0,ve.dateI18n)("M j",t.setDate(t.getDate()-30)),n=(0,ve.dateI18n)("M j, Y");break;case"week":r=(0,ve.dateI18n)("M j",t.setDate(t.getDate()-7)),n=(0,ve.dateI18n)("M j, Y");break;default:r=(0,ve.dateI18n)("M j",e.start),n=(0,ve.dateI18n)("M j, Y",e.end)}return(0,I.sprintf)((0,I.__)("%1$s - %2$s","better-wp-security"),r,n)}(g);return d=d||((0,s.isString)(g)?g:"custom"),(0,n.createElement)("div",null,(0,n.createElement)(p.zx,{onClick:()=>a(!r),title:h,"aria-expanded":r,"aria-label":(0,I.sprintf)((0,I.__)("%s (click to edit)","better-wp-security"),h),variant:"tertiary",text:h,icon:Ee.Z,iconPosition:"right"}),r&&(0,n.createElement)(c.Modal,{title:(0,I.__)("Change Date Period","better-wp-security"),onRequestClose:()=>a(!1)},(0,n.createElement)(c.SelectControl,{options:xe(),value:d,onChange:e=>m(e)}),(0,n.createElement)(ye,null,"custom"===d&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,n.createElement)(p.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,I.sprintf)((0,I.__)("From: %s (click to edit","better-wp-security"),(0,ve.dateI18n)("M j",o)),text:(0,I.sprintf)((0,I.__)("From %s","better-wp-security"),(0,ve.dateI18n)("M j",o))}),renderContent:()=>(0,n.createElement)(c.DatePicker,{currentDate:o,onChange:i,isInvalidDate:e=>{if((0,ve.isInTheFuture)(e))return!0;const t=new window.Date;return t.setDate(t.getDate()-60),e<t}})}),(0,n.createElement)(c.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,n.createElement)(p.zx,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,I.sprintf)((0,I.__)("To: %s (click to edit","better-wp-security"),(0,ve.dateI18n)("M j",l)),text:(0,I.sprintf)((0,I.__)("To: %s (click to edit","better-wp-security"),(0,ve.dateI18n)("M j",l))}),renderContent:()=>(0,n.createElement)(c.DatePicker,{currentDate:l,onChange:u,isInvalidDate:e=>!!(0,ve.isInTheFuture)(e)||(0,ve.getDate)(o)>e})})),(0,n.createElement)(_e,{variant:"primary",onClick:e=>{let r;if(e.preventDefault(),"custom"===d){const e=be()(o).set({hour:0,minute:0,second:0}),t=be()(l).set({hour:23,minute:59,second:59});r={start:(0,ve.format)("Y-m-d\\TH:i:s",e),end:(0,ve.format)("Y-m-d\\TH:i:s",t)}}else r=d;t(r),a(!1)},text:(0,I.__)("Apply","better-wp-security")}))))}const Le=(0,f.Z)(c.Icon,{target:"e1vmfdpe1"})({name:"1svyz14",styles:"background-color:#438C56;border-radius:2rem"}),Ce=(0,f.Z)(c.Icon,{target:"e1vmfdpe0"})({name:"x749hy",styles:"background-color:#E6505466;border-radius:2rem;height:0.813rem!important;width:0.813rem!important;padding:2px"});var we=r(28184),Ne=r(65202),Se=r(67527);function Oe(){const{versionActive:e,versionSettings:t,installType:r}=(0,ce.useSelect)((e=>({versionActive:e(ue.modulesStore).isActive("version-management"),versionSettings:e(ue.modulesStore).getSettings("version-management"),installType:e(ue.coreStore).getInstallType()})),[]),a=e&&t.update_if_vulnerable,s="free"===r,o=a?(0,I.__)("Real-Time Updates Active","better-wp-security"):(0,I.__)("Real-Time Updates Inactive","better-wp-security"),i=s?(0,I.__)("Upgrade","better-wp-security"):(0,I.__)("Enable “Auto Update If Fixes Vulnerability” in Version Management","better-wp-security"),l=a?(0,n.createElement)(Le,{icon:we.Z}):(0,n.createElement)(Ce,{icon:Ne.Z,style:{fill:"#8A2424"}});return(0,n.createElement)(p.Ct,{text:o,icon:l,iconColor:"#FFFFFF",tooltip:i})}function ke(){const{hasPatchstack:e,installType:t}=(0,ce.useSelect)((e=>({hasPatchstack:e(ue.coreStore).hasPatchstack(),installType:e(ue.coreStore).getInstallType()})),[]),r="free"===t,a=e?(0,I.__)("Virtual Patching Active","better-wp-security"):(0,I.__)("Virtual Patching Inactive","better-wp-security"),s=r?(0,I.__)("Upgrade","better-wp-security"):null,o=e?Se.Z:(0,n.createElement)(Ce,{icon:Ne.Z,style:{fill:"#8A2424"}});return(0,n.createElement)(p.Ct,{text:a,icon:o,iconColor:"#6817C5",tooltip:s})}},27231:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(6293),a=r(14776);const s=(0,n.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(a.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"}))},95117:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(6293),a=r(14776);const s=(0,n.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(a.Path,{d:"M18 11.2h-5.2V6h-1.6v5.2H6v1.6h5.2V18h1.6v-5.2H18z"}))},28306:(e,t,r)=>{"use strict";var n,a;function s(e){return[e]}function o(){var e={clear:function(){e.head=null}};return e}function i(e,t,r){var n;if(e.length!==t.length)return!1;for(n=r;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function l(e,t){var r,l;function c(){r=a?new WeakMap:o()}function u(){var r,n,a,s,o,c=arguments.length;for(s=new Array(c),a=0;a<c;a++)s[a]=arguments[a];for(o=t.apply(null,s),(r=l(o)).isUniqueByDependants||(r.lastDependants&&!i(o,r.lastDependants,0)&&r.clear(),r.lastDependants=o),n=r.head;n;){if(i(n.args,s,1))return n!==r.head&&(n.prev.next=n.next,n.next&&(n.next.prev=n.prev),n.next=r.head,n.prev=null,r.head.prev=n,r.head=n),n.val;n=n.next}return n={val:e.apply(null,s)},s[0]=null,n.args=s,r.head&&(r.head.prev=n,n.next=r.head),r.head=n,n.val}return t||(t=s),l=a?function(e){var t,a,s,i,l,c=r,u=!0;for(t=0;t<e.length;t++){if(!(l=a=e[t])||"object"!=typeof l){u=!1;break}c.has(a)?c=c.get(a):(s=new WeakMap,c.set(a,s),c=s)}return c.has(n)||((i=o()).isUniqueByDependants=u,c.set(n,i)),c.get(n)}:function(){return r},u.getDependants=t,u.clear=c,c(),u}r.d(t,{Z:()=>l}),n={},a="undefined"!=typeof WeakMap},91247:(e,t,r)=>{"use strict";var n;r.d(t,{Z:()=>c});var a=new Uint8Array(16);function s(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(a)}for(var o=r(27738),i=[],l=0;l<256;++l)i.push((l+256).toString(16).substr(1));const c=function(e,t,r){var n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase();if(!(0,o.Z)(r))throw TypeError("Stringified UUID is invalid");return r}(n)}},27738:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});const n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&n.test(e)}},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},7980:e=>{e.exports=function(){return this.itsec.pages.settings}()},87375:e=>{e.exports=function(){return this.itsec["user-groups"].api}()},62470:e=>{e.exports=function(){return this.itsec["user-groups"].ui}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},82521:e=>{e.exports=function(){return this.wp.date}()},6293:e=>{e.exports=function(){return this.wp.element}()},54761:e=>{e.exports=function(){return this.wp.hooks}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},25703:e=>{e.exports=function(){return this.wp.notices}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash},76292:e=>{"use strict";e.exports=window.moment}},e=>{e.O(0,[7271,1930,5307,9443,135,9071,1511,976,6179],(()=>(63668,e(e.s=63668))));var t=e.O();((window.itsec=window.itsec||{})["user-groups"]=window.itsec["user-groups"]||{}).settings=t}]);